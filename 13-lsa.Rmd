# –õ–∞—Ç–µ–Ω—Ç–Ω–æ-—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (–ß–∞—Å—Ç—å 1)

## –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ

–í —ç—Ç–æ–º —É—Ä–æ–∫–µ —Ä–µ—á—å –ø–æ–π–¥–µ—Ç –æ —Ç–∞–∫–æ–º –º–µ—Ç–æ–¥–µ **—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è**, –∫–∞–∫ **–ª–∞—Ç–µ–Ω—Ç–Ω–æ-—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑**, –∏–ª–∏ LSA (–≤ –æ–±–ª–∞—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –Ω–∞–∑—ã–≤–∞–µ–º—ã–π —Ç–∞–∫–∂–µ LSI, Latent Semantic Indexing). –ö–∞–∫ –∏ LDA, —ç—Ç–æ –º–µ—Ç–æ–¥ –º–µ—Ç–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –≤–∑–∞–∏–º–æ—Å–≤—è–∑—å –º–µ–∂–¥—É –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–º–∏—Å—è –≤ –Ω–∏—Ö —Ç–µ—Ä–º–∏–Ω–∞–º–∏ –∑–∞ —Å—á–µ—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —ç—Ç–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ —Ç–µ—Ä–º–∏–Ω–æ–≤ —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ **—Ç–µ–º–∞–º–∏**. 

–°–ª–æ–≤–æ "—Å–∫—Ä—ã—Ç—ã–π" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ **—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏** –º–µ–∂–¥—É –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –∏ —Ç–µ—Ä–º–∏–Ω–∞–º–∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –∑–∞—Ä–∞–Ω–µ–µ –Ω–µ –∏–∑–≤–µ—Å—Ç–Ω—ã. –í –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–µ—Ä–º–¥–æ–∫—É–º–µ–Ω—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø–µ—Ä–µ–¥–∞–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º—É, –Ω–µ –≤–∏–¥–Ω–æ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π. –ö–∞–∫ —Ä–∞–∑ –∑–∞–¥–∞—á–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ -- –∏—Ö –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–≤ –ø–æ —Ç–µ–º–∞–º, —Å –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, —Ç–µ—Ä–º–∏–Ω—ã, –∞ —Å –¥—Ä—É–≥–æ–π -- –¥–æ–∫—É–º–µ–Ω—Ç—ã.

–°–æ–∑–¥–∞—Ç–µ–ª–∏ –º–µ—Ç–æ–¥–∞ –Ω–∞–∑—ã–≤–∞—é—Ç LSA "—Ç–µ–æ—Ä–∏–µ–π —Å–º—ã—Å–ª–∞" –∏ –≤–∏–¥—è—Ç –≤ –Ω–µ–º –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –æ —Ç–æ–º, –∫–∞–∫ –Ω–æ—Å–∏—Ç–µ–ª–∏ —è–∑—ã–∫–∞ –ø—Ä–∏—Ö–æ–¥—è—Ç –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é —Å–º—ã—Å–ª–∞. –ö–∞–∫ –≤–æ–æ–±—â–µ –º–∞—à–∏–Ω–∞ –º–æ–∂–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å "–±–ª–∏–∑–∫–∏–µ" —Å–ª–æ–≤–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã? –í 1957 –±—Ä–∏—Ç–∞–Ω—Å–∫–∏–π –ª–∏–Ω–≥–≤–∏—Å—Ç –î–∂–æ–Ω –†—É–ø–µ—Ä—Ç –§—ë—Ä—Å —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–ª —ç—Ç–æ —Ç–∞–∫: you shall know a word by the company it keeps. –¢–æ–º–∞—Å –õ–∞–Ω–¥–∞—É–µ—Ä, –æ–¥–∏–Ω –∏–∑ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–π LSA, –æ–±–æ–±—â–∞–µ—Ç —ç—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –≤ —Å—Ç–∞—Ç—å–µ "LSA as a theory of meaning": —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ —Å–≤—è–∑–∏ –ø–µ—Ä–µ–æ—Ü–µ–Ω–µ–Ω—ã, –∏ —Å–º—ã—Å–ª –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤ –∏ —Ü–µ–ª—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ -- —ç—Ç–æ –ª–∏—à—å —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç —Å–º—ã—Å–ª–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–ª–æ–≤. –°–º—ã—Å–ª -- —ç—Ç–æ –Ω–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞, –∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ, –∏–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–Ω–æ—à–µ–Ω–∏–π. –ù–∞ —É—Ä–æ–≤–Ω–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ LSA –ø–æ–∫–∞–∑–∞–ª —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å –∑–∞–¥–∞—á–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ —Å–µ—Ä–µ–¥–∏–Ω—ã 90-—Ö —Å—á–∏—Ç–∞–ª–∏—Å—å –ø—Ä–µ—Ä–æ–≥–∞—Ç–∏–≤–æ–π –∂–∏–≤–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –ø–æ–ª–∏—Å–µ–º–∏–∏ –∏ —Å–∏–Ω–æ–Ω–∏–º–∏–∏. 


![](https://sysblok.ru/wp-content/uploads/2019/07/image16.gif)

## –í–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤


–ú—ã –º–æ–∂–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Ç–µ—Ä–º–∏–Ω –≤ –≤–∏–¥–µ –≤–µ–∫—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –µ–≥–æ –≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö. –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤–µ–∫—Ç–æ—Ä–∞ –±—É–¥–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ–π –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. –í –∞–Ω–≥–ª–æ—è–∑—ã—á–Ω–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –Ω–∞–∑—ã–≤–∞—é—Ç **—ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏** (embedding, —Ç.–µ. ¬´–≤–ª–æ–∂–µ–Ω–∏–µ¬ª). –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è –æ–±—ä–µ–∫—Ç –≤ –≤–∏–¥–µ –≤–µ–∫—Ç–æ—Ä–∞, –º—ã –∫–∞–∫ –±—ã ¬´–≤–∫–ª–∞–¥—ã–≤–∞–µ–º¬ª –µ–≥–æ –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –≥–¥–µ –¥–µ–π—Å—Ç–≤—É—é—Ç –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∑–∞–∫–æ–Ω—ã.

–î–∞–ª—å—à–µ –¥–µ–ª–æ –∑–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º **—Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è** (–∏–ª–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞) –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–∞–º–∏ -- —ç—Ç–æ —É–∂–µ –∑–∞–¥–∞—á–∞ –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä—ã. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–µ LSA –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ** (–æ —Ç–æ–º, —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ, —Å–º. –≤–∏–¥–µ–æ: [—á–∞—Å—Ç—å 1](https://vk.com/video-211800158_456239261) –∏ [—á–∞—Å—Ç—å 2](https://vk.com/video-211800158_456239263)).

![](images/dist.png)


–¢—Ä—É–¥–Ω–æ—Å—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –¥–∞–∂–µ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Ç–µ—Ä–º–¥–æ–∫—É–º–µ–Ω—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —è–≤–ª—è–µ—Ç—Å—è –æ—á–µ–Ω—å **—Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–π** (–¥–∞–∂–µ –≤ –Ω–µ–±–æ–ª—å—à–æ–º –ø—Ä–∏–º–µ—Ä–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É—Ä–æ–∫–∞ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–∞–≤–ª—è–ª–∞ –ø–æ—á—Ç–∏ 100%). –ß–µ–º –±–æ–ª—å—à–µ –≤–∞—à –∫–æ—Ä–ø—É—Å, —Ç–µ–º –±–æ–ª–µ–µ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–π –±—É–¥–µ—Ç –º–∞—Ç—Ä–∏—Ü–∞: —ç—Ç–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –ø–æ—Å–∫–æ–ª—å–∫—É –≤ –∫–∞–∂–¥–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –ª–∏—à—å –Ω–µ–±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –≤—Å–µ—Ö —Å–ª–æ–≤. 

–õ—é–±—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞–¥ —Ç–∞–∫–∏–º–∏ –º–∞—Ç—Ä–∏—Ü–∞–º–∏ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–∏—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç, –ø—Ä–∏ —ç—Ç–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –±—É–¥–µ—Ç —Ç–æ—á–Ω—ã–º –∏–∑-–∑–∞ —Å–∏–Ω–æ–Ω–∏–º–∏–∏ –∏ –ø–æ–ª–∏—Å–µ–º–∏–∏: —Å–ª–æ–≤–æ apple –º–æ–∂–Ω–æ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –∫–∞–∫ –≤ –ø–ª–æ–¥–æ–≤–æ-–æ–≤–æ—â–Ω–æ–π —Ä—É–±—Ä–∏–∫–µ, —Ç–∞–∫ –∏ –≤ –∑–∞–º–µ—Ç–∫–µ –æ–± IT. –°–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å —ç—Ç–∏–º –ø–æ–º–æ–≥–∞–µ—Ç –º–µ—Ç–æ–¥ LSA, –≤ –æ—Å–Ω–æ–≤–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –ª–µ–∂–∏—Ç **—Å–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏** –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã.

## –°–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã

–ú—ã –º–æ–∂–µ–º "—Å–ø—Ä–æ–µ—Ü–∏—Ä–æ–≤–∞—Ç—å" –∏—Å—Ö–æ–¥–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É $C_r$ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –º–µ–Ω—å—à–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏. –ï—Å–ª–∏ r -- —Ä–∞–Ω–≥ –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã, –∞ k -- —Ä–∞–Ω–≥ –Ω–æ–≤–æ–π –º–∞—Ç—Ä–∏—Ü—ã, –ø—Ä–∏ —ç—Ç–æ–º k –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∂–µ r, —Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ $C_k$ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–º–∞–ª–æ—Ä–∞–Ω–≥–æ–≤–æ–π –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–µ–π**. 

:::infobox
–†–∞–Ω–≥–æ–º —Å–∏—Å—Ç–µ–º—ã —Å—Ç—Ä–æ–∫ (—Å—Ç–æ–ª–±—Ü–æ–≤) –º–∞—Ç—Ä–∏—Ü—ã A —Å m —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ n —Å—Ç–æ–ª–±—Ü–∞–º–∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –ª–∏–Ω–µ–π–Ω–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å—Ç—Ä–æ–∫ (—Å—Ç–æ–ª–±—Ü–æ–≤). –ù–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ (—Å—Ç–æ–ª–±—Ü–æ–≤) –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –ª–∏–Ω–µ–π–Ω–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏, –µ—Å–ª–∏ –Ω–∏ –æ–¥–Ω–∞ –∏–∑ –Ω–∏—Ö –Ω–µ –≤—ã—Ä–∞–∂–∞–µ—Ç—Å—è –ª–∏–Ω–µ–π–Ω–æ —á–µ—Ä–µ–∑ –¥—Ä—É–≥–∏–µ. –†–∞–Ω–≥ —Å–∏—Å—Ç–µ–º—ã —Å—Ç—Ä–æ–∫ –≤—Å–µ–≥–¥–∞ —Ä–∞–≤–µ–Ω —Ä–∞–Ω–≥—É —Å–∏—Å—Ç–µ–º—ã —Å—Ç–æ–ª–±—Ü–æ–≤, –∏ —ç—Ç–æ —á–∏—Å–ª–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–∞–Ω–≥–æ–º –º–∞—Ç—Ä–∏—Ü—ã. 
:::

–î–ª—è –µ–µ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ–π –º–∞—Ç—Ä–∏—Ü—ã –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç—Ä–µ—Ö—ç—Ç–∞–ø–Ω–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞:

1.  –¥–ª—è $C_r$ —Å—Ç—Ä–æ–∏—Ç—Å—è –µ–µ **—Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ** (SVD (Singular Value Decomposition) –ø–æ —Ñ–æ—Ä–º—É–ª–µ: $C = UŒ£V^t$ (–ø–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [–≤–∏–¥–µ–æ](https://vk.com/video-211800158_456239325));

2.  –ø–æ –º–∞—Ç—Ä–∏—Ü–µ Œ£ —Å—Ç—Ä–æ–∏—Ç—Å—è $Œ£_k$: $r - k$ –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ –º–∞—Ç—Ä–∏—Ü—ã –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω—É–ª—è–º–∏;

3. –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ $C_k = UŒ£_kV^t$.

–¢–µ–ø–µ—Ä—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ. 

1. –ú–∞—Ç—Ä–∏—á–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ, –∏–ª–∏ **—Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** -- –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –≤ –≤–∏–¥–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∞—Ç—Ä–∏—Ü. –°–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ (SVD) –º–∞—Ç—Ä–∏—Ü—ã A —Ä–∞–≤–Ω–æ $A=U‚ãÖŒ£‚ãÖV^t$, –≥–¥–µ
- U ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –ª–µ–≤—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã A,
- Œ£ ‚Äî –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö —á–∏—Å–µ–ª –º–∞—Ç—Ä–∏—Ü—ã A,
- V ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∞–≤—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã A.

![](https://www.askpython.com/wp-content/uploads/2020/11/SVD-1.jpg.webp)

–°—Ç—Ä–æ–∫–∏ –º–∞—Ç—Ä–∏—Ü—ã U —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å–ª–æ–≤–∞–º; –∞ –≤ V^t —Å—Ç–æ–ª–±—Ü—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –º–∞—Ç—Ä–∏—Ü—ã U –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –≤ –∫–∞–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Å–ª–æ–≤–æ, –∞ –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü V^T –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ —Ç–µ–º—ã –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ.

2. **–°–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è** –≤ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ –≤—Å–µ–≥–¥–∞ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã –ø–æ —É–±—ã–≤–∞–Ω–∏—é, –∏ –º–æ–∂–Ω–æ –±–µ–∑ –±–æ–ª—å—à–∏—Ö –ø–æ—Ç–µ—Ä—å –æ—Ç—Å–µ—á—å –º–∞–ª–æ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Ä—è–¥—ã –∏–ª–∏ —Å—Ç–æ–ª–±—Ü—ã. –¢–∞–∫–æ–µ SVD –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **—É—Å–µ—á–µ–Ω–Ω—ã–º**.

**–°–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã** (–æ–Ω–∏ –≤—ã–¥–µ–ª–µ–Ω—ã —Ü–≤–µ—Ç–æ–º) –≤ –º–∞—Ç—Ä–∏—Ü–∞—Ö U –∏ V —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç–µ–º–∞–º –≤ —Ç–µ–∫—Å—Ç–µ, –∫–æ—Ç–æ—Ä—ã—Ö –≤ –æ–±—â–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ k —à—Ç—É–∫. –ß–µ–º—É —Ä–∞–≤–Ω–æ k ‚Äî —á–µ–ª–æ–≤–µ–∫ –∑–∞–¥–∞–µ—Ç –≤—Ä—É—á–Ω—É—é –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è. –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ –≤—ã—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –≤ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ –æ—Å—Ç–∞–µ—Ç—Å—è k —Å–∞–º—ã—Ö –±–æ–ª—å—à–∏—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö —á–∏—Å–µ–ª, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω—É–ª—è–º–∏. –ü—Ä–∏ –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–∏ –º–∞—Ç—Ä–∏—Ü —ç—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –æ—Ç—Å–µ—á–µ–Ω–∏—é $r - k$ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ U –∏ $r - k$ —Ä—è–¥–æ–≤ –≤ $V^t$. ([–ü–æ–¥—Ä–æ–±–Ω–µ–µ](https://sysblok.ru/knowhow/kak-ponjat-o-chem-tekst-ne-chitaja-ego/)).

3. –£–º–Ω–æ–∂–µ–Ω–∏–µ U –Ω–∞ Œ£ –¥–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤; —É–º–Ω–æ–∂–µ–Ω–∏–µ V –Ω–∞ Œ£-- –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (Dian I. Martin. Mathematical Foundations Behind Latent Semantic Analysis). –û–±—ä–µ–¥–∏–Ω—è—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å–ª–æ–≤ —Å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –º–æ–∂–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –±–ª–∏–∂–∞–π—à–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ –ø–æ–∏—Å–∫–æ–≤–æ–º—É –∑–∞–ø—Ä–æ—Å—É (–∫–æ—Ç–æ—Ä—ã–π –≤ —Ä–∞–º–∫–∞—Ö —ç—Ç–æ–π –º–æ–¥–µ–ª–∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ "–ø—Å–µ–≤–¥–æ–¥–æ–∫—É–º–µ–Ω—Ç"). 


## –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä

–í—Å–µ —ç—Ç–æ –±—É–¥–µ—Ç –ø–æ–Ω—è—Ç–Ω–µ–µ –Ω–∞ –ø—Ä–æ—Å—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ. ([–æ—Ç—Å—é–¥–∞](https://www.engr.uvic.ca/~seng474/svd.pdf)).

–î–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å –ø—è—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. 

_d1 : Romeo and Juliet._

_d2 : Juliet: O happy dagger!_

_d3 : Romeo died by dagger"._

_d4 : "Live free or die", that's the New-Hampshire's motto._

_d5 : Did you know, New Hampshire is in New-England._

–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å: _dies_, _dagger_. –û—á–µ–≤–∏–¥–Ω–æ, –±–ª–∏–∂–µ –≤—Å–µ–≥–æ –∫ –∑–∞–ø—Ä–æ—Å—É d3, —Ç.–∫. –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±–∞ —Å–ª–æ–≤–∞. –ù–æ –∫–∞–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∏–º? –ò d2, d4 —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ –æ–¥–Ω–æ–º—É —Å–ª–æ–≤—É –∏–∑ –∑–∞–ø—Ä–æ—Å–∞, –∞ —è–≤–Ω–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π d1 -- –Ω–∏ –æ–¥–Ω–æ–≥–æ. 

–°–æ—Å—Ç–∞–≤–∏–º —Ç–µ—Ä–º–¥–æ–∫—É–º–µ–Ω—Ç–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É.

```{r}
df = data.frame(d1 = c(c(1, 1), rep(0, 6)),
                d2 = c(c(0, 1, 1, 1), rep(0, 4)),
                d3 = c(1, 0, 0, 1, 0, 1, 0, 0),
                d4 = c(rep(0, 4), rep(1, 4)),
                d5 = c(rep(0, 7), c(1)))
rownames(df) <- c("romeo", "juliet", "happy", "dagger", "live",
                  "die", "free", "new-hampshire")             
df
```

–ò –ø—Ä–∏–º–µ–Ω–∏–º SVD. –í R –¥–ª—è —ç—Ç–æ–≥–æ –µ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–¥–∞–ª—å—à–µ –º—ã —É–≤–∏–¥–∏–º, —á—Ç–æ —Ç–æ –∂–µ —Å–∞–º–æ–µ –¥–µ–ª–∞—é—Ç –∏ –¥—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏).

```{r}
result = svd(df)
S = round((diag(result$d, nrow = length(result$d))), 3)

S
```
–°–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ–Ω—å—à–µ –¥–≤—É—Ö —É–±–∏—Ä–∞–µ–º, –æ—Å—Ç–∞–µ—Ç—Å—è –¥–≤–∞ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è.

```{r}
S_truncated <- S[1:2,1:2]

S_truncated
```
–ú–∞—Ç—Ä–∏—Ü–∞ –ª–µ–≤—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

```{r}
U <- round((result$u), 3)

U
```
–û—Ç –Ω–µ–µ –æ—Ç—Å–µ–∫–∞–µ–º –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã, –∫—Ä–æ–º–µ –ø–µ—Ä–≤—ã—Ö –¥–≤—É—Ö:

```{r}
U_truncated <- U[,1:2]

U_truncated
```

–ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∞–≤—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ —Ç–æ–∂–µ —É—Å–µ–∫–∞–µ—Ç—Å—è; –Ω–µ –∑–∞–±—É–¥–µ–º –µ–µ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞—Ç—å.

```{r}
V <- round((result$v), 3)

Vt_truncated <- t(V[,1:2])

Vt_truncated
```
–ö–∞–∂–¥—ã–π —Å—Ç–æ–ª–±–µ—Ü –≤ —ç—Ç–æ–π –º–∞—Ç—Ä–∏—Ü–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–æ–º—É –¥–æ–∫—É–º–µ–Ω—Ç—É.

–£–º–Ω–æ–∂–∏–º U –∏ Vt –Ω–∞ S_truncated (—É—Å–µ—á–µ–Ω–Ω—É—é —Å–∏–≥–º—É). 


```{r}
# —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å–ª–æ–≤
word_emb <- round((U_truncated %*% S_truncated), 3)

rownames(word_emb) <- c("romeo", "juliet", "happy", "dagger", "live", "die", "free", "new-hampshire") 

word_emb
```

```{r}
# —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
doc_emb <- round((S_truncated %*% Vt_truncated), 3)
colnames(doc_emb) <- c("d1", "d2", "d3", "d4", "d5")

doc_emb 
```
–ò–ª–∏, —á—Ç–æ —Ç–æ –∂–µ —Å–∞–º–æ–µ:

```{r}
V[,1:2] %*% S_truncated
```
:::infobox
–£–º–Ω–æ–∂–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É –ê –Ω–∞ –í –º–æ–∂–Ω–æ –ª–∏—à—å –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —á–∏—Å–ª–æ —Ä—è–¥–æ–≤ –≤ –í —Ä–∞–≤–Ω–æ —á–∏—Å–ª—É —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –ê ü§Øü§Øü§Ø
:::

–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (–∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –∫–∞–∫ –ø—Å–µ–≤–¥–æ–¥–æ–∫—É–º–µ–Ω—Ç) —Å—á–∏—Ç–∞–µ–º –∫–∞–∫ —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:

```{r}
q = c("die", "dagger")
q_doc <-  colSums(word_emb[rownames(word_emb) %in% q, ]) / 2
q_doc
```

–û–±—ä–µ–¥–∏–Ω–∏–≤ –≤—Å–µ –≤ –µ–¥–∏–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º, –º–æ–∂–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å.

```{r warning=FALSE, message=FALSE}
library(tidyverse)

all_df <- as.data.frame(rbind(word_emb, t(doc_emb), q_doc))

all_tbl <- as_tibble(all_df, rownames = "item")  %>% 
  mutate(type = c(rep("word", 8), rep("doc", 6))) %>% 
  rename(dim1 = V1, dim2 = V2)

all_tbl
```

```{r echo=FALSE}
zero = tibble(dim1 = 0, dim2 = 0)
line1 = all_tbl %>% filter(item == "d1") %>% 
  select(-item, -type) %>% bind_rows(zero)
line2 = all_tbl %>% filter(item == "d5") %>% 
  select(-item, -type) %>% bind_rows(zero)
lm1 = summary(lm(data=line1, dim2 ~ dim1))
lm2 = summary(lm(data=line2, dim2 ~ dim1))
```

–¢–µ–ø–µ—Ä—å —Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫.

```{r message=FALSE, echo=FALSE}
library(ggrepel)

all_tbl %>% 
  ggplot(aes(dim1, dim2, 
             color = as.factor(type), label = item)) +
  geom_point(show.legend = F) + 
  geom_text_repel(aes(fontface = "bold"), show.legend = F) +
  theme_bw() + 
  xlab(NULL) + 
  ylab(NULL) +
  geom_abline(slope = 0, intercept = 0, linetype = "dotted") +
  geom_vline(xintercept = -1.10, linetype = "dotted") +
  coord_cartesian(xlim = c(-1.7, 0.2), ylim = c(-1.5, 1.5)) +
  geom_abline(slope = lm1$coefficients[2], 
              intercept = lm1$coefficients[1], linetype = "dotted") + 
  geom_abline(slope = lm2$coefficients[2], 
              intercept = lm2$coefficients[1], linetype = "dotted")
```

–ö–∞–∫ –≤–∏–¥–Ω–æ, –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –æ–∫–∞–∑–∞–ª—Å—è –±–ª–∏–∂–µ –∫ d2, —á–µ–º –∫ d4, —Ö–æ—Ç—è –≤ –∫–∞–∂–¥–æ–º –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –±—ã–ª–æ –æ–¥–Ω–æ —Å–ª–æ–≤–æ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞. –ë–æ–ª–µ–µ —Ç–æ–≥–æ: –æ–Ω –æ–∫–∞–∑–∞–ª—Å—è –±–ª–∏–∂–µ –∫ d1, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–µ –±—ã–ª–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞! –ù–∞—à –∞–ª–≥–æ—Ä–∏—Ç–º –æ–∫–∞–∑–∞–ª—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–º–µ–Ω, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, —á—Ç–æ d1 –±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–µ–Ω, —Ö–æ—Ç—è –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ—á–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å –ø–æ–∏—Å–∫–æ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏. –í–æ–∑–º–æ–∂–Ω–æ, —á–µ–ª–æ–≤–µ–∫ –¥–∞–ª –±—ã —Ç–∞–∫—É—é –∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é.

–ú—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–ª–∏ –Ω–∞—à –Ω–µ–±–æ–ª—å—à–æ–π –∫–æ—Ä–ø—É—Å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏, —Ç–µ–ø–µ—Ä—å –ø–æ—Å—á–∏—Ç–∞–µ–º –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ.

```{r}
dist_mx <- all_df %>% 
  filter(row_number() %in% c(9:14)) %>%
  philentropy::distance(method = "cosine", use.row.names = T) 

dist_mx
```

## –í–µ–∫—Ç–æ—Ä—ã —Å–ª–æ–≤ 

–¢–µ–∫—Å—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ–ø—Ä—è—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –µ—Å–ª–∏ –æ–¥–Ω–æ–º—É –Ω–∞–±–ª—é–¥–µ–Ω–∏—é (—Ç–µ—Ä–º–∏–Ω—É) —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–∏–Ω —Ä—è–¥:

```{r}
library(tidyr)

tidy_corpus <- df %>% 
  as_tibble(rownames = "word") %>% 
  pivot_longer(d1:d5, names_to = "doc")

tidy_corpus
```

–ß—Ç–æ–±—ã –≤—ã—á–∏—Å–ª–∏—Ç—å svd, —Ç–∞–∫–æ–π –∫–æ—Ä–ø—É—Å –Ω–∞–¥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —à–∏—Ä–æ–∫–∏–π —Ñ–æ—Ä–º–∞—Ç, –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –≤—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –∞ –∑–∞—Ç–µ–º "—Ç–∞–π–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å". –î–ª—è –ø–æ–¥–æ–±–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ø–∞–∫–µ—Ç `widyr`. –§—É–Ω–∫—Ü–∏—é `pivot_wider()` —è –¥–æ–±–∞–≤–ª—è—é –ª–∏—à—å –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å —Ç–µ–º, —á—Ç–æ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –≤—ã—à–µ.


```{r}
library(widyr)

tidy_u <- tidy_corpus %>% 
  widely_svd(word, doc, value,
             nv = 2, maxit = 100) %>% 
  mutate(value = round(value, 3)) %>% 
  pivot_wider(names_from = dimension, values_from = value) 

tidy_u
```

–°—Ä–∞–≤–Ω–∏–º —Å —Ç–µ–º, —á—Ç–æ —É –Ω–∞—Å –ø–æ–ª—É—á–∏–ª–æ—Å—å –≤—ã—à–µ.

```{r}
U_truncated == tidy_u[,2:3]
```

–ò—Ç–∞–∫, –º—ã –ø–æ–ª—É—á–∏–ª–∏ —Ç–æ–ª—å–∫–æ –º–∞—Ç—Ä–∏—Ü—É –ª–µ–≤—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤. –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å word_emb, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç `weight_d`:

```{r}
tidy_word_emb <- tidy_corpus %>% 
  widely_svd(word, doc, value, 
             nv = 2, maxit = 100, 
             weight_d = T) %>%
  mutate(value = round(value, 3)) 


tidy_word_emb %>% 
  pivot_wider(names_from = dimension, values_from = value)
```
–°—Ä–∞–≤–Ω–∏–≤ —Å `word_emb` –≤—ã—à–µ, –≤–∏–¥–∏–º, —á—Ç–æ –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –Ω–µ –≤—Å–µ–≥–¥–∞ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ —Ç—ã—Å—è—á–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –Ω–æ –≤ –æ—Å—Ç–∞–ª—å–Ω–æ–º –≤—Å–µ –æ–∫.

## –í–µ–∫—Ç–æ—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: –æ–ø—Ä—è—Ç–Ω–æ

–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–Ω—è—Ç—å, –∫–∞–∫ _–æ–ø—Ä—è—Ç–Ω–æ_ –ø–æ–ª—É—á–∏—Ç—å doc_emb. –ó–¥–µ—Å—å –µ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –∫–∞–∫ –Ω–∞–±–æ—Ä —Å–ª–æ–≤^[https://smltar.com/embeddings.html#understand-word-embeddings-by-finding-them-yourself]. –ü–µ—Ä–µ–º–Ω–æ–∂–∏–≤ –º–∞—Ç—Ä–∏—Ü—É –¥–æ–∫—É–º–µ–Ω—Ç-—Ç–µ—Ä–º–∏–Ω –∏ –º–∞—Ç—Ä–∏—Ü—É —Å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ —Å–ª–æ–≤, –ø–æ–ª—É—á–∞–µ–º –∏—Å–∫–æ–º—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

–ß–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç—å —Å–ª–æ–≤ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –æ–±—ä–µ–∫—Ç–µ `tidy_corpus`, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –µ–≥–æ.

```{r}
library(tidytext)

dtm_mx <- tidy_corpus %>% 
  cast_sparse(doc, word, value)

dtm_mx
```

–≠–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å–ª–æ–≤ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Ç–æ—Ç –∂–µ —Ñ–æ—Ä–º–∞—Ç. 

```{r}
embedding_mx <- tidy_word_emb %>%
  cast_sparse(word, dimension, value)

embedding_mx
```
–ü–µ—Ä–µ–º–Ω–æ–∂–∞–µ–º —á–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç–∏ —Å–ª–æ–≤ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ –∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å–ª–æ–≤. 

```{r}
doc_mx <- dtm_mx %*% embedding_mx

tidy_doc_emb <- as.data.frame(as.matrix(doc_mx)) %>% 
  as_tibble(rownames = "item") %>% 
  rename(dim1 = `1`, dim2 = `2`)

tidy_doc_emb
```

–≠—Ç–æ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –≤—ã—à–µ, —Ç.–∫. –º—ã —Å—á–∏—Ç–∞–ª–∏ –¥—Ä—É–≥–∏–º —Å–ø–æ—Å–æ–±–æ–º.  –ù–æ –ª–µ–≥–∫–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–ª–æ–≤–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Ä–∞—Å–ø–æ–ª–æ–∂–∏–ª–∏—Å—å –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ:

```{r echo=FALSE, message=FALSE}
all_df <- tidy_word_emb %>% 
  pivot_wider(names_from = dimension, values_from = value) %>%
  rename(dim1 = `1`, dim2 = `2`, item = word) %>% 
  bind_rows(tidy_doc_emb) %>% 
  mutate(type = c(rep("word", 8), rep("doc", 5)))

zero = tibble(dim1 = 0, dim2 = 0)
line1 = all_df %>% 
  filter(item == "d1") %>% 
  select(-item, -type) %>% 
  bind_rows(zero)
line2 = all_df %>% 
  filter(item == "d5") %>% 
  select(-item, -type) %>% 
  bind_rows(zero)
lm1 = summary(lm(data=line1, dim2 ~ dim1))
lm2 = summary(lm(data=line2, dim2 ~ dim1))
```

```{r echo=FALSE, message=FALSE}
library(ggrepel)

all_df %>% 
  ggplot(aes(dim1, dim2, 
             color = as.factor(type), label = item)) +
  geom_point(show.legend = F) + 
  geom_text_repel(aes(fontface = "bold"), show.legend = F) +
  theme_bw() + 
  xlab(NULL) + 
  ylab(NULL) +
  geom_abline(slope = 0, intercept = 0, linetype = "dotted") +
  geom_abline(slope = lm1$coefficients[2], 
              intercept = lm1$coefficients[1], linetype = "dotted") + 
  geom_abline(slope = lm2$coefficients[2], 
              intercept = lm2$coefficients[1], linetype = "dotted") +
  coord_cartesian(xlim = c(-3.5, 0.2), ylim = c(-4, 3)) +
  geom_point(aes(x = -1.099, y = 0.124), show.legend = F) +
  geom_text(aes(x = -1.099, y = 0.124), label = "q", hjust = 2, show.legend = F)
```

–í–∏–¥–Ω–æ, —á—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç—ã "—É–µ—Ö–∞–ª–∏" –≤–ª–µ–≤–æ, –Ω–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç. 

## –ü–∞–∫–µ—Ç LSA

–ò–º–µ—è –º–∞—Ç—Ä–∏—Ü—É –¥–æ–∫—É–º–µ–Ω—Ç-—Ç–µ—Ä–º–∏–Ω, –º—ã –º–æ–∂–µ–º –±—ã—Å—Ç—Ä–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å, –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–∏—Å—å —Ñ—É–Ω–∫—Ü–∏–µ–π `lsa()` –∏–∑ –æ–¥–Ω–æ–∏–º–µ–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞. –û–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞ –≤—Ö–æ–¥–µ –º–∞—Ç—Ä–∏—Ü—É –¥–æ–∫—É–º–µ–Ω—Ç-—Ç–µ—Ä–º–∏–Ω, –∫–æ—Ç–æ—Ä—É—é –º—ã —Å–æ–∑–¥–∞–ª–∏ –≤—ã—à–µ.

```{r}
library(lsa)

lsaSpace <- lsa(dtm_mx, dims = 2)
```

–§—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω–µ—Ç —Å–ø–∏—Å–æ–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ö—Ä–∞–Ω—è—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º `tk`, `dk`, `sk`. –û–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –º–∞—Ç—Ä–∏—Ü–µ –ø—Ä–∞–≤—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ V, –º–∞—Ç—Ä–∏—Ü–µ –ø—Ä–∞–≤—ã—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ U, –∞ —Ç–∞–∫–∂–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º. –£–±–µ–¥–∏–º—Å—è –≤ —ç—Ç–æ–º.

```{r}
round(lsaSpace$tk, 3); t(Vt_truncated)
```

–î–ª—è –º–∞—Ç—Ä–∏—Ü—ã $V^t$ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç _–∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –∑–Ω–∞–∫–∞ –≤ –ø–µ—Ä–≤–æ–º —Å—Ç–æ–ª–±—Ü–µ_; —ç—Ç–æ —è–≤–ª–µ–Ω–∏–µ –∏–∑–≤–µ—Å—Ç–Ω–æ –∫–∞–∫ [sign ambiguity](https://www.educative.io/blog/sign-ambiguity-in-singular-value-decomposition). –ü–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –º–∞—Ç—Ä–∏—Ü—ã U —Ç–æ–∂–µ –º–µ–Ω—è–µ—Ç –∑–Ω–∞–∫, —Ç–∞–∫ —á—Ç–æ –ø—Ä–∏ –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–∏ –º—ã –≤–Ω–æ–≤—å –ø–æ–ª—É—á–∞–µ–º –∏—Å—Ö–æ–¥–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É. –£–±–µ–¥–∏–º—Å—è –≤ —ç—Ç–æ–º. 

```{r}
round(lsaSpace$dk, 3); U_truncated
```

–ß—Ç–æ–±—ã –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –ø–µ—Ä–µ–º–Ω–æ–∂–∞–µ–º –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –∏ $V^t$:

```{r}
diag(lsaSpace$sk) %*% t(lsaSpace$tk)
```

–≠—Ç–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–æ–ª—É—á–∏–ª–∏ —Ä–∞–Ω–µ–µ (–∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –∑–Ω–∞–∫–∞, –æ —á–µ–º —É–∂–µ –±—ã–ª–æ —Å–∫–∞–∑–∞–Ω–æ):

```{r}
doc_emb
```

–î–∞–ª—å—à–µ —ç—Ç–æ –º–æ–∂–Ω–æ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏, –∫–∞–∫ –º—ã —É–∂–µ –¥–µ–ª–∞–ª–∏, –∏ –ø—Ä–æ–¥–µ–ª–∞—Ç—å —Ç–æ –∂–µ —Å–∞–º–æ–µ —Å–æ —Å–ª–æ–≤–∞–º–∏. 


–§—É–Ω–∫—Ü–∏—è `cosine()` –∏–∑ –ø–∞–∫–µ—Ç–∞ `lda` —Å—á–∏—Ç–∞–µ—Ç –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–∞–º–∏ –∏–ª–∏ _—Å—Ç–æ–ª–±—Ü–∞–º–∏_ –º–∞—Ç—Ä–∏—Ü—ã (–±—É–¥—å—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã: –º–Ω–æ–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏–ª–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞ –æ–ø–µ—Ä–∏—Ä—É—é—Ç —Ä—è–¥–∞–º–∏!). –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, –≤—ã—á–∏—Ç–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ –µ–¥–∏–Ω–∏—Ü—ã.

```{r}
dist_cos <- as.dist(1 - cosine(doc_emb))
```

–ò–º–µ—è –º–∞—Ç—Ä–∏—Ü—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:

```{r}
hc <- hclust(dist_cos)
plot(hc)
```

"–ë—å—é—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å" —ç—Ç–æ –≥—Ä—É—Å—Ç–Ω–æ–µ –¥–µ—Ä–µ–≤—Ü–µ –º–æ–∂–Ω–æ —Ç—ã—Å—è—á—å—é —Ä–∞–∑–Ω—ã—Ö [—Å–ø–æ—Å–æ–±–æ–≤](http://www.sthda.com/english/wiki/beautiful-dendrogram-visualizations-in-r-5-must-known-methods-unsupervised-machine-learning), –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ [`ggdendro`](https://cran.r-project.org/web/packages/ggdendro/vignettes/ggdendro.html). –ö —Ç–µ–º–µ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤–µ—Ä–Ω–µ–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º —É—Ä–æ–∫–µ.

–ï—â–µ –æ–¥–Ω–∞ –ø–æ–ª–µ–∑–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ –ø–∞–∫–µ—Ç `lsa` –ø–µ—Ä–µ–º–Ω–æ–∂–∞–µ—Ç –≤—Å–µ —Ç—Ä–∏ –º–∞—Ç—Ä–∏—Ü—ã:

```{r}
as.textmatrix(lsaSpace)
```

–í–Ω—É—Ç—Ä–∏ —É —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

```{r}
t(lsaSpace$dk %*% diag(lsaSpace$sk) %*% t(lsaSpace$tk))
```

–≠—Ç—É –º–∞—Ç—Ä–∏—Ü—É —Ç–æ–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–æ—Å–∏–Ω—É—Å–Ω–æ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Ç–µ—Ä–º–∏–Ω–∞–º–∏ –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏. 

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–æ–ø–∏–∫–æ–≤

–î–ª—è –ª—É—á—à–µ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –±—ã–≤–∞–µ—Ç –ø–æ–ª–µ–∑–Ω–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∞–º–∏ —Ç–æ–ø–∏–∫–∏. –£ –Ω–∞—Å –∏–≥—Ä—É—à–µ—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä, –ø–æ—ç—Ç–æ–º—É –≤—ã–≥–ª—è–¥–∏—Ç —ç—Ç–æ –Ω–µ –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –ø–æ–¥—Ä–æ–±–Ω–µ–µ –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å [–∑–¥–µ—Å—å](https://smltar.com/embeddings.html#exploring-cfpb-word-embeddings).

```{r}
tidy_word_emb %>% 
  group_by(dimension) %>%
  arrange(abs(value)) %>% 
  slice_head(n = 3) %>% 
  ungroup() %>% 
  mutate(word = reorder_within(word, value, dimension)) %>% 
  ggplot(aes(word, value, fill = dimension)) +
  geom_col(show.legend = F) +
  facet_wrap(~dimension, scales = "free_y", ncol = 4) +
  scale_x_reordered() +
  coord_flip()
  
```

## –ü–∞–∫–µ—Ç TextmineR

–í—Å–µ —Ç–µ –∂–µ –∑–∞–¥–∞—á–∏ —Ä–µ—à–∞–µ—Ç –ø–∞–∫–µ—Ç textmineR, –Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –µ–≥–æ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –Ω–∞ MacOS. –ö–∞–∫ –∏—Ö —Ä–µ—à–∏—Ç—å, —Å–º. [–∑–¥–µ—Å—å](https://github.com/coatless-mac/macrtools). 

```{r}
# –¥–ª—è MacOS
# remotes::install_github("coatless-mac/macrtools")
# macrtools::macos_rtools_install()
```

–ï—Å–ª–∏ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π:

```{r message=FALSE}
library(textmineR)
lsa_model <- FitLsaModel(dtm_mx, k = 2)
```

–°–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
```{r}
lsa_model$sv
```

–ü—Ä–∞–≤—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –∑–¥–µ—Å—å –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è "—Ç–µ—Ç–∞" (—Å–º. [–≤–∏–Ω—å–µ—Ç–∫—É](https://cran.r-project.org/web/packages/textmineR/vignettes/c_topic_modeling.html)): $Œò = ùëÉ(topik_k|document_d)$

```{r}
lsa_model$theta
```

–õ–µ–≤—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –∑–¥–µ—Å—å –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è "—Ñ–∏": $Œ¶ = P(token_v|topic_k)$

```{r}
lsa_model$phi
```
–£–¥–æ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ—Å—Ç–∞—Ç—å –≥–ª–∞–≤–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –¥–ª—è —Ç–æ–ø–∏–∫–æ–≤.

```{r}
GetTopTerms(phi = lsa_model$phi, M = 3)
```