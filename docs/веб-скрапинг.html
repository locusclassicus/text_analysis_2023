<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Тема 9 Веб-скрапинг | Компьютерный анализ текста в R</title>
  <meta name="description" content="Все прекрасное трудно." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Тема 9 Веб-скрапинг | Компьютерный анализ текста в R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Все прекрасное трудно." />
  <meta name="github-repo" content="https://github.com/locusclassicus/text_analysis_r_bookdown_2023/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Тема 9 Веб-скрапинг | Компьютерный анализ текста в R" />
  
  <meta name="twitter:description" content="Все прекрасное трудно." />
  

<meta name="author" content="Ольга Алиева" />


<meta name="date" content="2023-09-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="регулярные-выражения.html"/>
<link rel="next" href="токенизация-и-лемматизация.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.29/datatables.js"></script>
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Компьютерный анализ текста в R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#благодарности"><i class="fa fa-check"></i><b>1.1</b> Благодарности</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html"><i class="fa fa-check"></i><b>2</b> Начало работы с R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#о-чем-этот-курс"><i class="fa fa-check"></i><b>2.1</b> О чем этот курс</a></li>
<li class="chapter" data-level="2.2" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#что-такое-r"><i class="fa fa-check"></i><b>2.2</b> Что такое R?</a></li>
<li class="chapter" data-level="2.3" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#пакеты-и-виньетки"><i class="fa fa-check"></i><b>2.3</b> Пакеты и виньетки</a></li>
<li class="chapter" data-level="2.4" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#о-воспроизводимости"><i class="fa fa-check"></i><b>2.4</b> О воспроизводимости</a></li>
<li class="chapter" data-level="2.5" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#rstudio"><i class="fa fa-check"></i><b>2.5</b> RStudio</a></li>
<li class="chapter" data-level="2.6" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#установка"><i class="fa fa-check"></i><b>2.6</b> Установка</a></li>
<li class="chapter" data-level="2.7" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#начало-работы"><i class="fa fa-check"></i><b>2.7</b> Начало работы</a></li>
<li class="chapter" data-level="2.8" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#r-как-калькулятор"><i class="fa fa-check"></i><b>2.8</b> R как калькулятор</a></li>
<li class="chapter" data-level="2.9" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#операторы-присваивания"><i class="fa fa-check"></i><b>2.9</b> Операторы присваивания</a></li>
<li class="chapter" data-level="2.10" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#векторы"><i class="fa fa-check"></i><b>2.10</b> Векторы</a></li>
<li class="chapter" data-level="2.11" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#отсутствующие-значения"><i class="fa fa-check"></i><b>2.11</b> Отсутствующие значения</a></li>
<li class="chapter" data-level="2.12" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#списки"><i class="fa fa-check"></i><b>2.12</b> Списки</a></li>
<li class="chapter" data-level="2.13" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#матрицы"><i class="fa fa-check"></i><b>2.13</b> Матрицы</a></li>
<li class="chapter" data-level="2.14" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#таблицы"><i class="fa fa-check"></i><b>2.14</b> Таблицы</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="визуализации.html"><a href="визуализации.html"><i class="fa fa-check"></i><b>3</b> Визуализации</a>
<ul>
<li class="chapter" data-level="3.1" data-path="визуализации.html"><a href="визуализации.html#базовый-r"><i class="fa fa-check"></i><b>3.1</b> Базовый R</a></li>
<li class="chapter" data-level="3.2" data-path="визуализации.html"><a href="визуализации.html#lattice"><i class="fa fa-check"></i><b>3.2</b> Lattice</a></li>
<li class="chapter" data-level="3.3" data-path="визуализации.html"><a href="визуализации.html#ggplot2"><i class="fa fa-check"></i><b>3.3</b> Ggplot2</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="визуализации.html"><a href="визуализации.html#быстрое-решение-qplot"><i class="fa fa-check"></i><b>3.3.1</b> Быстрое решение: qplot()</a></li>
<li class="chapter" data-level="3.3.2" data-path="визуализации.html"><a href="визуализации.html#слой-за-слоем-ggplot"><i class="fa fa-check"></i><b>3.3.2</b> Слой за слоем: ggplot()</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="визуализации.html"><a href="визуализации.html#работа-с-цветом"><i class="fa fa-check"></i><b>3.4</b> Работа с цветом</a></li>
<li class="chapter" data-level="3.5" data-path="визуализации.html"><a href="визуализации.html#экспорт-графиков-из-среды-r"><i class="fa fa-check"></i><b>3.5</b> Экспорт графиков из среды R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="опрятные-данные.html"><a href="опрятные-данные.html"><i class="fa fa-check"></i><b>4</b> Опрятные данные</a>
<ul>
<li class="chapter" data-level="4.1" data-path="опрятные-данные.html"><a href="опрятные-данные.html#синтаксис-tidyverse"><i class="fa fa-check"></i><b>4.1</b> Синтаксис tidyverse</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="опрятные-данные.html"><a href="опрятные-данные.html#tibble"><i class="fa fa-check"></i><b>4.1.1</b> Tibble</a></li>
<li class="chapter" data-level="4.1.2" data-path="опрятные-данные.html"><a href="опрятные-данные.html#dplyr"><i class="fa fa-check"></i><b>4.1.2</b> Dplyr</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="опрятные-данные.html"><a href="опрятные-данные.html#опрятные-данные-1"><i class="fa fa-check"></i><b>4.2</b> Опрятные данные</a></li>
<li class="chapter" data-level="4.3" data-path="опрятные-данные.html"><a href="опрятные-данные.html#пример-буккроссинг"><i class="fa fa-check"></i><b>4.3</b> Пример: буккроссинг</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="опрятные-данные.html"><a href="опрятные-данные.html#смотрим-на-данные"><i class="fa fa-check"></i><b>4.3.1</b> Смотрим на данные</a></li>
<li class="chapter" data-level="4.3.2" data-path="опрятные-данные.html"><a href="опрятные-данные.html#трансформируем-данные"><i class="fa fa-check"></i><b>4.3.2</b> Трансформируем данные</a></li>
<li class="chapter" data-level="4.3.3" data-path="опрятные-данные.html"><a href="опрятные-данные.html#объединяем-данные"><i class="fa fa-check"></i><b>4.3.3</b> Объединяем данные</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html"><i class="fa fa-check"></i><b>5</b> Функциональное программирование</a>
<ul>
<li class="chapter" data-level="5.1" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#зачем-писать-функции"><i class="fa fa-check"></i><b>5.1</b> Зачем писать функции?</a></li>
<li class="chapter" data-level="5.2" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#область-видимости-переменных"><i class="fa fa-check"></i><b>5.2</b> Область видимости переменных</a></li>
<li class="chapter" data-level="5.3" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#аргументы-функции"><i class="fa fa-check"></i><b>5.3</b> Аргументы функции</a></li>
<li class="chapter" data-level="5.4" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#векторизируй-это"><i class="fa fa-check"></i><b>5.4</b> Векторизируй это</a></li>
<li class="chapter" data-level="5.5" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#векторизованные-конструкции"><i class="fa fa-check"></i><b>5.5</b> Векторизованные конструкции</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#циклы"><i class="fa fa-check"></i><b>5.5.1</b> Циклы</a></li>
<li class="chapter" data-level="5.5.2" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#условия"><i class="fa fa-check"></i><b>5.5.2</b> Условия</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#вместо-циклов-базовый-r-и-tidyverse"><i class="fa fa-check"></i><b>5.6</b> Вместо циклов: базовый R и tidyverse</a></li>
<li class="chapter" data-level="5.7" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#purrr"><i class="fa fa-check"></i><b>5.7</b> Purrr</a></li>
<li class="chapter" data-level="5.8" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#пример-итерации"><i class="fa fa-check"></i><b>5.8</b> Пример итерации</a></li>
<li class="chapter" data-level="5.9" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#furrr"><i class="fa fa-check"></i><b>5.9</b> Furrr</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html"><i class="fa fa-check"></i><b>6</b> Импорт и экспорт данных</a>
<ul>
<li class="chapter" data-level="6.1" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#рабочая-директория"><i class="fa fa-check"></i><b>6.1</b> Рабочая директория</a></li>
<li class="chapter" data-level="6.2" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#чтение-файлов-из-интернета"><i class="fa fa-check"></i><b>6.2</b> Чтение файлов из интернета</a></li>
<li class="chapter" data-level="6.3" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#чтение-локальных-файлов"><i class="fa fa-check"></i><b>6.3</b> Чтение локальных файлов</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#csv-и-tsv"><i class="fa fa-check"></i><b>6.3.1</b> csv и tsv</a></li>
<li class="chapter" data-level="6.3.2" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#xls-и-xlsx"><i class="fa fa-check"></i><b>6.3.2</b> xls и xlsx</a></li>
<li class="chapter" data-level="6.3.3" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#txt"><i class="fa fa-check"></i><b>6.3.3</b> txt</a></li>
<li class="chapter" data-level="6.3.4" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#doc"><i class="fa fa-check"></i><b>6.3.4</b> doc</a></li>
<li class="chapter" data-level="6.3.5" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#pdf"><i class="fa fa-check"></i><b>6.3.5</b> pdf</a></li>
<li class="chapter" data-level="6.3.6" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#png"><i class="fa fa-check"></i><b>6.3.6</b> png</a></li>
<li class="chapter" data-level="6.3.7" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#zip"><i class="fa fa-check"></i><b>6.3.7</b> zip</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#xml-и-html"><i class="fa fa-check"></i><b>6.4</b> xml и html</a></li>
<li class="chapter" data-level="6.5" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#json"><i class="fa fa-check"></i><b>6.5</b> json</a></li>
<li class="chapter" data-level="6.6" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#gutenbergr"><i class="fa fa-check"></i><b>6.6</b> GutenbergR</a></li>
<li class="chapter" data-level="6.7" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#rperseus"><i class="fa fa-check"></i><b>6.7</b> RPerseus</a></li>
<li class="chapter" data-level="6.8" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#чтение-нескольких-файлов"><i class="fa fa-check"></i><b>6.8</b> Чтение нескольких файлов</a></li>
<li class="chapter" data-level="6.9" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#экспорт"><i class="fa fa-check"></i><b>6.9</b> Экспорт</a></li>
<li class="chapter" data-level="6.10" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#rdata"><i class="fa fa-check"></i><b>6.10</b> Rdata</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html"><i class="fa fa-check"></i><b>7</b> Воспроизводимые исследования</a>
<ul>
<li class="chapter" data-level="7.1" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#о-воспроизводимости-1"><i class="fa fa-check"></i><b>7.1</b> О воспроизводимости</a></li>
<li class="chapter" data-level="7.2" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#markdown"><i class="fa fa-check"></i><b>7.2</b> Markdown</a></li>
<li class="chapter" data-level="7.3" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#синтаксис-markdown"><i class="fa fa-check"></i><b>7.3</b> Синтаксис Markdown</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#заголовки"><i class="fa fa-check"></i><b>7.3.1</b> Заголовки</a></li>
<li class="chapter" data-level="7.3.2" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#форматирование"><i class="fa fa-check"></i><b>7.3.2</b> Форматирование</a></li>
<li class="chapter" data-level="7.3.3" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#списки-1"><i class="fa fa-check"></i><b>7.3.3</b> Списки</a></li>
<li class="chapter" data-level="7.3.4" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#ссылки"><i class="fa fa-check"></i><b>7.3.4</b> Ссылки</a></li>
<li class="chapter" data-level="7.3.5" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#изображения"><i class="fa fa-check"></i><b>7.3.5</b> Изображения</a></li>
<li class="chapter" data-level="7.3.6" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#блоки-кода"><i class="fa fa-check"></i><b>7.3.6</b> Блоки кода</a></li>
<li class="chapter" data-level="7.3.7" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#цитаты"><i class="fa fa-check"></i><b>7.3.7</b> Цитаты</a></li>
<li class="chapter" data-level="7.3.8" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#разделители"><i class="fa fa-check"></i><b>7.3.8</b> Разделители</a></li>
<li class="chapter" data-level="7.3.9" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#таблицы-1"><i class="fa fa-check"></i><b>7.3.9</b> Таблицы</a></li>
<li class="chapter" data-level="7.3.10" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#id"><i class="fa fa-check"></i><b>7.3.10</b> Чек-листы</a></li>
<li class="chapter" data-level="7.3.11" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#внутренние-ссылки"><i class="fa fa-check"></i><b>7.3.11</b> Внутренние ссылки</a></li>
<li class="chapter" data-level="7.3.12" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#графики"><i class="fa fa-check"></i><b>7.3.12</b> Графики</a></li>
<li class="chapter" data-level="7.3.13" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#математические-формулы"><i class="fa fa-check"></i><b>7.3.13</b> Математические формулы</a></li>
<li class="chapter" data-level="7.3.14" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#библиография"><i class="fa fa-check"></i><b>7.3.14</b> Библиография</a></li>
<li class="chapter" data-level="7.3.15" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#смайлы"><i class="fa fa-check"></i><b>7.3.15</b> Смайлы</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#публикация-html"><i class="fa fa-check"></i><b>7.4</b> Публикация html</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html"><i class="fa fa-check"></i><b>8</b> Регулярные выражения</a>
<ul>
<li class="chapter" data-level="8.1" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#regex-в-базовом-r"><i class="fa fa-check"></i><b>8.1</b> Regex в базовом R</a></li>
<li class="chapter" data-level="8.2" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#литералы-и-классы"><i class="fa fa-check"></i><b>8.2</b> Литералы и классы</a></li>
<li class="chapter" data-level="8.3" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#якоря"><i class="fa fa-check"></i><b>8.3</b> Якоря</a></li>
<li class="chapter" data-level="8.4" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#метасимволы"><i class="fa fa-check"></i><b>8.4</b> Метасимволы</a></li>
<li class="chapter" data-level="8.5" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#экранирование"><i class="fa fa-check"></i><b>8.5</b> Экранирование</a></li>
<li class="chapter" data-level="8.6" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#квантификация"><i class="fa fa-check"></i><b>8.6</b> Квантификация</a></li>
<li class="chapter" data-level="8.7" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#жадная-и-ленивая-квантификация"><i class="fa fa-check"></i><b>8.7</b> Жадная и ленивая квантификация</a></li>
<li class="chapter" data-level="8.8" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#regex-в-stringr-основы"><i class="fa fa-check"></i><b>8.8</b> Regex в stringr: основы</a></li>
<li class="chapter" data-level="8.9" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_detect-и-str_count"><i class="fa fa-check"></i><b>8.9</b> str_detect() и str_count()</a></li>
<li class="chapter" data-level="8.10" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_extract"><i class="fa fa-check"></i><b>8.10</b> str_extract()</a></li>
<li class="chapter" data-level="8.11" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_subset-и-str_match"><i class="fa fa-check"></i><b>8.11</b> str_subset() и str_match()</a></li>
<li class="chapter" data-level="8.12" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_replace"><i class="fa fa-check"></i><b>8.12</b> str_replace</a></li>
<li class="chapter" data-level="8.13" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_split"><i class="fa fa-check"></i><b>8.13</b> str_split</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html"><i class="fa fa-check"></i><b>9</b> Веб-скрапинг</a>
<ul>
<li class="chapter" data-level="9.1" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#структура-html"><i class="fa fa-check"></i><b>9.1</b> Структура html</a></li>
<li class="chapter" data-level="9.2" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#каскадные-таблицы-стилей"><i class="fa fa-check"></i><b>9.2</b> Каскадные таблицы стилей</a></li>
<li class="chapter" data-level="9.3" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#извлечение-данных"><i class="fa fa-check"></i><b>9.3</b> Извлечение данных</a></li>
<li class="chapter" data-level="9.4" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#извлечение-в-тиббл"><i class="fa fa-check"></i><b>9.4</b> Извлечение в тиббл</a></li>
<li class="chapter" data-level="9.5" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#скрапим-телеграм-канал"><i class="fa fa-check"></i><b>9.5</b> Скрапим телеграм-канал</a></li>
<li class="chapter" data-level="9.6" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#эмотиконы"><i class="fa fa-check"></i><b>9.6</b> Эмотиконы</a></li>
<li class="chapter" data-level="9.7" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#рутинная-уборка"><i class="fa fa-check"></i><b>9.7</b> Рутинная уборка</a></li>
<li class="chapter" data-level="9.8" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#лемматизация"><i class="fa fa-check"></i><b>9.8</b> Лемматизация</a></li>
<li class="chapter" data-level="9.9" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#html-таблицы"><i class="fa fa-check"></i><b>9.9</b> Html таблицы</a></li>
<li class="chapter" data-level="9.10" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#wikisource"><i class="fa fa-check"></i><b>9.10</b> Wikisource</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html"><i class="fa fa-check"></i><b>10</b> Токенизация и лемматизация</a>
<ul>
<li class="chapter" data-level="10.1" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#токенизация-в-tidytext"><i class="fa fa-check"></i><b>10.1</b> Токенизация в tidytext</a></li>
<li class="chapter" data-level="10.2" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#токенизация-в-tokenizers"><i class="fa fa-check"></i><b>10.2</b> Токенизация в tokenizers</a></li>
<li class="chapter" data-level="10.3" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#скипграмы"><i class="fa fa-check"></i><b>10.3</b> Скипграмы</a></li>
<li class="chapter" data-level="10.4" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#лемматизация-и-частеречная-разметка"><i class="fa fa-check"></i><b>10.4</b> Лемматизация и частеречная разметка</a></li>
<li class="chapter" data-level="10.5" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#морфологическая-разметка"><i class="fa fa-check"></i><b>10.5</b> Морфологическая разметка</a></li>
<li class="chapter" data-level="10.6" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#распределение-частей-речи"><i class="fa fa-check"></i><b>10.6</b> Распределение частей речи</a></li>
<li class="chapter" data-level="10.7" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#совместная-встречаемость-слов"><i class="fa fa-check"></i><b>10.7</b> Совместная встречаемость слов</a></li>
<li class="chapter" data-level="10.8" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#синтаксическая-разметка"><i class="fa fa-check"></i><b>10.8</b> Синтаксическая разметка</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html"><i class="fa fa-check"></i><b>11</b> Распределения слов и анализ частотностей</a>
<ul>
<li class="chapter" data-level="11.1" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#извлечение-источников"><i class="fa fa-check"></i><b>11.1</b> Извлечение источников</a></li>
<li class="chapter" data-level="11.2" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#подготовка-источников"><i class="fa fa-check"></i><b>11.2</b> Подготовка источников</a></li>
<li class="chapter" data-level="11.3" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#токенизация"><i class="fa fa-check"></i><b>11.3</b> Токенизация</a></li>
<li class="chapter" data-level="11.4" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#cтоп-слова"><i class="fa fa-check"></i><b>11.4</b> Cтоп-слова</a></li>
<li class="chapter" data-level="11.5" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#абсолютная-частотность"><i class="fa fa-check"></i><b>11.5</b> Абсолютная частотность</a></li>
<li class="chapter" data-level="11.6" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#стемминг"><i class="fa fa-check"></i><b>11.6</b> Стемминг</a></li>
<li class="chapter" data-level="11.7" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#относительная-частотность"><i class="fa fa-check"></i><b>11.7</b> Относительная частотность</a></li>
<li class="chapter" data-level="11.8" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#распределения-слов-токенов"><i class="fa fa-check"></i><b>11.8</b> Распределения слов (токенов)</a></li>
<li class="chapter" data-level="11.9" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#закон-ципфа"><i class="fa fa-check"></i><b>11.9</b> Закон Ципфа</a></li>
<li class="chapter" data-level="11.10" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#ttr-type-token-ratio"><i class="fa fa-check"></i><b>11.10</b> TTR (type-token ratio)</a></li>
<li class="chapter" data-level="11.11" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#tf-idf"><i class="fa fa-check"></i><b>11.11</b> TF-IDF</a></li>
<li class="chapter" data-level="11.12" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#сравнение-при-помощи-диаграммы-рассеяния"><i class="fa fa-check"></i><b>11.12</b> Сравнение при помощи диаграммы рассеяния</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html"><i class="fa fa-check"></i><b>12</b> Эмоциональная тональность</a>
<ul>
<li class="chapter" data-level="12.1" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#анализ-тональности"><i class="fa fa-check"></i><b>12.1</b> Анализ тональности</a></li>
<li class="chapter" data-level="12.2" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#подходы"><i class="fa fa-check"></i><b>12.2</b> Подходы</a></li>
<li class="chapter" data-level="12.3" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#тезаурусы"><i class="fa fa-check"></i><b>12.3</b> Тезаурусы</a></li>
<li class="chapter" data-level="12.4" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#лексиконы-для-русского-языка"><i class="fa fa-check"></i><b>12.4</b> Лексиконы для русского языка</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#chen-skiena"><i class="fa fa-check"></i><b>12.4.1</b> Chen &amp; Skiena</a></li>
<li class="chapter" data-level="12.4.2" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#rusentlex-2016"><i class="fa fa-check"></i><b>12.4.2</b> RuSentLex 2016</a></li>
<li class="chapter" data-level="12.4.3" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#afinn"><i class="fa fa-check"></i><b>12.4.3</b> AFINN</a></li>
<li class="chapter" data-level="12.4.4" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#nrc"><i class="fa fa-check"></i><b>12.4.4</b> NRC</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#анализ-тональности-с-tidy-data"><i class="fa fa-check"></i><b>12.5</b> Анализ тональности с Tidy Data</a></li>
<li class="chapter" data-level="12.6" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#подготовка-текста"><i class="fa fa-check"></i><b>12.6</b> Подготовка текста</a></li>
<li class="chapter" data-level="12.7" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#модификация-лексикона"><i class="fa fa-check"></i><b>12.7</b> Модификация лексикона</a></li>
<li class="chapter" data-level="12.8" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#соединение-лексикона-и-текста"><i class="fa fa-check"></i><b>12.8</b> Соединение лексикона и текста</a></li>
<li class="chapter" data-level="12.9" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#тональность-на-оси-времени"><i class="fa fa-check"></i><b>12.9</b> Тональность на оси времени</a></li>
<li class="chapter" data-level="12.10" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#для-других-языков"><i class="fa fa-check"></i><b>12.10</b> Для других языков</a></li>
<li class="chapter" data-level="12.11" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#виды-эмоций"><i class="fa fa-check"></i><b>12.11</b> Виды эмоций</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html"><i class="fa fa-check"></i><b>13</b> Тематическое моделирование</a>
<ul>
<li class="chapter" data-level="13.1" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#что-такое-lda"><i class="fa fa-check"></i><b>13.1</b> Что такое LDA</a></li>
<li class="chapter" data-level="13.2" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#распределение-дирихле"><i class="fa fa-check"></i><b>13.2</b> Распределение Дирихле</a></li>
<li class="chapter" data-level="13.3" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#подтоговка-данных"><i class="fa fa-check"></i><b>13.3</b> Подтоговка данных</a></li>
<li class="chapter" data-level="13.4" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#матрица-встречаемости"><i class="fa fa-check"></i><b>13.4</b> Матрица встречаемости</a></li>
<li class="chapter" data-level="13.5" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#число-тем"><i class="fa fa-check"></i><b>13.5</b> Число тем</a></li>
<li class="chapter" data-level="13.6" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#модель-lda"><i class="fa fa-check"></i><b>13.6</b> Модель LDA</a></li>
<li class="chapter" data-level="13.7" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#слова-и-темы"><i class="fa fa-check"></i><b>13.7</b> Слова и темы</a></li>
<li class="chapter" data-level="13.8" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#сравнение-топиков"><i class="fa fa-check"></i><b>13.8</b> Сравнение топиков</a></li>
<li class="chapter" data-level="13.9" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#темы-и-документы"><i class="fa fa-check"></i><b>13.9</b> Темы и документы</a></li>
<li class="chapter" data-level="13.10" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#распределения-вероятности-для-топиков"><i class="fa fa-check"></i><b>13.10</b> Распределения вероятности для топиков</a></li>
<li class="chapter" data-level="13.11" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#интерактивные-визуализации"><i class="fa fa-check"></i><b>13.11</b> Интерактивные визуализации</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html"><i class="fa fa-check"></i><b>14</b> Латентно-семантический анализ</a>
<ul>
<li class="chapter" data-level="14.1" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#что-это-такое"><i class="fa fa-check"></i><b>14.1</b> Что это такое</a></li>
<li class="chapter" data-level="14.2" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#векторное-представление-слов"><i class="fa fa-check"></i><b>14.2</b> Векторное представление слов</a></li>
<li class="chapter" data-level="14.3" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#сингулярное-разложение-матрицы"><i class="fa fa-check"></i><b>14.3</b> Сингулярное разложение матрицы</a></li>
<li class="chapter" data-level="14.4" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#простой-пример"><i class="fa fa-check"></i><b>14.4</b> Простой пример</a></li>
<li class="chapter" data-level="14.5" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#векторы-слов"><i class="fa fa-check"></i><b>14.5</b> Векторы слов</a></li>
<li class="chapter" data-level="14.6" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#пакеты-для-работы-с-lsa"><i class="fa fa-check"></i><b>14.6</b> Пакеты для работы с LSA</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#lsa"><i class="fa fa-check"></i><b>14.6.1</b> lsa</a></li>
<li class="chapter" data-level="14.6.2" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#textminer"><i class="fa fa-check"></i><b>14.6.2</b> TextmineR</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#lsa-c-использованием-tidy-data"><i class="fa fa-check"></i><b>14.7</b> LSA c использованием Tidy Data</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html"><i class="fa fa-check"></i><b>15</b> Кластеризация и метод главных компонент</a>
<ul>
<li class="chapter" data-level="15.1" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#виды-кластерного-анализа"><i class="fa fa-check"></i><b>15.1</b> Виды кластерного анализа</a></li>
<li class="chapter" data-level="15.2" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#кластеризация-по-методу-k-средних"><i class="fa fa-check"></i><b>15.2</b> Кластеризация по методу K средних</a></li>
<li class="chapter" data-level="15.3" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#k-means-в-r"><i class="fa fa-check"></i><b>15.3</b> K-means в R</a></li>
<li class="chapter" data-level="15.4" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#k-means-для-кластеризации-текстов"><i class="fa fa-check"></i><b>15.4</b> K-means для кластеризации текстов</a></li>
<li class="chapter" data-level="15.5" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#нормализация-данных"><i class="fa fa-check"></i><b>15.5</b> Нормализация данных</a></li>
<li class="chapter" data-level="15.6" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#иерархическая-кластеризация"><i class="fa fa-check"></i><b>15.6</b> Иерархическая кластеризация</a></li>
<li class="chapter" data-level="15.7" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#алгоритм-иерархической-кластеризации"><i class="fa fa-check"></i><b>15.7</b> Алгоритм иерархической кластеризации</a></li>
<li class="chapter" data-level="15.8" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#иерархическая-кластеризация-в-r"><i class="fa fa-check"></i><b>15.8</b> Иерархическая кластеризация в R</a></li>
<li class="chapter" data-level="15.9" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#иерархическая-кластеризация-текстов"><i class="fa fa-check"></i><b>15.9</b> Иерархическая кластеризация текстов</a></li>
<li class="chapter" data-level="15.10" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#метод-главных-компонент"><i class="fa fa-check"></i><b>15.10</b> Метод главных компонент</a></li>
<li class="chapter" data-level="15.11" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#pca-для-визуализации-кластеров-k-means"><i class="fa fa-check"></i><b>15.11</b> PCA для визуализации кластеров K-means</a></li>
<li class="chapter" data-level="15.12" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#pca-и-иерархическая-кластеризация"><i class="fa fa-check"></i><b>15.12</b> PCA и иерархическая кластеризация</a></li>
<li class="chapter" data-level="15.13" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#многомерное-шкалирование"><i class="fa fa-check"></i><b>15.13</b> Многомерное шкалирование</a></li>
<li class="chapter" data-level="15.14" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#pca-с-factominer"><i class="fa fa-check"></i><b>15.14</b> PCA с FactoMineR</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html"><i class="fa fa-check"></i><b>16</b> Сетевые данные и графы</a>
<ul>
<li class="chapter" data-level="16.1" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#базовое-описание"><i class="fa fa-check"></i><b>16.1</b> Базовое описание</a></li>
<li class="chapter" data-level="16.2" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#создание-сетевых-данных"><i class="fa fa-check"></i><b>16.2</b> Создание сетевых данных</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#социоматрица"><i class="fa fa-check"></i><b>16.2.1</b> Социоматрица</a></li>
<li class="chapter" data-level="16.2.2" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#список-ребер"><i class="fa fa-check"></i><b>16.2.2</b> Список ребер</a></li>
<li class="chapter" data-level="16.2.3" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#формула"><i class="fa fa-check"></i><b>16.2.3</b> Формула</a></li>
<li class="chapter" data-level="16.2.4" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#импорт-данных"><i class="fa fa-check"></i><b>16.2.4</b> Импорт данных</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#атрибуты-вершин-узлов"><i class="fa fa-check"></i><b>16.3</b> Атрибуты вершин (узлов)</a></li>
<li class="chapter" data-level="16.4" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#фильтрация-по-узлу"><i class="fa fa-check"></i><b>16.4</b> Фильтрация по узлу</a></li>
<li class="chapter" data-level="16.5" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#атрибуты-ребер"><i class="fa fa-check"></i><b>16.5</b> Атрибуты ребер</a></li>
<li class="chapter" data-level="16.6" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#импорт-из-gexf"><i class="fa fa-check"></i><b>16.6</b> Импорт из gexf</a></li>
<li class="chapter" data-level="16.7" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#визуализация-с-ggraph"><i class="fa fa-check"></i><b>16.7</b> Визуализация с ggraph</a></li>
<li class="chapter" data-level="16.8" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#фильтрация-по-атрибутам-ребер"><i class="fa fa-check"></i><b>16.8</b> Фильтрация по атрибутам ребер</a></li>
<li class="chapter" data-level="16.9" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#укладка-сети"><i class="fa fa-check"></i><b>16.9</b> Укладка сети</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="анализ-сетей.html"><a href="анализ-сетей.html"><i class="fa fa-check"></i><b>17</b> Анализ сетей</a>
<ul>
<li class="chapter" data-level="17.1" data-path="анализ-сетей.html"><a href="анализ-сетей.html#от-conllu-к-совместной-встречаемости"><i class="fa fa-check"></i><b>17.1</b> От conllu к совместной встречаемости</a></li>
<li class="chapter" data-level="17.2" data-path="анализ-сетей.html"><a href="анализ-сетей.html#граф-слов-с-igraph"><i class="fa fa-check"></i><b>17.2</b> Граф слов с igraph</a></li>
<li class="chapter" data-level="17.3" data-path="анализ-сетей.html"><a href="анализ-сетей.html#важность-узлов"><i class="fa fa-check"></i><b>17.3</b> Важность узлов</a></li>
<li class="chapter" data-level="17.4" data-path="анализ-сетей.html"><a href="анализ-сетей.html#централизация"><i class="fa fa-check"></i><b>17.4</b> Централизация</a></li>
<li class="chapter" data-level="17.5" data-path="анализ-сетей.html"><a href="анализ-сетей.html#центральность-на-графике"><i class="fa fa-check"></i><b>17.5</b> Центральность на графике</a></li>
<li class="chapter" data-level="17.6" data-path="анализ-сетей.html"><a href="анализ-сетей.html#интерактивный-граф"><i class="fa fa-check"></i><b>17.6</b> Интерактивный граф</a></li>
<li class="chapter" data-level="17.7" data-path="анализ-сетей.html"><a href="анализ-сетей.html#точки-сочленения"><i class="fa fa-check"></i><b>17.7</b> Точки сочленения</a></li>
<li class="chapter" data-level="17.8" data-path="анализ-сетей.html"><a href="анализ-сетей.html#подгруппы"><i class="fa fa-check"></i><b>17.8</b> Подгруппы</a>
<ul>
<li class="chapter" data-level="17.8.1" data-path="анализ-сетей.html"><a href="анализ-сетей.html#клики"><i class="fa fa-check"></i><b>17.8.1</b> Клики</a></li>
<li class="chapter" data-level="17.8.2" data-path="анализ-сетей.html"><a href="анализ-сетей.html#k-ядра"><i class="fa fa-check"></i><b>17.8.2</b> K-ядра</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="dracor.html"><a href="dracor.html"><i class="fa fa-check"></i><b>18</b> Dracor</a>
<ul>
<li class="chapter" data-level="18.1" data-path="dracor.html"><a href="dracor.html#о-корпусе-dracor"><i class="fa fa-check"></i><b>18.1</b> О корпусе Dracor</a></li>
<li class="chapter" data-level="18.2" data-path="dracor.html"><a href="dracor.html#начало-работы-с-dracor"><i class="fa fa-check"></i><b>18.2</b> Начало работы с Dracor</a></li>
<li class="chapter" data-level="18.3" data-path="dracor.html"><a href="dracor.html#сети-dracor"><i class="fa fa-check"></i><b>18.3</b> Сети Dracor</a></li>
<li class="chapter" data-level="18.4" data-path="dracor.html"><a href="dracor.html#модулярность"><i class="fa fa-check"></i><b>18.4</b> Модулярность</a></li>
<li class="chapter" data-level="18.5" data-path="dracor.html"><a href="dracor.html#алгоритмы-обнаружения-сообществ"><i class="fa fa-check"></i><b>18.5</b> Алгоритмы обнаружения сообществ</a></li>
<li class="chapter" data-level="18.6" data-path="dracor.html"><a href="dracor.html#двудольные-графы-биграфы"><i class="fa fa-check"></i><b>18.6</b> Двудольные графы (биграфы)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="литература.html"><a href="литература.html"><i class="fa fa-check"></i>Литература</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Компьютерный анализ текста в R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="веб-скрапинг" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Тема 9</span> Веб-скрапинг<a href="веб-скрапинг.html#веб-скрапинг" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Выше мы говорили о таком импорте html, когда все теги разом удаляются. Это не всегда удобно, поскольку файл хранит данные в структурированном виде, например, под разными тегами дату, автора и текст. И может быть желательно эту структуру сохранить.</p>
<p>В R это позволяет делать пакет <code>rvest</code>. С его помощью мы подготовим для дальнейшего построения тематической модели архив телеграм-канала Antibarbari HSE. Канал публичный, и Telegram дает возможность скачать архив в формате html при помощи кнопки export (однако эта функция может быть недоступна на MacOS).</p>
<p>Эта глава опирается в основом на <a href="https://r4ds.hadley.nz/webscraping.html">второе издание</a> книги R for Data Science Хадли Викхема.</p>
<div id="структура-html" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Структура html<a href="веб-скрапинг.html#структура-html" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Документы html (HyperText Markup Language) имеют ирархическую структуру, состоящую из <strong>элементов</strong>. В каждом элементе есть <strong>открывающий тег</strong> (<tag>), опциональные <strong>атрибуты</strong> (id=‘first’) и <strong>закрывающий тег</strong> (</tag>). Все, что находится между открывающим и закрывающим тегом, называется <strong>содержанием</strong> элемента.</p>
<p>Важнейшие теги, о которых стоит знать:</p>
<ul>
<li>html (есть всегда), с двумя детьми (дочерними элементами): head и body</li>
<li>элементы, отвечающие за структуру: h1 (заголовок), section, p (параграф), ol (упорядоченный список)</li>
<li>элементы, отвечающие за оформление: b (bold), i (italics), a (ссылка)</li>
</ul>
<p>Чтобы увидеть структуру страницы, надо нажать правой кнопкой мыши и выбрать View Source (это работает и для тех html, которые хранятся у вас на компьютере).</p>
</div>
<div id="каскадные-таблицы-стилей" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Каскадные таблицы стилей<a href="веб-скрапинг.html#каскадные-таблицы-стилей" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>У тегов могут быть именованные атрибуты; важнейшие из них – это id и class, которые в сочетании с CSS контролируют внешний вид страницы.</p>
<div class="infobox">
<p>CSS (англ. Cascading Style Sheets «каскадные таблицы стилей») — формальный язык декорирования и описания внешнего вида документа (веб-страницы), написанного с использованием языка разметки (чаще всего HTML или XHTML).</p>
</div>
<p>У этого курса тоже есть свой css, в котором блок infobox (вы его видите как серый квадратик с определением) описано так:</p>
<pre><code>.infobox {
  padding: 1em;
  background: #ededed;
  color: black;
}</code></pre>
<p>Проще говоря, это инструкция, что делать с тем или иным элементом. Каждое правило CSS имеет две основные части — <strong>селектор</strong> и <strong>блок объявлений</strong>. Селектор, расположенный в левой части правила до знака «{», определяет, на какие части документа (возможно, специально обозначенные) распространяется правило. Блок объявлений располагается в правой части правила. Он помещается в фигурные скобки, и, в свою очередь, состоит из одного или более объявлений, разделённых знаком «;».</p>
<p>Селекторы CSS полезны для скрапинга, потому что они помогают вычленить необходимые элементы. Это работает так:</p>
<ul>
<li>p выберет все элементы
<p></li>
<li>.title выберет элементы с классом “title”</li>
<li>#title выберет все элементы с атрибутом id=‘title’</li>
</ul>
<p>Важно: если изменится структура страницы, откуда вы скрапили информацию, то и код, возможно, придется переписывать.</p>
</div>
<div id="извлечение-данных" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Извлечение данных<a href="веб-скрапинг.html#извлечение-данных" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Чтобы прочесть файл html, используем одноименную функцию.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="веб-скрапинг.html#cb515-1" tabindex="-1"></a><span class="fu">library</span>(rvest)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;rvest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     guess_encoding</code></pre>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="веб-скрапинг.html#cb518-1" tabindex="-1"></a>messages <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;./files/antibarbari_archive/messages.html&quot;</span>)</span>
<span id="cb518-2"><a href="веб-скрапинг.html#cb518-2" tabindex="-1"></a>messages2 <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;./files/antibarbari_archive/messages2.html&quot;</span>)</span>
<span id="cb518-3"><a href="веб-скрапинг.html#cb518-3" tabindex="-1"></a></span>
<span id="cb518-4"><a href="веб-скрапинг.html#cb518-4" tabindex="-1"></a>messages</span></code></pre></div>
<pre><code>## {html_document}
## &lt;html&gt;
## [1] &lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8 ...
## [2] &lt;body onload=&quot;CheckLocation();&quot;&gt;\n\n  &lt;div class=&quot;page_wrap&quot;&gt;\n\n   &lt;div  ...</code></pre>
<p>На следующем этапе важно понять, какие именно элементы нужны. Рассмотрим на примере одного сообщения. Для примера я сохраню этот элемент как небольшой отдельных html; <code>rvest</code> позволяет это сделать (но внутри двойных кавычек должны быть только одинарные):</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="веб-скрапинг.html#cb520-1" tabindex="-1"></a>html <span class="ot">&lt;-</span>  <span class="fu">minimal_html</span>(<span class="st">&quot;</span></span>
<span id="cb520-2"><a href="веб-скрапинг.html#cb520-2" tabindex="-1"></a><span class="st">&lt;div class=&#39;message default clearfix&#39; id=&#39;message83&#39;&gt;</span></span>
<span id="cb520-3"><a href="веб-скрапинг.html#cb520-3" tabindex="-1"></a><span class="st">      &lt;div class=&#39;pull_left userpic_wrap&#39;&gt;</span></span>
<span id="cb520-4"><a href="веб-скрапинг.html#cb520-4" tabindex="-1"></a><span class="st">       &lt;div class=&#39;userpic userpic2&#39; style=&#39;width: 42px; height: 42px&#39;&gt;</span></span>
<span id="cb520-5"><a href="веб-скрапинг.html#cb520-5" tabindex="-1"></a><span class="st">        &lt;div class=&#39;initials&#39; style=&#39;line-height: 42px&#39;&gt;</span></span>
<span id="cb520-6"><a href="веб-скрапинг.html#cb520-6" tabindex="-1"></a><span class="st">A</span></span>
<span id="cb520-7"><a href="веб-скрапинг.html#cb520-7" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb520-8"><a href="веб-скрапинг.html#cb520-8" tabindex="-1"></a><span class="st">       &lt;/div&gt;</span></span>
<span id="cb520-9"><a href="веб-скрапинг.html#cb520-9" tabindex="-1"></a><span class="st">      &lt;/div&gt;</span></span>
<span id="cb520-10"><a href="веб-скрапинг.html#cb520-10" tabindex="-1"></a><span class="st">      &lt;div class=&#39;body&#39;&gt;</span></span>
<span id="cb520-11"><a href="веб-скрапинг.html#cb520-11" tabindex="-1"></a><span class="st">       &lt;div class=&#39;pull_right date details&#39; title=&#39;19.05.2022 11:18:07 UTC+03:00&#39;&gt;</span></span>
<span id="cb520-12"><a href="веб-скрапинг.html#cb520-12" tabindex="-1"></a><span class="st">11:18</span></span>
<span id="cb520-13"><a href="веб-скрапинг.html#cb520-13" tabindex="-1"></a><span class="st">       &lt;/div&gt;</span></span>
<span id="cb520-14"><a href="веб-скрапинг.html#cb520-14" tabindex="-1"></a><span class="st">       &lt;div class=&#39;from_name&#39;&gt;</span></span>
<span id="cb520-15"><a href="веб-скрапинг.html#cb520-15" tabindex="-1"></a><span class="st">Antibarbari HSE </span></span>
<span id="cb520-16"><a href="веб-скрапинг.html#cb520-16" tabindex="-1"></a><span class="st">       &lt;/div&gt;</span></span>
<span id="cb520-17"><a href="веб-скрапинг.html#cb520-17" tabindex="-1"></a><span class="st">       &lt;div class=&#39;text&#39;&gt;</span></span>
<span id="cb520-18"><a href="веб-скрапинг.html#cb520-18" tabindex="-1"></a><span class="st">Этот пост открывает серию переложений из «Дайджеста платоновских идиом» Джеймса Ридделла (1823–1866), английского филолога-классика, чей научный путь был связан с Оксфордским университетом. По приглашению Бенджамина Джоветта он должен был подготовить к изданию «Апологию», «Критон», «Федон» и «Пир». Однако из этих четырех текстов вышла лишь «Апология» с предисловием и приложением в виде «Дайджеста» (ссылка) — уже после смерти автора. &lt;br&gt;&lt;br&gt;«Дайджест» содержит 326 параграфов, посвященных грамматическим, синтаксическим и риторическим особенностям языка Платона. Знакомство с этим теоретическим материалом позволяет лучше почувствовать уникальный стиль философа и добиться большей точности при переводе. Ссылки на «Дайджест» могут быть уместны и в учебных комментариях к диалогам Платона. Предлагаемая здесь первая часть «Дайджеста» содержит «идиомы имен» и «идиомы артикля» (§§ 1–39).&lt;br&gt;&lt;a href=&#39;http://antibarbari.ru/2022/05/19/digest_1/&#39;&gt;http://antibarbari.ru/2022/05/19/digest_1/&lt;/a&gt;</span></span>
<span id="cb520-19"><a href="веб-скрапинг.html#cb520-19" tabindex="-1"></a><span class="st">       &lt;/div&gt;</span></span>
<span id="cb520-20"><a href="веб-скрапинг.html#cb520-20" tabindex="-1"></a><span class="st">       &lt;div class=&#39;signature details&#39;&gt;</span></span>
<span id="cb520-21"><a href="веб-скрапинг.html#cb520-21" tabindex="-1"></a><span class="st">Olga Alieva</span></span>
<span id="cb520-22"><a href="веб-скрапинг.html#cb520-22" tabindex="-1"></a><span class="st">       &lt;/div&gt;</span></span>
<span id="cb520-23"><a href="веб-скрапинг.html#cb520-23" tabindex="-1"></a><span class="st">      &lt;/div&gt;</span></span>
<span id="cb520-24"><a href="веб-скрапинг.html#cb520-24" tabindex="-1"></a><span class="st">     &lt;/div&gt;</span></span>
<span id="cb520-25"><a href="веб-скрапинг.html#cb520-25" tabindex="-1"></a><span class="st">&quot;</span>)</span></code></pre></div>
Из всего этого мне может быть интересно id сообщения (
<div class='message default clearfix' id='message83'>
), текст сообщения (
<div class='text'>
), а также, если указан, автор сообщения (
<div class='signature details'>
<p>). Извлекаем текст:</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="веб-скрапинг.html#cb521-1" tabindex="-1"></a>html <span class="sc">%&gt;%</span></span>
<span id="cb521-2"><a href="веб-скрапинг.html#cb521-2" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">&quot;.text&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb521-3"><a href="веб-скрапинг.html#cb521-3" tabindex="-1"></a>  <span class="fu">html_text2</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Этот пост открывает серию переложений из «Дайджеста платоновских идиом» Джеймса Ридделла (1823–1866), английского филолога-классика, чей научный путь был связан с Оксфордским университетом. По приглашению Бенджамина Джоветта он должен был подготовить к изданию «Апологию», «Критон», «Федон» и «Пир». Однако из этих четырех текстов вышла лишь «Апология» с предисловием и приложением в виде «Дайджеста» (ссылка) — уже после смерти автора.\n\n«Дайджест» содержит 326 параграфов, посвященных грамматическим, синтаксическим и риторическим особенностям языка Платона. Знакомство с этим теоретическим материалом позволяет лучше почувствовать уникальный стиль философа и добиться большей точности при переводе. Ссылки на «Дайджест» могут быть уместны и в учебных комментариях к диалогам Платона. Предлагаемая здесь первая часть «Дайджеста» содержит «идиомы имен» и «идиомы артикля» (§§ 1–39).\nhttp://antibarbari.ru/2022/05/19/digest_1/&quot;</code></pre>
<p>В классе signature details есть пробел, достаточно на его месте поставить точку:</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="веб-скрапинг.html#cb523-1" tabindex="-1"></a>html <span class="sc">%&gt;%</span></span>
<span id="cb523-2"><a href="веб-скрапинг.html#cb523-2" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">&quot;.signature.details&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb523-3"><a href="веб-скрапинг.html#cb523-3" tabindex="-1"></a>  <span class="fu">html_text2</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Olga Alieva&quot;</code></pre>
<p>Важно помнить, что <code>html_element</code> всегда возвращает один элемент. Если их больше, надо использовать <code>html_elements</code>.</p>
<p>Осталось добыть message id:</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="веб-скрапинг.html#cb525-1" tabindex="-1"></a>html <span class="sc">%&gt;%</span></span>
<span id="cb525-2"><a href="веб-скрапинг.html#cb525-2" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">&quot;div&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb525-3"><a href="веб-скрапинг.html#cb525-3" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;message83&quot;</code></pre>
</div>
<div id="извлечение-в-тиббл" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Извлечение в тиббл<a href="веб-скрапинг.html#извлечение-в-тиббл" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="веб-скрапинг.html#cb527-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb527-2"><a href="веб-скрапинг.html#cb527-2" tabindex="-1"></a></span>
<span id="cb527-3"><a href="веб-скрапинг.html#cb527-3" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">id =</span> html <span class="sc">%&gt;%</span> </span>
<span id="cb527-4"><a href="веб-скрапинг.html#cb527-4" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;div&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb527-5"><a href="веб-скрапинг.html#cb527-5" tabindex="-1"></a>         <span class="fu">html_attr</span>(<span class="st">&quot;id&quot;</span>),</span>
<span id="cb527-6"><a href="веб-скрапинг.html#cb527-6" tabindex="-1"></a>       <span class="at">signature =</span> html <span class="sc">%&gt;%</span></span>
<span id="cb527-7"><a href="веб-скрапинг.html#cb527-7" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.signature.details&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb527-8"><a href="веб-скрапинг.html#cb527-8" tabindex="-1"></a>         <span class="fu">html_text2</span>(),</span>
<span id="cb527-9"><a href="веб-скрапинг.html#cb527-9" tabindex="-1"></a>       <span class="at">text =</span> html <span class="sc">%&gt;%</span> </span>
<span id="cb527-10"><a href="веб-скрапинг.html#cb527-10" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.text&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb527-11"><a href="веб-скрапинг.html#cb527-11" tabindex="-1"></a>         <span class="fu">html_text2</span>()</span>
<span id="cb527-12"><a href="веб-скрапинг.html#cb527-12" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   id        signature   text                                                    
##   &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;                                                   
## 1 message83 Olga Alieva &quot;Этот пост открывает серию переложений из «Дайджеста пл…</code></pre>
</div>
<div id="скрапим-телеграм-канал" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Скрапим телеграм-канал<a href="веб-скрапинг.html#скрапим-телеграм-канал" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>До сих пор наша задача упрощалась тем, что мы имели дело с игрушечным html для единственного сообщения. В настоящем html тег div повторяется на разных уровнях, нам надо извлечь только такие div, которым соответствует определенный класс:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="веб-скрапинг.html#cb529-1" tabindex="-1"></a>messages <span class="sc">%&gt;%</span></span>
<span id="cb529-2"><a href="веб-скрапинг.html#cb529-2" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb529-3"><a href="веб-скрапинг.html#cb529-3" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## {xml_nodeset (6)}
## [1] &lt;div class=&quot;message default clearfix&quot; id=&quot;message3&quot;&gt;\n\n      &lt;div class= ...
## [2] &lt;div class=&quot;message default clearfix&quot; id=&quot;message5&quot;&gt;\n\n      &lt;div class= ...
## [3] &lt;div class=&quot;message default clearfix&quot; id=&quot;message6&quot;&gt;\n\n      &lt;div class= ...
## [4] &lt;div class=&quot;message default clearfix&quot; id=&quot;message7&quot;&gt;\n\n      &lt;div class= ...
## [5] &lt;div class=&quot;message default clearfix&quot; id=&quot;message8&quot;&gt;\n\n      &lt;div class= ...
## [6] &lt;div class=&quot;message default clearfix&quot; id=&quot;message9&quot;&gt;\n\n      &lt;div class= ...</code></pre>
<p>Уже из этого списка можем доставать все остальное.</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="веб-скрапинг.html#cb531-1" tabindex="-1"></a>messages_tbl1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> messages <span class="sc">%&gt;%</span> </span>
<span id="cb531-2"><a href="веб-скрапинг.html#cb531-2" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb531-3"><a href="веб-скрапинг.html#cb531-3" tabindex="-1"></a>         <span class="fu">html_attr</span>(<span class="st">&quot;id&quot;</span>),</span>
<span id="cb531-4"><a href="веб-скрапинг.html#cb531-4" tabindex="-1"></a>       <span class="at">signature =</span> messages <span class="sc">%&gt;%</span></span>
<span id="cb531-5"><a href="веб-скрапинг.html#cb531-5" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb531-6"><a href="веб-скрапинг.html#cb531-6" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.signature.details&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb531-7"><a href="веб-скрапинг.html#cb531-7" tabindex="-1"></a>         <span class="fu">html_text2</span>(),</span>
<span id="cb531-8"><a href="веб-скрапинг.html#cb531-8" tabindex="-1"></a>       <span class="at">text =</span> messages <span class="sc">%&gt;%</span> </span>
<span id="cb531-9"><a href="веб-скрапинг.html#cb531-9" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb531-10"><a href="веб-скрапинг.html#cb531-10" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.text&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb531-11"><a href="веб-скрапинг.html#cb531-11" tabindex="-1"></a>         <span class="fu">html_text2</span>()</span>
<span id="cb531-12"><a href="веб-скрапинг.html#cb531-12" tabindex="-1"></a>)</span>
<span id="cb531-13"><a href="веб-скрапинг.html#cb531-13" tabindex="-1"></a></span>
<span id="cb531-14"><a href="веб-скрапинг.html#cb531-14" tabindex="-1"></a>messages_tbl2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> messages2 <span class="sc">%&gt;%</span> </span>
<span id="cb531-15"><a href="веб-скрапинг.html#cb531-15" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb531-16"><a href="веб-скрапинг.html#cb531-16" tabindex="-1"></a>         <span class="fu">html_attr</span>(<span class="st">&quot;id&quot;</span>),</span>
<span id="cb531-17"><a href="веб-скрапинг.html#cb531-17" tabindex="-1"></a>       <span class="at">signature =</span> messages2 <span class="sc">%&gt;%</span></span>
<span id="cb531-18"><a href="веб-скрапинг.html#cb531-18" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb531-19"><a href="веб-скрапинг.html#cb531-19" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.signature.details&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb531-20"><a href="веб-скрапинг.html#cb531-20" tabindex="-1"></a>         <span class="fu">html_text2</span>(),</span>
<span id="cb531-21"><a href="веб-скрапинг.html#cb531-21" tabindex="-1"></a>       <span class="at">text =</span> messages2 <span class="sc">%&gt;%</span> </span>
<span id="cb531-22"><a href="веб-скрапинг.html#cb531-22" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb531-23"><a href="веб-скрапинг.html#cb531-23" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.text&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb531-24"><a href="веб-скрапинг.html#cb531-24" tabindex="-1"></a>         <span class="fu">html_text2</span>()</span>
<span id="cb531-25"><a href="веб-скрапинг.html#cb531-25" tabindex="-1"></a>)</span></code></pre></div>
<p>Обратите внимание, что мы сначала извлекаем нужные элементы при помощи <code>html_elements()</code>, а потом применяем к каждому из них <code>html_element()</code>. Это гарантирует, что в каждом столбце нашей таблицы равное число наблюдений, т.к. функция <code>html_element()</code>, если она не может найти, например, подпись, возвращает NA.</p>
<p>Сшиваем воедино два тиббла.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="веб-скрапинг.html#cb532-1" tabindex="-1"></a>messages_tbl <span class="ot">&lt;-</span> messages_tbl1 <span class="sc">%&gt;%</span> </span>
<span id="cb532-2"><a href="веб-скрапинг.html#cb532-2" tabindex="-1"></a>  <span class="fu">bind_rows</span>(messages_tbl2)</span>
<span id="cb532-3"><a href="веб-скрапинг.html#cb532-3" tabindex="-1"></a></span>
<span id="cb532-4"><a href="веб-скрапинг.html#cb532-4" tabindex="-1"></a>messages_tbl</span></code></pre></div>
<pre><code>## # A tibble: 1,096 × 3
##    id        signature text                                                     
##    &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                                                    
##  1 message3  &lt;NA&gt;      &quot;Latin never sleeps. Новое видео на канале Antibarbari (…
##  2 message5  &lt;NA&gt;      &quot;Подборка видео семинара по медленному чтению \&quot;О филосо…
##  3 message6  &lt;NA&gt;      &quot;Новое видео в плейлисте \&quot;Латинский язык\&quot;. Фрагмент се…
##  4 message7  &lt;NA&gt;      &quot;🤖 ОТКРЫТА ЗАПИСЬ НА ПРОЕКТ\n\nВ рамках проекта участни…
##  5 message8  &lt;NA&gt;      &quot;Желающие присоединиться к группе, читающей \&quot;Филеба\&quot; П…
##  6 message9  &lt;NA&gt;      &quot;https://youtu.be/I-U_lG0mB3M&quot;                           
##  7 message10 &lt;NA&gt;      &quot;В клубе Antibarbari продолжается семинар по чтению и об…
##  8 message11 &lt;NA&gt;      &quot;Филеб. Семинар 3 марта 2022. Сократ и Протарх решают сл…
##  9 message12 &lt;NA&gt;      &quot;Вышка вернулась в аудитории, поэтому теперь у нас театр…
## 10 message13 &lt;NA&gt;      &quot;Воспользовались дополнительным выходным, чтобы забэкапи…
## # ℹ 1,086 more rows</code></pre>
<p>Создатели канала не сразу разрешили подписывать посты, поэтому для первых нескольких десятков подписи не будет. В некоторых постах только фото, для них в столбце text – NA, их можно сразу отсеять.</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="веб-скрапинг.html#cb534-1" tabindex="-1"></a>messages_tbl <span class="ot">&lt;-</span> messages_tbl <span class="sc">%&gt;%</span></span>
<span id="cb534-2"><a href="веб-скрапинг.html#cb534-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text))</span>
<span id="cb534-3"><a href="веб-скрапинг.html#cb534-3" tabindex="-1"></a></span>
<span id="cb534-4"><a href="веб-скрапинг.html#cb534-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code></pre></div>
</div>
<div id="эмотиконы" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Эмотиконы<a href="веб-скрапинг.html#эмотиконы" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>В постах довольно много эмотиконов. Я их удалю, но сначала скажу о полезном пакете, который позволяет их все извлечь и, например, посчитать.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="веб-скрапинг.html#cb535-1" tabindex="-1"></a><span class="fu">library</span>(emoji)</span>
<span id="cb535-2"><a href="веб-скрапинг.html#cb535-2" tabindex="-1"></a></span>
<span id="cb535-3"><a href="веб-скрапинг.html#cb535-3" tabindex="-1"></a>messages_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb535-4"><a href="веб-скрапинг.html#cb535-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">emoji =</span> <span class="fu">emoji_extract_all</span>(text)) <span class="sc">%&gt;%</span> </span>
<span id="cb535-5"><a href="веб-скрапинг.html#cb535-5" tabindex="-1"></a>  <span class="fu">pull</span>(emoji) <span class="sc">%&gt;%</span> </span>
<span id="cb535-6"><a href="веб-скрапинг.html#cb535-6" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb535-7"><a href="веб-скрапинг.html#cb535-7" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb535-8"><a href="веб-скрапинг.html#cb535-8" tabindex="-1"></a>  <span class="fu">count</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb535-9"><a href="веб-скрапинг.html#cb535-9" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>n) </span></code></pre></div>
<pre><code>## # A tibble: 159 × 2
##    value     n
##    &lt;chr&gt; &lt;int&gt;
##  1 👾       68
##  2 ⭐       23
##  3 👀       21
##  4 👇       20
##  5 🍿       18
##  6 📚       16
##  7 🔼       12
##  8 1️⃣        10
##  9 📌       10
## 10 🔗       10
## # ℹ 149 more rows</code></pre>
<p>Заменяем их все на пробелы.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="веб-скрапинг.html#cb537-1" tabindex="-1"></a>messages_tbl <span class="ot">&lt;-</span> messages_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb537-2"><a href="веб-скрапинг.html#cb537-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">emoji_replace_all</span>(text, <span class="st">&quot; &quot;</span>))</span></code></pre></div>
</div>
<div id="рутинная-уборка" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> Рутинная уборка<a href="веб-скрапинг.html#рутинная-уборка" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Подготовка текста для анализа включает в себя удаление сносок, иногда хэштегов, чисел, имейлов, возможно имен и т.п. В нашем случае ситуация осложняется тем, что тексты включают цитаты на латыни и древнегреческом, некоторые технические сокращения, номера страниц и др. Вот так, например, выглядит типичный пост:</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="веб-скрапинг.html#cb538-1" tabindex="-1"></a>example <span class="ot">&lt;-</span> messages_tbl<span class="sc">$</span>text[<span class="dv">340</span>]</span>
<span id="cb538-2"><a href="веб-скрапинг.html#cb538-2" tabindex="-1"></a></span>
<span id="cb538-3"><a href="веб-скрапинг.html#cb538-3" tabindex="-1"></a>example</span></code></pre></div>
<pre><code>## [1] &quot;🎞 Теэтет #10 149b7-150b8\nСократ продолжает засыпать семнадцатилетнего математика подробностями из области акушерства и гинекологии, и мы вместе с ним терпеливо изучаем, чем сводничество отличается от сватовства. Верните квадратные корни. #платон #теэтет\nhttps://vk.com/video-211800158_456239238&quot;</code></pre>
<p>Вот так вылавливается гиперссылка.</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="веб-скрапинг.html#cb540-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(example, <span class="st">&quot;(http|https)(</span><span class="sc">\\</span><span class="st">S+)&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;https://vk.com/video-211800158_456239238&quot;</code></pre>
<p>Вот так вылавливается пагинация и номер семинара (и некоторые другие числа).</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="веб-скрапинг.html#cb542-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(example, <span class="st">&quot;#?</span><span class="sc">\\</span><span class="st">d{2,3}</span><span class="sc">\\</span><span class="st">w?</span><span class="sc">\\</span><span class="st">d?-?&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;#10&quot;    &quot;149b7-&quot; &quot;150b8&quot;  &quot;21180&quot;  &quot;0158&quot;   &quot;45623&quot;  &quot;9238&quot;</code></pre>
<p>Похожим образом можно выловить даты, имейлы и т.п. Все это удаляем из текста.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="веб-скрапинг.html#cb544-1" tabindex="-1"></a>messages_clean <span class="ot">&lt;-</span> messages_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb544-2"><a href="веб-скрапинг.html#cb544-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">str_replace_all</span>(text, <span class="st">&quot;(http|https)(</span><span class="sc">\\</span><span class="st">S+)&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb544-3"><a href="веб-скрапинг.html#cb544-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">str_replace_all</span>(text, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d{2}</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d{2}</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d{4}&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb544-4"><a href="веб-скрапинг.html#cb544-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">str_replace_all</span>(text, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">W[-A-Za-z0-9_.%]+</span><span class="sc">\\</span><span class="st">@[-A-Za-z0-9_.%]+</span><span class="sc">\\</span><span class="st">.[A-Za-z]&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb544-5"><a href="веб-скрапинг.html#cb544-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">str_replace_all</span>(text, <span class="st">&quot;#?</span><span class="sc">\\</span><span class="st">d{2,3}</span><span class="sc">\\</span><span class="st">w?</span><span class="sc">\\</span><span class="st">d?-?&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb544-6"><a href="веб-скрапинг.html#cb544-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">str_replace_all</span>(text, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n+&quot;</span>, <span class="st">&quot; &quot;</span>))</span></code></pre></div>
<p>Остались еще сокращения вроде “г.”, но токены из одной буквы можно будет удалить после разделения на слова. Знаки пунктуации можно оставить или убрать – иногда они бывают интересным стилистическим маркером. В любом случае лучше это делать после лемматизации, т.к. на тексте без знаков препинания анализатор покажет себя хуже.</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="веб-скрапинг.html#cb545-1" tabindex="-1"></a>messages_clean <span class="sc">%&gt;%</span> </span>
<span id="cb545-2"><a href="веб-скрапинг.html#cb545-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">340</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   id         signature   text                                                   
##   &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;                                                  
## 1 message465 Olga Alieva &quot;🎞 Теэтет      Сократ продолжает засыпать семнадцатиле…</code></pre>
<p>Число id и число текстов не совпадает, поскольку для некоторых постов текста нет (NA), а у других он совпадает (“Пост выходного дня”). Это надо сразу исправить, чтобы результат лемматизации можно было потом соединить с данными о подписи. Я просто уберу очень короткие посты, поскольку для анализа они неинтересны.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="веб-скрапинг.html#cb547-1" tabindex="-1"></a>messages_clean <span class="ot">&lt;-</span> messages_clean <span class="sc">%&gt;%</span></span>
<span id="cb547-2"><a href="веб-скрапинг.html#cb547-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">nchar</span>(text) <span class="sc">&gt;</span> <span class="dv">19</span>)</span></code></pre></div>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="веб-скрапинг.html#cb548-1" tabindex="-1"></a><span class="fu">dim</span>(messages_clean)</span></code></pre></div>
<pre><code>## [1] 734   3</code></pre>
<p>Переименуем первый столбец и переназначим id, чтобы можно было потом соединить с результатами лемматизации.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="веб-скрапинг.html#cb550-1" tabindex="-1"></a>messages_clean <span class="ot">&lt;-</span> messages_clean <span class="sc">%&gt;%</span> </span>
<span id="cb550-2"><a href="веб-скрапинг.html#cb550-2" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">doc_id =</span> id) <span class="sc">%&gt;%</span> </span>
<span id="cb550-3"><a href="веб-скрапинг.html#cb550-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">doc_id =</span> <span class="fu">paste0</span>(<span class="st">&quot;doc&quot;</span>, <span class="fu">row_number</span>()))</span></code></pre></div>
</div>
<div id="лемматизация" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Лемматизация<a href="веб-скрапинг.html#лемматизация" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>На лемматизацию мы отдаем вектор с сообщениями.</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="веб-скрапинг.html#cb551-1" tabindex="-1"></a><span class="fu">library</span>(udpipe)</span>
<span id="cb551-2"><a href="веб-скрапинг.html#cb551-2" tabindex="-1"></a>russian_syntagrus <span class="ot">&lt;-</span> <span class="fu">udpipe_load_model</span>(<span class="at">file =</span> <span class="st">&quot;russian-syntagrus-ud-2.5-191206.udpipe&quot;</span>)</span>
<span id="cb551-3"><a href="веб-скрапинг.html#cb551-3" tabindex="-1"></a></span>
<span id="cb551-4"><a href="веб-скрапинг.html#cb551-4" tabindex="-1"></a>messages_ann <span class="ot">&lt;-</span> <span class="fu">udpipe_annotate</span>(russian_syntagrus, messages_clean<span class="sc">$</span>text)</span>
<span id="cb551-5"><a href="веб-скрапинг.html#cb551-5" tabindex="-1"></a></span>
<span id="cb551-6"><a href="веб-скрапинг.html#cb551-6" tabindex="-1"></a>messages_ann <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(messages_ann)</span>
<span id="cb551-7"><a href="веб-скрапинг.html#cb551-7" tabindex="-1"></a></span>
<span id="cb551-8"><a href="веб-скрапинг.html#cb551-8" tabindex="-1"></a>messages_ann</span></code></pre></div>
<p>Убедимся, что после лемматизации число id не изменилось, и соединим этот тиббл с данными о подписи.</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="веб-скрапинг.html#cb552-1" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(messages_ann<span class="sc">$</span>doc_id))</span></code></pre></div>
<pre><code>## [1] 734</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="веб-скрапинг.html#cb554-1" tabindex="-1"></a>messages_signed <span class="ot">&lt;-</span> messages_ann <span class="sc">%&gt;%</span> </span>
<span id="cb554-2"><a href="веб-скрапинг.html#cb554-2" tabindex="-1"></a>  <span class="fu">left_join</span>(messages_clean, <span class="at">by =</span> <span class="st">&quot;doc_id&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb554-3"><a href="веб-скрапинг.html#cb554-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>text, <span class="sc">-</span>sentence_id, <span class="sc">-</span>paragraph_id, <span class="sc">-</span>xpos, <span class="sc">-</span>feats,</span>
<span id="cb554-4"><a href="веб-скрапинг.html#cb554-4" tabindex="-1"></a>         <span class="sc">-</span>head_token_id, <span class="sc">-</span>dep_rel, <span class="sc">-</span>deps, <span class="sc">-</span>misc)</span>
<span id="cb554-5"><a href="веб-скрапинг.html#cb554-5" tabindex="-1"></a></span>
<span id="cb554-6"><a href="веб-скрапинг.html#cb554-6" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(messages_signed<span class="sc">$</span>doc_id))</span></code></pre></div>
<pre><code>## [1] 734</code></pre>
<p>В постах упоминаются многие коллеги и студенты, чьи имена я бы хотела удалить, чтобы они не появлялись на графиках и т.п., но есть и много древних и новых имен, которые хотелось бы оставить.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="веб-скрапинг.html#cb556-1" tabindex="-1"></a><span class="co"># valid_names &lt;- messages_ann %&gt;% </span></span>
<span id="cb556-2"><a href="веб-скрапинг.html#cb556-2" tabindex="-1"></a><span class="co">#   filter(upos == &quot;PROPN&quot;) %&gt;% </span></span>
<span id="cb556-3"><a href="веб-скрапинг.html#cb556-3" tabindex="-1"></a><span class="co">#   count(lemma) %&gt;% </span></span>
<span id="cb556-4"><a href="веб-скрапинг.html#cb556-4" tabindex="-1"></a><span class="co">#   arrange(-n) %&gt;% </span></span>
<span id="cb556-5"><a href="веб-скрапинг.html#cb556-5" tabindex="-1"></a><span class="co">#   filter(!str_detect(lemma, &quot;[\\.«]&quot;)) %&gt;% </span></span>
<span id="cb556-6"><a href="веб-скрапинг.html#cb556-6" tabindex="-1"></a><span class="co">#   filter(str_detect(lemma, &quot;[[\u0400-\u04FF]]&quot;)) %&gt;% </span></span>
<span id="cb556-7"><a href="веб-скрапинг.html#cb556-7" tabindex="-1"></a><span class="co">#   filter(n &gt; 1)</span></span>
<span id="cb556-8"><a href="веб-скрапинг.html#cb556-8" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb556-9"><a href="веб-скрапинг.html#cb556-9" tabindex="-1"></a><span class="co"># valid_names_vec &lt;- as.character(valid_names$lemma)</span></span>
<span id="cb556-10"><a href="веб-скрапинг.html#cb556-10" tabindex="-1"></a></span>
<span id="cb556-11"><a href="веб-скрапинг.html#cb556-11" tabindex="-1"></a><span class="co"># список имен отредактирован вручную</span></span>
<span id="cb556-12"><a href="веб-скрапинг.html#cb556-12" tabindex="-1"></a><span class="co"># write.table(valid_names_vec, file = &quot;files/names.txt&quot;, </span></span>
<span id="cb556-13"><a href="веб-скрапинг.html#cb556-13" tabindex="-1"></a><span class="co">#            row.names = F, col.names = F)</span></span></code></pre></div>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="веб-скрапинг.html#cb557-1" tabindex="-1"></a>valid_names <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="at">file =</span> <span class="st">&quot;files/names.txt&quot;</span>, <span class="at">col_names =</span> F)</span>
<span id="cb557-2"><a href="веб-скрапинг.html#cb557-2" tabindex="-1"></a></span>
<span id="cb557-3"><a href="веб-скрапинг.html#cb557-3" tabindex="-1"></a>valid_names <span class="ot">&lt;-</span> valid_names <span class="sc">%&gt;%</span> </span>
<span id="cb557-4"><a href="веб-скрапинг.html#cb557-4" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">names =</span> X1) <span class="sc">%&gt;%</span> </span>
<span id="cb557-5"><a href="веб-скрапинг.html#cb557-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">names =</span> <span class="fu">str_remove_all</span>(names, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">W&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb557-6"><a href="веб-скрапинг.html#cb557-6" tabindex="-1"></a>  <span class="fu">pull</span>(names)</span></code></pre></div>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="веб-скрапинг.html#cb558-1" tabindex="-1"></a>messages_signed <span class="ot">&lt;-</span> messages_signed <span class="sc">%&gt;%</span> </span>
<span id="cb558-2"><a href="веб-скрапинг.html#cb558-2" tabindex="-1"></a>  <span class="fu">filter</span>(upos <span class="sc">!=</span> <span class="st">&quot;PROPN&quot;</span> <span class="sc">|</span> upos <span class="sc">==</span> <span class="st">&quot;PROPN&quot;</span> <span class="sc">&amp;</span> lemma <span class="sc">%in%</span> valid_names) <span class="sc">%&gt;%</span> </span>
<span id="cb558-3"><a href="веб-скрапинг.html#cb558-3" tabindex="-1"></a>  <span class="fu">filter</span>(upos <span class="sc">!=</span> <span class="st">&quot;PUNCT&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb558-4"><a href="веб-скрапинг.html#cb558-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>upos <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;NUM&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb558-5"><a href="веб-скрапинг.html#cb558-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lemma =</span> <span class="fu">str_replace_all</span>(lemma, <span class="st">&quot;-&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb558-6"><a href="веб-скрапинг.html#cb558-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lemma =</span> <span class="fu">str_remove_all</span>(lemma, <span class="st">&quot;[[:punct:]]&quot;</span>))</span></code></pre></div>
<p>После некоторых сомнений, я удалю все, кроме кириллицы – на канале очень много латинского и греческого текста, на этапе создания термдокументной матрицы из-за этого будет почти 100% разреженность.</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="веб-скрапинг.html#cb559-1" tabindex="-1"></a>messages_signed <span class="ot">&lt;-</span> messages_signed <span class="sc">%&gt;%</span> </span>
<span id="cb559-2"><a href="веб-скрапинг.html#cb559-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lemma =</span> <span class="fu">str_replace_all</span>(lemma, <span class="st">&quot;[[^\u0400-\u04FF]]&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb559-3"><a href="веб-скрапинг.html#cb559-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">nchar</span>(lemma) <span class="sc">&gt;</span> <span class="dv">0</span>) </span></code></pre></div>
<p>Дальше были исправлены некоторые ошибки лемматизации.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="веб-скрапинг.html#cb560-1" tabindex="-1"></a>text_tidy <span class="ot">&lt;-</span> messages_signed <span class="sc">%&gt;%</span></span>
<span id="cb560-2"><a href="веб-скрапинг.html#cb560-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lemma =</span> <span class="fu">tolower</span>(lemma)) <span class="sc">%&gt;%</span> </span>
<span id="cb560-3"><a href="веб-скрапинг.html#cb560-3" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(lemma), <span class="sc">~</span></span>
<span id="cb560-4"><a href="веб-скрапинг.html#cb560-4" tabindex="-1"></a>       <span class="fu">case_when</span>(lemma <span class="sc">==</span> <span class="st">&quot;мят&quot;</span> <span class="sc">~</span>  <span class="st">&quot;мята&quot;</span>,</span>
<span id="cb560-5"><a href="веб-скрапинг.html#cb560-5" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;сенек&quot;</span>) <span class="sc">~</span> <span class="st">&quot;сенека&quot;</span>,</span>
<span id="cb560-6"><a href="веб-скрапинг.html#cb560-6" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;аттик&quot;</span>) <span class="sc">~</span> <span class="st">&quot;аттик&quot;</span>,</span>
<span id="cb560-7"><a href="веб-скрапинг.html#cb560-7" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;кальвиз&quot;</span>) <span class="sc">~</span> <span class="st">&quot;кальвизий&quot;</span>,</span>
<span id="cb560-8"><a href="веб-скрапинг.html#cb560-8" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;горац&quot;</span>) <span class="sc">~</span> <span class="st">&quot;гораций&quot;</span>,</span>
<span id="cb560-9"><a href="веб-скрапинг.html#cb560-9" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;гален&quot;</span>) <span class="sc">~</span> <span class="st">&quot;гален&quot;</span>,</span>
<span id="cb560-10"><a href="веб-скрапинг.html#cb560-10" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;плотин&quot;</span>) <span class="sc">~</span> <span class="st">&quot;плотин&quot;</span>,</span>
<span id="cb560-11"><a href="веб-скрапинг.html#cb560-11" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;августин&quot;</span>) <span class="sc">~</span> <span class="st">&quot;августин&quot;</span>,</span>
<span id="cb560-12"><a href="веб-скрапинг.html#cb560-12" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;абари&quot;</span>) <span class="sc">~</span> <span class="st">&quot;абарид&quot;</span>,</span>
<span id="cb560-13"><a href="веб-скрапинг.html#cb560-13" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;катулл&quot;</span>) <span class="sc">~</span> <span class="st">&quot;катулл&quot;</span>,</span>
<span id="cb560-14"><a href="веб-скрапинг.html#cb560-14" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;лукул&quot;</span>) <span class="sc">~</span> <span class="st">&quot;лукулл&quot;</span>,</span>
<span id="cb560-15"><a href="веб-скрапинг.html#cb560-15" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;посидо&quot;</span>) <span class="sc">~</span> <span class="st">&quot;посидоний&quot;</span>,</span>
<span id="cb560-16"><a href="веб-скрапинг.html#cb560-16" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;деркилл&quot;</span>) <span class="sc">~</span> <span class="st">&quot;деркиллид&quot;</span>,</span>
<span id="cb560-17"><a href="веб-скрапинг.html#cb560-17" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;порфир&quot;</span>) <span class="sc">~</span> <span class="st">&quot;порфирий&quot;</span>,</span>
<span id="cb560-18"><a href="веб-скрапинг.html#cb560-18" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;афин&quot;</span>) <span class="sc">~</span> <span class="st">&quot;афины&quot;</span>,</span>
<span id="cb560-19"><a href="веб-скрапинг.html#cb560-19" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;локк&quot;</span>) <span class="sc">~</span> <span class="st">&quot;локк&quot;</span>,</span>
<span id="cb560-20"><a href="веб-скрапинг.html#cb560-20" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;макроб&quot;</span>) <span class="sc">~</span> <span class="st">&quot;макробий&quot;</span>,</span>
<span id="cb560-21"><a href="веб-скрапинг.html#cb560-21" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;лаэр&quot;</span>) <span class="sc">~</span> <span class="st">&quot;лаэрций&quot;</span>,</span>
<span id="cb560-22"><a href="веб-скрапинг.html#cb560-22" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;макрин&quot;</span>) <span class="sc">~</span> <span class="st">&quot;макрина&quot;</span>,</span>
<span id="cb560-23"><a href="веб-скрапинг.html#cb560-23" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;маркиш&quot;</span>) <span class="sc">~</span> <span class="st">&quot;маркиш&quot;</span>,</span>
<span id="cb560-24"><a href="веб-скрапинг.html#cb560-24" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;маячк&quot;</span>) <span class="sc">~</span> <span class="st">&quot;маячок&quot;</span>,</span>
<span id="cb560-25"><a href="веб-скрапинг.html#cb560-25" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;очерк&quot;</span>) <span class="sc">~</span> <span class="st">&quot;очерк&quot;</span>,</span>
<span id="cb560-26"><a href="веб-скрапинг.html#cb560-26" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;птолем&quot;</span>) <span class="sc">~</span> <span class="st">&quot;птолемей&quot;</span>,</span>
<span id="cb560-27"><a href="веб-скрапинг.html#cb560-27" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;росса&quot;</span>) <span class="sc">~</span> <span class="st">&quot;росс&quot;</span>,</span>
<span id="cb560-28"><a href="веб-скрапинг.html#cb560-28" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;самосат&quot;</span>) <span class="sc">~</span> <span class="st">&quot;самосата&quot;</span>,</span>
<span id="cb560-29"><a href="веб-скрапинг.html#cb560-29" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;стрепсиад&quot;</span>) <span class="sc">~</span> <span class="st">&quot;стрепсиад&quot;</span>,</span>
<span id="cb560-30"><a href="веб-скрапинг.html#cb560-30" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;эпихар&quot;</span>) <span class="sc">~</span> <span class="st">&quot;эпихарм&quot;</span>,</span>
<span id="cb560-31"><a href="веб-скрапинг.html#cb560-31" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;ямвл&quot;</span>) <span class="sc">~</span> <span class="st">&quot;ямвлих&quot;</span>,</span>
<span id="cb560-32"><a href="веб-скрапинг.html#cb560-32" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;брумал&quot;</span>) <span class="sc">~</span> <span class="st">&quot;брумалии&quot;</span>,</span>
<span id="cb560-33"><a href="веб-скрапинг.html#cb560-33" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;иоанн&quot;</span>) <span class="sc">~</span> <span class="st">&quot;иоанн&quot;</span>,</span>
<span id="cb560-34"><a href="веб-скрапинг.html#cb560-34" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;кинопоиск&quot;</span>) <span class="sc">~</span> <span class="st">&quot;кинопоиск&quot;</span>,</span>
<span id="cb560-35"><a href="веб-скрапинг.html#cb560-35" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;корнар&quot;</span>) <span class="sc">~</span> <span class="st">&quot;корнарий&quot;</span>,</span>
<span id="cb560-36"><a href="веб-скрапинг.html#cb560-36" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;луция&quot;</span>) <span class="sc">~</span> <span class="st">&quot;луций&quot;</span>,</span>
<span id="cb560-37"><a href="веб-скрапинг.html#cb560-37" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;кассия&quot;</span>) <span class="sc">~</span> <span class="st">&quot;кассий&quot;</span>,</span>
<span id="cb560-38"><a href="веб-скрапинг.html#cb560-38" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;минф&quot;</span>) <span class="sc">~</span> <span class="st">&quot;минфа&quot;</span>,</span>
<span id="cb560-39"><a href="веб-скрапинг.html#cb560-39" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;персефон&quot;</span>) <span class="sc">~</span> <span class="st">&quot;персефона&quot;</span>,</span>
<span id="cb560-40"><a href="веб-скрапинг.html#cb560-40" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;пестум&quot;</span>) <span class="sc">~</span> <span class="st">&quot;пестум&quot;</span>,</span>
<span id="cb560-41"><a href="веб-скрапинг.html#cb560-41" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;платон&quot;</span>) <span class="sc">~</span> <span class="st">&quot;платон&quot;</span>,</span>
<span id="cb560-42"><a href="веб-скрапинг.html#cb560-42" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;платно&quot;</span>) <span class="sc">~</span> <span class="st">&quot;платон&quot;</span>,</span>
<span id="cb560-43"><a href="веб-скрапинг.html#cb560-43" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;филеб&quot;</span>) <span class="sc">~</span> <span class="st">&quot;филеб&quot;</span>,</span>
<span id="cb560-44"><a href="веб-скрапинг.html#cb560-44" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;фульг&quot;</span>) <span class="sc">~</span> <span class="st">&quot;фульгенций&quot;</span>,</span>
<span id="cb560-45"><a href="веб-скрапинг.html#cb560-45" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;аврел&quot;</span>) <span class="sc">~</span> <span class="st">&quot;аврелий&quot;</span>,</span>
<span id="cb560-46"><a href="веб-скрапинг.html#cb560-46" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;антигон&quot;</span>) <span class="sc">~</span> <span class="st">&quot;антигона&quot;</span>,</span>
<span id="cb560-47"><a href="веб-скрапинг.html#cb560-47" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;анция&quot;</span>) <span class="sc">~</span> <span class="st">&quot;анций&quot;</span>,</span>
<span id="cb560-48"><a href="веб-скрапинг.html#cb560-48" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;борея&quot;</span>) <span class="sc">~</span> <span class="st">&quot;борей&quot;</span>,</span>
<span id="cb560-49"><a href="веб-скрапинг.html#cb560-49" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;вольтер&quot;</span>) <span class="sc">~</span> <span class="st">&quot;вольтер&quot;</span>,</span>
<span id="cb560-50"><a href="веб-скрапинг.html#cb560-50" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;гераклид&quot;</span>) <span class="sc">~</span> <span class="st">&quot;гераклид&quot;</span>,</span>
<span id="cb560-51"><a href="веб-скрапинг.html#cb560-51" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;теэтет&quot;</span>) <span class="sc">~</span> <span class="st">&quot;теэтет&quot;</span>,</span>
<span id="cb560-52"><a href="веб-скрапинг.html#cb560-52" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;евангел&quot;</span>) <span class="sc">~</span> <span class="st">&quot;евангелие&quot;</span>,</span>
<span id="cb560-53"><a href="веб-скрапинг.html#cb560-53" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;федон&quot;</span>) <span class="sc">~</span> <span class="st">&quot;федон&quot;</span>,</span>
<span id="cb560-54"><a href="веб-скрапинг.html#cb560-54" tabindex="-1"></a>                 <span class="cn">TRUE</span> <span class="sc">~</span> .))</span></code></pre></div>
<p>Получившийся тиббл сохраняю – он понадобится в главе 13.</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="веб-скрапинг.html#cb561-1" tabindex="-1"></a><span class="fu">save</span>(text_tidy, <span class="at">file =</span> <span class="st">&quot;data/AntibarbariTidy.Rdata&quot;</span>)</span></code></pre></div>
</div>
<div id="html-таблицы" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> Html таблицы<a href="веб-скрапинг.html#html-таблицы" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To be supplied.</p>
</div>
<div id="wikisource" class="section level2 hasAnchor" number="9.10">
<h2><span class="header-section-number">9.10</span> Wikisource<a href="веб-скрапинг.html#wikisource" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Многие тексты доступны на сайте Wikisource.org. Попробуем извлечь все сказки Салтыкова-Щедрина.</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="веб-скрапинг.html#cb562-1" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://ru.wikisource.org/wiki/%D0%9C%D0%B8%D1%85%D0%B0%D0%B8%D0%BB_%D0%95%D0%B2%D0%B3%D1%80%D0%B0%D1%84%D0%BE%D0%B2%D0%B8%D1%87_%D0%A1%D0%B0%D0%BB%D1%82%D1%8B%D0%BA%D0%BE%D0%B2-%D0%A9%D0%B5%D0%B4%D1%80%D0%B8%D0%BD&quot;</span></span>
<span id="cb562-2"><a href="веб-скрапинг.html#cb562-2" tabindex="-1"></a>html <span class="ot">=</span> <span class="fu">read_html</span>(url)</span></code></pre></div>
<p>Для того, чтобы справиться с такой страницей, пригодится Selector Gadget (расширение для Chrome). Вот <a href="https://youtu.be/oqNTfWrGdbk">тут</a> можно посмотреть короткое видео, как его установить. При помощи селектора выбираем нужные уровни.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="веб-скрапинг.html#cb563-1" tabindex="-1"></a>toc <span class="ot">&lt;-</span> html <span class="sc">%&gt;%</span> </span>
<span id="cb563-2"><a href="веб-скрапинг.html#cb563-2" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;ul:nth-child(22) a&quot;</span>)</span>
<span id="cb563-3"><a href="веб-скрапинг.html#cb563-3" tabindex="-1"></a></span>
<span id="cb563-4"><a href="веб-скрапинг.html#cb563-4" tabindex="-1"></a><span class="fu">head</span>(toc)</span></code></pre></div>
<pre><code>## {xml_nodeset (6)}
## [1] &lt;a href=&quot;/wiki/%D0%9F%D0%BE%D0%B2%D0%B5%D1%81%D1%82%D1%8C_%D0%BE_%D1%82%D ...
## [2] &lt;a href=&quot;/wiki/%D0%93%D0%BE%D0%B4%D0%BE%D0%B2%D1%89%D0%B8%D0%BD%D0%B0_(%D ...
## [3] &lt;a href=&quot;/wiki/%D0%9F%D1%80%D0%BE%D0%BF%D0%B0%D0%BB%D0%B0_%D1%81%D0%BE%D0 ...
## [4] &lt;a href=&quot;/wiki/%D0%94%D0%B8%D0%BA%D0%B8%D0%B9_%D0%BF%D0%BE%D0%BC%D0%B5%D1 ...
## [5] &lt;a href=&quot;/wiki/%D0%9F%D1%80%D0%B5%D0%BC%D1%83%D0%B4%D1%80%D1%8B%D0%B9_%D0 ...
## [6] &lt;a href=&quot;/wiki/%D0%A1%D0%B0%D0%BC%D0%BE%D0%BE%D1%82%D0%B2%D0%B5%D1%80%D0% ...</code></pre>
<p>Теперь у нас есть список ссылок.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="веб-скрапинг.html#cb565-1" tabindex="-1"></a>tales <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb565-2"><a href="веб-скрапинг.html#cb565-2" tabindex="-1"></a>  <span class="at">title =</span> toc <span class="sc">%&gt;%</span></span>
<span id="cb565-3"><a href="веб-скрапинг.html#cb565-3" tabindex="-1"></a>    <span class="fu">html_attr</span>(<span class="st">&quot;title&quot;</span>),</span>
<span id="cb565-4"><a href="веб-скрапинг.html#cb565-4" tabindex="-1"></a>  <span class="at">href =</span> toc <span class="sc">%&gt;%</span> </span>
<span id="cb565-5"><a href="веб-скрапинг.html#cb565-5" tabindex="-1"></a>    <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>)</span>
<span id="cb565-6"><a href="веб-скрапинг.html#cb565-6" tabindex="-1"></a>)</span></code></pre></div>
<p>Данных о годе публикации под тегом <a> нет; надо подняться на уровень выше:</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="веб-скрапинг.html#cb566-1" tabindex="-1"></a>toc2 <span class="ot">&lt;-</span> html <span class="sc">%&gt;%</span> </span>
<span id="cb566-2"><a href="веб-скрапинг.html#cb566-2" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;ul:nth-child(22) li&quot;</span>)</span>
<span id="cb566-3"><a href="веб-скрапинг.html#cb566-3" tabindex="-1"></a></span>
<span id="cb566-4"><a href="веб-скрапинг.html#cb566-4" tabindex="-1"></a><span class="fu">head</span>(toc2)</span></code></pre></div>
<pre><code>## {xml_nodeset (6)}
## [1] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%9F%D0%BE%D0%B2%D0%B5%D1%81%D1%82%D1%8C_%D0%BE_%D ...
## [2] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%93%D0%BE%D0%B4%D0%BE%D0%B2%D1%89%D0%B8%D0%BD%D0% ...
## [3] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%9F%D1%80%D0%BE%D0%BF%D0%B0%D0%BB%D0%B0_%D1%81%D0 ...
## [4] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%94%D0%B8%D0%BA%D0%B8%D0%B9_%D0%BF%D0%BE%D0%BC%D0 ...
## [5] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%9F%D1%80%D0%B5%D0%BC%D1%83%D0%B4%D1%80%D1%8B%D0% ...
## [6] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%A1%D0%B0%D0%BC%D0%BE%D0%BE%D1%82%D0%B2%D0%B5%D1% ...</code></pre>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="веб-скрапинг.html#cb568-1" tabindex="-1"></a>toc2 <span class="sc">%&gt;%</span></span>
<span id="cb568-2"><a href="веб-скрапинг.html#cb568-2" tabindex="-1"></a>  <span class="fu">html_text2</span>()</span></code></pre></div>
<pre><code>##  [1] &quot;Повесть о том, как один мужик двух генералов прокормил, 1869&quot;
##  [2] &quot;Годовщина, 1869&quot;                                             
##  [3] &quot;Пропала совесть, 1869&quot;                                       
##  [4] &quot;Дикий помещик, 1869&quot;                                         
##  [5] &quot;Премудрый пискарь, 1883&quot;                                     
##  [6] &quot;Самоотверженный заяц, 1883&quot;                                  
##  [7] &quot;Бедный волк, 1883&quot;                                           
##  [8] &quot;Добродетели и Пороки, 1884&quot;                                  
##  [9] &quot;Медведь на воеводстве, 1884&quot;                                 
## [10] &quot;Обманщик-газетчик и легковерный читатель, 1884&quot;              
## [11] &quot;Вяленая вобла, 1884&quot;                                         
## [12] &quot;Орёл-меценат, 1884&quot;                                          
## [13] &quot;Карась-идеалист, 1884&quot;                                       
## [14] &quot;Игрушечного дела людишки, 1879, 1886&quot;                        
## [15] &quot;Чижиково горе, 1884&quot;                                         
## [16] &quot;Верный Трезор, 1885&quot;                                         
## [17] &quot;Недреманное око, конец 1885 или начало 1886&quot;                 
## [18] &quot;Дурак, 1885&quot;                                                 
## [19] &quot;Соседи, 1885&quot;                                                
## [20] &quot;Здравомысленный заяц, 1885&quot;                                  
## [21] &quot;Либерал, 1885&quot;                                               
## [22] &quot;Баран-непомнящий, 1885&quot;                                      
## [23] &quot;Коняга, 1855&quot;                                                
## [24] &quot;Кисель, 1855&quot;                                                
## [25] &quot;Праздный разговор, 1886&quot;                                     
## [26] &quot;Деревенский пожар, 1885&quot;                                     
## [27] &quot;Путём-дорогою, 1886&quot;                                         
## [28] &quot;Богатырь, 1886&quot;                                              
## [29] &quot;Гиена, 1886&quot;                                                 
## [30] &quot;Приключение с Крамольниковым, 1886&quot;                          
## [31] &quot;Христова ночь, 1886&quot;                                         
## [32] &quot;Ворон-челобитчик, 1886&quot;                                      
## [33] &quot;Рождественская сказка, 1886&quot;</code></pre>
<p>Соединяем:</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="веб-скрапинг.html#cb570-1" tabindex="-1"></a>tales <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb570-2"><a href="веб-скрапинг.html#cb570-2" tabindex="-1"></a>  <span class="at">title_year =</span> toc2 <span class="sc">%&gt;%</span></span>
<span id="cb570-3"><a href="веб-скрапинг.html#cb570-3" tabindex="-1"></a>    <span class="fu">html_text2</span>(),</span>
<span id="cb570-4"><a href="веб-скрапинг.html#cb570-4" tabindex="-1"></a>  <span class="at">href =</span> toc <span class="sc">%&gt;%</span> </span>
<span id="cb570-5"><a href="веб-скрапинг.html#cb570-5" tabindex="-1"></a>    <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>)</span>
<span id="cb570-6"><a href="веб-скрапинг.html#cb570-6" tabindex="-1"></a>)</span>
<span id="cb570-7"><a href="веб-скрапинг.html#cb570-7" tabindex="-1"></a></span>
<span id="cb570-8"><a href="веб-скрапинг.html#cb570-8" tabindex="-1"></a>tales</span></code></pre></div>
<pre><code>## # A tibble: 33 × 2
##    title_year                                                   href            
##    &lt;chr&gt;                                                        &lt;chr&gt;           
##  1 Повесть о том, как один мужик двух генералов прокормил, 1869 /wiki/%D0%9F%D0…
##  2 Годовщина, 1869                                              /wiki/%D0%93%D0…
##  3 Пропала совесть, 1869                                        /wiki/%D0%9F%D1…
##  4 Дикий помещик, 1869                                          /wiki/%D0%94%D0…
##  5 Премудрый пискарь, 1883                                      /wiki/%D0%9F%D1…
##  6 Самоотверженный заяц, 1883                                   /wiki/%D0%A1%D0…
##  7 Бедный волк, 1883                                            /wiki/%D0%91%D0…
##  8 Добродетели и Пороки, 1884                                   /wiki/%D0%94%D0…
##  9 Медведь на воеводстве, 1884                                  /wiki/%D0%9C%D0…
## 10 Обманщик-газетчик и легковерный читатель, 1884               /wiki/%D0%9E%D0…
## # ℹ 23 more rows</code></pre>
<p>Дальше можно достать текст для каждой сказки. Потренируемся на одной. Снова привлекаем Selector Gadget для составления правила.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="веб-скрапинг.html#cb572-1" tabindex="-1"></a>url_test <span class="ot">&lt;-</span> tales <span class="sc">%&gt;%</span> </span>
<span id="cb572-2"><a href="веб-скрапинг.html#cb572-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb572-3"><a href="веб-скрапинг.html#cb572-3" tabindex="-1"></a>  <span class="fu">pull</span>(href) <span class="sc">%&gt;%</span> </span>
<span id="cb572-4"><a href="веб-скрапинг.html#cb572-4" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">&quot;https://ru.wikisource.org&quot;</span>, .)</span>
<span id="cb572-5"><a href="веб-скрапинг.html#cb572-5" tabindex="-1"></a></span>
<span id="cb572-6"><a href="веб-скрапинг.html#cb572-6" tabindex="-1"></a>text <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_test) <span class="sc">%&gt;%</span> </span>
<span id="cb572-7"><a href="веб-скрапинг.html#cb572-7" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;.indent p&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb572-8"><a href="веб-скрапинг.html#cb572-8" tabindex="-1"></a>  <span class="fu">html_text2</span>() </span>
<span id="cb572-9"><a href="веб-скрапинг.html#cb572-9" tabindex="-1"></a></span>
<span id="cb572-10"><a href="веб-скрапинг.html#cb572-10" tabindex="-1"></a>text[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] &quot;Жили да были два генерала, и так как оба были легкомысленны, то в скором времени, по щучьему велению, по моему хотению, очутились на необитаемом острове.&quot;</code></pre>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="веб-скрапинг.html#cb574-1" tabindex="-1"></a>text[<span class="fu">length</span>(text)]</span></code></pre></div>
<pre><code>## [1] &quot;Однако, и об мужике не забыли; выслали ему рюмку водки да пятак серебра: веселись, мужичина!&quot;</code></pre>
<p>Первый и последний параграф достали верно; можно обобщать.</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="веб-скрапинг.html#cb576-1" tabindex="-1"></a>tales <span class="ot">&lt;-</span> tales <span class="sc">%&gt;%</span> </span>
<span id="cb576-2"><a href="веб-скрапинг.html#cb576-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">href =</span> <span class="fu">paste0</span>(<span class="st">&quot;https://ru.wikisource.org&quot;</span>, href))</span></code></pre></div>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="веб-скрапинг.html#cb577-1" tabindex="-1"></a>urls <span class="ot">&lt;-</span> tales <span class="sc">%&gt;%</span> </span>
<span id="cb577-2"><a href="веб-скрапинг.html#cb577-2" tabindex="-1"></a>  <span class="fu">pull</span>(href)</span></code></pre></div>
<p>Функция для извлечения текстов.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="веб-скрапинг.html#cb578-1" tabindex="-1"></a>get_text <span class="ot">&lt;-</span> <span class="cf">function</span>(url) {</span>
<span id="cb578-2"><a href="веб-скрапинг.html#cb578-2" tabindex="-1"></a>  <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb578-3"><a href="веб-скрапинг.html#cb578-3" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;.indent p&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb578-4"><a href="веб-скрапинг.html#cb578-4" tabindex="-1"></a>  <span class="fu">html_text2</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb578-5"><a href="веб-скрапинг.html#cb578-5" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="at">collapse=</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb578-6"><a href="веб-скрапинг.html#cb578-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="веб-скрапинг.html#cb579-1" tabindex="-1"></a>tales_text <span class="ot">&lt;-</span> <span class="fu">map</span>(urls, get_text)</span></code></pre></div>
<p>Несколько сказок не выловились: там другая структура html, но в целом все получилось.</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="веб-скрапинг.html#cb580-1" tabindex="-1"></a>tales_text <span class="ot">&lt;-</span> tales_text <span class="sc">%&gt;%</span></span>
<span id="cb580-2"><a href="веб-скрапинг.html#cb580-2" tabindex="-1"></a>  <span class="fu">flatten_chr</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb580-3"><a href="веб-скрапинг.html#cb580-3" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb580-4"><a href="веб-скрапинг.html#cb580-4" tabindex="-1"></a></span>
<span id="cb580-5"><a href="веб-скрапинг.html#cb580-5" tabindex="-1"></a>tales <span class="ot">&lt;-</span> tales <span class="sc">%&gt;%</span> </span>
<span id="cb580-6"><a href="веб-скрапинг.html#cb580-6" tabindex="-1"></a>  <span class="fu">bind_cols</span>(tales_text)</span></code></pre></div>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="веб-скрапинг.html#cb581-1" tabindex="-1"></a>tales</span></code></pre></div>
<pre><code>## # A tibble: 33 × 3
##    title_year                                                   href       value
##    &lt;chr&gt;                                                        &lt;chr&gt;      &lt;chr&gt;
##  1 Повесть о том, как один мужик двух генералов прокормил, 1869 https://r… &quot;Жил…
##  2 Годовщина, 1869                                              https://r… &quot;Сег…
##  3 Пропала совесть, 1869                                        https://r… &quot;Про…
##  4 Дикий помещик, 1869                                          https://r… &quot;В н…
##  5 Премудрый пискарь, 1883                                      https://r… &quot;Жил…
##  6 Самоотверженный заяц, 1883                                   https://r… &quot;Одн…
##  7 Бедный волк, 1883                                            https://r… &quot;Дру…
##  8 Добродетели и Пороки, 1884                                   https://r… &quot;Доб…
##  9 Медведь на воеводстве, 1884                                  https://r… &quot;&quot;   
## 10 Обманщик-газетчик и легковерный читатель, 1884               https://r… &quot;Жил…
## # ℹ 23 more rows</code></pre>
<p>Дальше можно разделить столбец с названием и годом и, например, удалить ссылку, она больше не нужна. Разделить по запятой не получится, т.к. она есть в некоторых названиях.</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="веб-скрапинг.html#cb583-1" tabindex="-1"></a>tales <span class="ot">&lt;-</span> tales <span class="sc">%&gt;%</span> </span>
<span id="cb583-2"><a href="веб-скрапинг.html#cb583-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>href) <span class="sc">%&gt;%</span> </span>
<span id="cb583-3"><a href="веб-скрапинг.html#cb583-3" tabindex="-1"></a>  <span class="fu">separate</span>(title_year, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;year&quot;</span>), <span class="at">sep =</span> <span class="sc">-</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb583-4"><a href="веб-скрапинг.html#cb583-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">title =</span> <span class="fu">str_remove</span>(title, <span class="st">&quot;,$&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="веб-скрапинг.html#cb584-1" tabindex="-1"></a>tales</span></code></pre></div>
<pre><code>## # A tibble: 33 × 3
##    title                                                  year    value         
##    &lt;chr&gt;                                                  &lt;chr&gt;   &lt;chr&gt;         
##  1 Повесть о том, как один мужик двух генералов прокормил &quot; 1869&quot; &quot;Жили да были…
##  2 Годовщина                                              &quot; 1869&quot; &quot;Сегодня мне …
##  3 Пропала совесть                                        &quot; 1869&quot; &quot;Пропала сове…
##  4 Дикий помещик                                          &quot; 1869&quot; &quot;В некотором …
##  5 Премудрый пискарь                                      &quot; 1883&quot; &quot;Жил-был писк…
##  6 Самоотверженный заяц                                   &quot; 1883&quot; &quot;Однажды заяц…
##  7 Бедный волк                                            &quot; 1883&quot; &quot;Другой зверь…
##  8 Добродетели и Пороки                                   &quot; 1884&quot; &quot;Добродетели …
##  9 Медведь на воеводстве                                  &quot; 1884&quot; &quot;&quot;            
## 10 Обманщик-газетчик и легковерный читатель               &quot; 1884&quot; &quot;Жил-был газе…
## # ℹ 23 more rows</code></pre>
<p>Недостающие две сказки я не буду пытаться извлечь, но логику вы поняли.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="регулярные-выражения.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="токенизация-и-лемматизация.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/locusclassicus/text_analysis_2023/edit/main/08-scraping.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
