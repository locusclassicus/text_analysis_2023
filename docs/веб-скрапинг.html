<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Тема 9 Веб-скрапинг | Компьютерный анализ текста в R</title>
  <meta name="description" content="Все прекрасное трудно." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Тема 9 Веб-скрапинг | Компьютерный анализ текста в R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Все прекрасное трудно." />
  <meta name="github-repo" content="https://github.com/locusclassicus/text_analysis_r_bookdown_2023/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Тема 9 Веб-скрапинг | Компьютерный анализ текста в R" />
  
  <meta name="twitter:description" content="Все прекрасное трудно." />
  

<meta name="author" content="Ольга Алиева" />


<meta name="date" content="2023-12-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="регулярные-выражения.html"/>
<link rel="next" href="токенизация-и-лемматизация.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.29/datatables.js"></script>
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Компьютерный анализ текста в R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#благодарности"><i class="fa fa-check"></i><b>1.1</b> Благодарности</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html"><i class="fa fa-check"></i><b>2</b> Начало работы с R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#о-чем-этот-курс"><i class="fa fa-check"></i><b>2.1</b> О чем этот курс</a></li>
<li class="chapter" data-level="2.2" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#что-такое-r"><i class="fa fa-check"></i><b>2.2</b> Что такое R?</a></li>
<li class="chapter" data-level="2.3" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#пакеты-и-виньетки"><i class="fa fa-check"></i><b>2.3</b> Пакеты и виньетки</a></li>
<li class="chapter" data-level="2.4" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#о-воспроизводимости"><i class="fa fa-check"></i><b>2.4</b> О воспроизводимости</a></li>
<li class="chapter" data-level="2.5" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#rstudio"><i class="fa fa-check"></i><b>2.5</b> RStudio</a></li>
<li class="chapter" data-level="2.6" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#установка"><i class="fa fa-check"></i><b>2.6</b> Установка</a></li>
<li class="chapter" data-level="2.7" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#начало-работы"><i class="fa fa-check"></i><b>2.7</b> Начало работы</a></li>
<li class="chapter" data-level="2.8" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#r-как-калькулятор"><i class="fa fa-check"></i><b>2.8</b> R как калькулятор</a></li>
<li class="chapter" data-level="2.9" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#операторы-присваивания"><i class="fa fa-check"></i><b>2.9</b> Операторы присваивания</a></li>
<li class="chapter" data-level="2.10" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#векторы"><i class="fa fa-check"></i><b>2.10</b> Векторы</a></li>
<li class="chapter" data-level="2.11" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#отсутствующие-значения"><i class="fa fa-check"></i><b>2.11</b> Отсутствующие значения</a></li>
<li class="chapter" data-level="2.12" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#списки"><i class="fa fa-check"></i><b>2.12</b> Списки</a></li>
<li class="chapter" data-level="2.13" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#матрицы"><i class="fa fa-check"></i><b>2.13</b> Матрицы</a></li>
<li class="chapter" data-level="2.14" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#таблицы"><i class="fa fa-check"></i><b>2.14</b> Таблицы</a></li>
<li class="chapter" data-level="2.15" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#практическое-задание"><i class="fa fa-check"></i><b>2.15</b> Практическое задание</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="визуализации.html"><a href="визуализации.html"><i class="fa fa-check"></i><b>3</b> Визуализации</a>
<ul>
<li class="chapter" data-level="3.1" data-path="визуализации.html"><a href="визуализации.html#базовый-r"><i class="fa fa-check"></i><b>3.1</b> Базовый R</a></li>
<li class="chapter" data-level="3.2" data-path="визуализации.html"><a href="визуализации.html#lattice"><i class="fa fa-check"></i><b>3.2</b> Lattice</a></li>
<li class="chapter" data-level="3.3" data-path="визуализации.html"><a href="визуализации.html#ggplot2"><i class="fa fa-check"></i><b>3.3</b> Ggplot2</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="визуализации.html"><a href="визуализации.html#быстрое-решение-qplot"><i class="fa fa-check"></i><b>3.3.1</b> Быстрое решение: qplot()</a></li>
<li class="chapter" data-level="3.3.2" data-path="визуализации.html"><a href="визуализации.html#слой-за-слоем-ggplot"><i class="fa fa-check"></i><b>3.3.2</b> Слой за слоем: ggplot()</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="визуализации.html"><a href="визуализации.html#работа-с-цветом"><i class="fa fa-check"></i><b>3.4</b> Работа с цветом</a></li>
<li class="chapter" data-level="3.5" data-path="визуализации.html"><a href="визуализации.html#экспорт-графиков-из-среды-r"><i class="fa fa-check"></i><b>3.5</b> Экспорт графиков из среды R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="опрятные-данные.html"><a href="опрятные-данные.html"><i class="fa fa-check"></i><b>4</b> Опрятные данные</a>
<ul>
<li class="chapter" data-level="4.1" data-path="опрятные-данные.html"><a href="опрятные-данные.html#синтаксис-tidyverse"><i class="fa fa-check"></i><b>4.1</b> Синтаксис tidyverse</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="опрятные-данные.html"><a href="опрятные-данные.html#tibble"><i class="fa fa-check"></i><b>4.1.1</b> Tibble</a></li>
<li class="chapter" data-level="4.1.2" data-path="опрятные-данные.html"><a href="опрятные-данные.html#dplyr"><i class="fa fa-check"></i><b>4.1.2</b> Dplyr</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="опрятные-данные.html"><a href="опрятные-данные.html#опрятные-данные-1"><i class="fa fa-check"></i><b>4.2</b> Опрятные данные</a></li>
<li class="chapter" data-level="4.3" data-path="опрятные-данные.html"><a href="опрятные-данные.html#пример-буккроссинг"><i class="fa fa-check"></i><b>4.3</b> Пример: буккроссинг</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="опрятные-данные.html"><a href="опрятные-данные.html#смотрим-на-данные"><i class="fa fa-check"></i><b>4.3.1</b> Смотрим на данные</a></li>
<li class="chapter" data-level="4.3.2" data-path="опрятные-данные.html"><a href="опрятные-данные.html#трансформируем-данные"><i class="fa fa-check"></i><b>4.3.2</b> Трансформируем данные</a></li>
<li class="chapter" data-level="4.3.3" data-path="опрятные-данные.html"><a href="опрятные-данные.html#объединяем-данные"><i class="fa fa-check"></i><b>4.3.3</b> Объединяем данные</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html"><i class="fa fa-check"></i><b>5</b> Функциональное программирование</a>
<ul>
<li class="chapter" data-level="5.1" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#зачем-писать-функции"><i class="fa fa-check"></i><b>5.1</b> Зачем писать функции?</a></li>
<li class="chapter" data-level="5.2" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#область-видимости-переменных"><i class="fa fa-check"></i><b>5.2</b> Область видимости переменных</a></li>
<li class="chapter" data-level="5.3" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#аргументы-функции"><i class="fa fa-check"></i><b>5.3</b> Аргументы функции</a></li>
<li class="chapter" data-level="5.4" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#векторизируй-это"><i class="fa fa-check"></i><b>5.4</b> Векторизируй это</a></li>
<li class="chapter" data-level="5.5" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#векторизованные-конструкции"><i class="fa fa-check"></i><b>5.5</b> Векторизованные конструкции</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#циклы"><i class="fa fa-check"></i><b>5.5.1</b> Циклы</a></li>
<li class="chapter" data-level="5.5.2" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#условия"><i class="fa fa-check"></i><b>5.5.2</b> Условия</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#вместо-циклов-семейство-_apply"><i class="fa fa-check"></i><b>5.6</b> Вместо циклов: семейство <code>_apply</code></a></li>
<li class="chapter" data-level="5.7" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#purrr"><i class="fa fa-check"></i><b>5.7</b> Purrr</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#map"><i class="fa fa-check"></i><b>5.7.1</b> <code>map()</code></a></li>
<li class="chapter" data-level="5.7.2" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#map2"><i class="fa fa-check"></i><b>5.7.2</b> <code>map2()</code></a></li>
<li class="chapter" data-level="5.7.3" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#дополнительные-возможности-purrr"><i class="fa fa-check"></i><b>5.7.3</b> Дополнительные возможности purrr</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html"><i class="fa fa-check"></i><b>6</b> Импорт и экспорт данных</a>
<ul>
<li class="chapter" data-level="6.1" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#работа-с-табличными-данными"><i class="fa fa-check"></i><b>6.1</b> Работа с табличными данными</a></li>
<li class="chapter" data-level="6.2" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#чтение-табличных-данных"><i class="fa fa-check"></i><b>6.2</b> Чтение табличных данных</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#csv-и-tsv"><i class="fa fa-check"></i><b>6.2.1</b> csv и tsv</a></li>
<li class="chapter" data-level="6.2.2" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#xls-и-xlsx"><i class="fa fa-check"></i><b>6.2.2</b> xls и xlsx</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#чтение-текстовых-данных"><i class="fa fa-check"></i><b>6.3</b> Чтение текстовых данных</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#txt"><i class="fa fa-check"></i><b>6.3.1</b> txt</a></li>
<li class="chapter" data-level="6.3.2" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#doc"><i class="fa fa-check"></i><b>6.3.2</b> doc</a></li>
<li class="chapter" data-level="6.3.3" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#pdf"><i class="fa fa-check"></i><b>6.3.3</b> pdf</a></li>
<li class="chapter" data-level="6.3.4" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#png"><i class="fa fa-check"></i><b>6.3.4</b> png</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#архивы"><i class="fa fa-check"></i><b>6.4</b> Архивы</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#zip"><i class="fa fa-check"></i><b>6.4.1</b> zip</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#структурированные-данные"><i class="fa fa-check"></i><b>6.5</b> Структурированные данные</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#json"><i class="fa fa-check"></i><b>6.5.1</b> json</a></li>
<li class="chapter" data-level="6.5.2" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#xml"><i class="fa fa-check"></i><b>6.5.2</b> xml</a></li>
<li class="chapter" data-level="6.5.3" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#tei"><i class="fa fa-check"></i><b>6.5.3</b> tei</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#gutenbergr"><i class="fa fa-check"></i><b>6.6</b> GutenbergR</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html"><i class="fa fa-check"></i><b>7</b> Воспроизводимые исследования</a>
<ul>
<li class="chapter" data-level="7.1" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#о-воспроизводимости-1"><i class="fa fa-check"></i><b>7.1</b> О воспроизводимости</a></li>
<li class="chapter" data-level="7.2" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#markdown"><i class="fa fa-check"></i><b>7.2</b> Markdown</a></li>
<li class="chapter" data-level="7.3" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#синтаксис-markdown"><i class="fa fa-check"></i><b>7.3</b> Синтаксис Markdown</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#заголовки"><i class="fa fa-check"></i><b>7.3.1</b> Заголовки</a></li>
<li class="chapter" data-level="7.3.2" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#форматирование"><i class="fa fa-check"></i><b>7.3.2</b> Форматирование</a></li>
<li class="chapter" data-level="7.3.3" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#списки-1"><i class="fa fa-check"></i><b>7.3.3</b> Списки</a></li>
<li class="chapter" data-level="7.3.4" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#ссылки"><i class="fa fa-check"></i><b>7.3.4</b> Ссылки</a></li>
<li class="chapter" data-level="7.3.5" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#изображения"><i class="fa fa-check"></i><b>7.3.5</b> Изображения</a></li>
<li class="chapter" data-level="7.3.6" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#блоки-кода"><i class="fa fa-check"></i><b>7.3.6</b> Блоки кода</a></li>
<li class="chapter" data-level="7.3.7" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#цитаты"><i class="fa fa-check"></i><b>7.3.7</b> Цитаты</a></li>
<li class="chapter" data-level="7.3.8" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#разделители"><i class="fa fa-check"></i><b>7.3.8</b> Разделители</a></li>
<li class="chapter" data-level="7.3.9" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#таблицы-1"><i class="fa fa-check"></i><b>7.3.9</b> Таблицы</a></li>
<li class="chapter" data-level="7.3.10" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#id"><i class="fa fa-check"></i><b>7.3.10</b> Чек-листы</a></li>
<li class="chapter" data-level="7.3.11" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#внутренние-ссылки"><i class="fa fa-check"></i><b>7.3.11</b> Внутренние ссылки</a></li>
<li class="chapter" data-level="7.3.12" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#графики"><i class="fa fa-check"></i><b>7.3.12</b> Графики</a></li>
<li class="chapter" data-level="7.3.13" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#математические-формулы"><i class="fa fa-check"></i><b>7.3.13</b> Математические формулы</a></li>
<li class="chapter" data-level="7.3.14" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#смайлы"><i class="fa fa-check"></i><b>7.3.14</b> Смайлы</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#библиография"><i class="fa fa-check"></i><b>7.4</b> Библиография</a></li>
<li class="chapter" data-level="7.5" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#интерактивные-упражнения"><i class="fa fa-check"></i><b>7.5</b> Интерактивные упражнения</a></li>
<li class="chapter" data-level="7.6" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#публикация-html"><i class="fa fa-check"></i><b>7.6</b> Публикация html</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html"><i class="fa fa-check"></i><b>8</b> Регулярные выражения</a>
<ul>
<li class="chapter" data-level="8.1" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#regex-в-базовом-r"><i class="fa fa-check"></i><b>8.1</b> Regex в базовом R</a></li>
<li class="chapter" data-level="8.2" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#литералы-и-классы"><i class="fa fa-check"></i><b>8.2</b> Литералы и классы</a></li>
<li class="chapter" data-level="8.3" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#якоря"><i class="fa fa-check"></i><b>8.3</b> Якоря</a></li>
<li class="chapter" data-level="8.4" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#метасимволы"><i class="fa fa-check"></i><b>8.4</b> Метасимволы</a></li>
<li class="chapter" data-level="8.5" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#экранирование"><i class="fa fa-check"></i><b>8.5</b> Экранирование</a></li>
<li class="chapter" data-level="8.6" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#квантификация"><i class="fa fa-check"></i><b>8.6</b> Квантификация</a></li>
<li class="chapter" data-level="8.7" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#жадная-и-ленивая-квантификация"><i class="fa fa-check"></i><b>8.7</b> Жадная и ленивая квантификация</a></li>
<li class="chapter" data-level="8.8" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#regex-в-stringr-основы"><i class="fa fa-check"></i><b>8.8</b> Regex в stringr: основы</a></li>
<li class="chapter" data-level="8.9" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_detect-и-str_count"><i class="fa fa-check"></i><b>8.9</b> str_detect() и str_count()</a></li>
<li class="chapter" data-level="8.10" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_extract-str_subset-и-str_match"><i class="fa fa-check"></i><b>8.10</b> str_extract(), str_subset() и str_match()</a></li>
<li class="chapter" data-level="8.11" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_replace"><i class="fa fa-check"></i><b>8.11</b> str_replace</a></li>
<li class="chapter" data-level="8.12" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_split"><i class="fa fa-check"></i><b>8.12</b> str_split</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html"><i class="fa fa-check"></i><b>9</b> Веб-скрапинг</a>
<ul>
<li class="chapter" data-level="9.1" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#структура-html"><i class="fa fa-check"></i><b>9.1</b> Структура html</a></li>
<li class="chapter" data-level="9.2" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#каскадные-таблицы-стилей"><i class="fa fa-check"></i><b>9.2</b> Каскадные таблицы стилей</a></li>
<li class="chapter" data-level="9.3" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#извлечение-данных"><i class="fa fa-check"></i><b>9.3</b> Извлечение данных</a></li>
<li class="chapter" data-level="9.4" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#извлечение-в-тиббл"><i class="fa fa-check"></i><b>9.4</b> Извлечение в тиббл</a></li>
<li class="chapter" data-level="9.5" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#скрапим-телеграм-канал"><i class="fa fa-check"></i><b>9.5</b> Скрапим телеграм-канал</a></li>
<li class="chapter" data-level="9.6" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#эмотиконы"><i class="fa fa-check"></i><b>9.6</b> Эмотиконы</a></li>
<li class="chapter" data-level="9.7" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#рутинная-уборка"><i class="fa fa-check"></i><b>9.7</b> Рутинная уборка</a></li>
<li class="chapter" data-level="9.8" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#лемматизация"><i class="fa fa-check"></i><b>9.8</b> Лемматизация</a></li>
<li class="chapter" data-level="9.9" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#html-таблицы"><i class="fa fa-check"></i><b>9.9</b> Html таблицы</a></li>
<li class="chapter" data-level="9.10" data-path="веб-скрапинг.html"><a href="веб-скрапинг.html#wikisource"><i class="fa fa-check"></i><b>9.10</b> Wikisource</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html"><i class="fa fa-check"></i><b>10</b> Токенизация и лемматизация</a>
<ul>
<li class="chapter" data-level="10.1" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#токенизация-в-tidytext"><i class="fa fa-check"></i><b>10.1</b> Токенизация в tidytext</a></li>
<li class="chapter" data-level="10.2" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#токенизация-в-tokenizers"><i class="fa fa-check"></i><b>10.2</b> Токенизация в tokenizers</a></li>
<li class="chapter" data-level="10.3" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#скипграмы"><i class="fa fa-check"></i><b>10.3</b> Скипграмы</a></li>
<li class="chapter" data-level="10.4" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#лемматизация-и-частеречная-разметка"><i class="fa fa-check"></i><b>10.4</b> Лемматизация и частеречная разметка</a></li>
<li class="chapter" data-level="10.5" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#морфологическая-разметка"><i class="fa fa-check"></i><b>10.5</b> Морфологическая разметка</a></li>
<li class="chapter" data-level="10.6" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#распределение-частей-речи"><i class="fa fa-check"></i><b>10.6</b> Распределение частей речи</a></li>
<li class="chapter" data-level="10.7" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#совместная-встречаемость-слов"><i class="fa fa-check"></i><b>10.7</b> Совместная встречаемость слов</a></li>
<li class="chapter" data-level="10.8" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#синтаксическая-разметка"><i class="fa fa-check"></i><b>10.8</b> Синтаксическая разметка</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html"><i class="fa fa-check"></i><b>11</b> Распределения слов и анализ частотностей</a>
<ul>
<li class="chapter" data-level="11.1" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#извлечение-источников"><i class="fa fa-check"></i><b>11.1</b> Извлечение источников</a></li>
<li class="chapter" data-level="11.2" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#подготовка-источников"><i class="fa fa-check"></i><b>11.2</b> Подготовка источников</a></li>
<li class="chapter" data-level="11.3" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#токенизация"><i class="fa fa-check"></i><b>11.3</b> Токенизация</a></li>
<li class="chapter" data-level="11.4" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#cтоп-слова"><i class="fa fa-check"></i><b>11.4</b> Cтоп-слова</a></li>
<li class="chapter" data-level="11.5" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#абсолютная-частотность"><i class="fa fa-check"></i><b>11.5</b> Абсолютная частотность</a></li>
<li class="chapter" data-level="11.6" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#стемминг"><i class="fa fa-check"></i><b>11.6</b> Стемминг</a></li>
<li class="chapter" data-level="11.7" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#относительная-частотность"><i class="fa fa-check"></i><b>11.7</b> Относительная частотность</a></li>
<li class="chapter" data-level="11.8" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#распределения-слов-токенов"><i class="fa fa-check"></i><b>11.8</b> Распределения слов (токенов)</a></li>
<li class="chapter" data-level="11.9" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#закон-ципфа"><i class="fa fa-check"></i><b>11.9</b> Закон Ципфа</a></li>
<li class="chapter" data-level="11.10" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#ttr-type-token-ratio"><i class="fa fa-check"></i><b>11.10</b> TTR (type-token ratio)</a></li>
<li class="chapter" data-level="11.11" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#tf-idf"><i class="fa fa-check"></i><b>11.11</b> TF-IDF</a></li>
<li class="chapter" data-level="11.12" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#сравнение-при-помощи-диаграммы-рассеяния"><i class="fa fa-check"></i><b>11.12</b> Сравнение при помощи диаграммы рассеяния</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html"><i class="fa fa-check"></i><b>12</b> Эмоциональная тональность</a>
<ul>
<li class="chapter" data-level="12.1" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#анализ-тональности"><i class="fa fa-check"></i><b>12.1</b> Анализ тональности</a></li>
<li class="chapter" data-level="12.2" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#подходы"><i class="fa fa-check"></i><b>12.2</b> Подходы</a></li>
<li class="chapter" data-level="12.3" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#тезаурусы"><i class="fa fa-check"></i><b>12.3</b> Тезаурусы</a></li>
<li class="chapter" data-level="12.4" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#лексиконы-для-русского-языка"><i class="fa fa-check"></i><b>12.4</b> Лексиконы для русского языка</a></li>
<li class="chapter" data-level="12.5" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#анализ-тональности-с-tidy-data"><i class="fa fa-check"></i><b>12.5</b> Анализ тональности с Tidy Data</a></li>
<li class="chapter" data-level="12.6" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#подготовка-текста"><i class="fa fa-check"></i><b>12.6</b> Подготовка текста</a></li>
<li class="chapter" data-level="12.7" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#модификация-лексикона"><i class="fa fa-check"></i><b>12.7</b> Модификация лексикона</a></li>
<li class="chapter" data-level="12.8" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#соединение-лексикона-и-текста"><i class="fa fa-check"></i><b>12.8</b> Соединение лексикона и текста</a></li>
<li class="chapter" data-level="12.9" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#тональность-на-оси-времени"><i class="fa fa-check"></i><b>12.9</b> Тональность на оси времени</a></li>
<li class="chapter" data-level="12.10" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#для-других-языков"><i class="fa fa-check"></i><b>12.10</b> Для других языков</a></li>
<li class="chapter" data-level="12.11" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#виды-эмоций"><i class="fa fa-check"></i><b>12.11</b> Виды эмоций</a></li>
<li class="chapter" data-level="12.12" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#sentimentr"><i class="fa fa-check"></i><b>12.12</b> Sentimentr</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html"><i class="fa fa-check"></i><b>13</b> Тематическое моделирование</a>
<ul>
<li class="chapter" data-level="13.1" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#что-такое-lda"><i class="fa fa-check"></i><b>13.1</b> Что такое LDA</a></li>
<li class="chapter" data-level="13.2" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#распределение-дирихле"><i class="fa fa-check"></i><b>13.2</b> Распределение Дирихле</a></li>
<li class="chapter" data-level="13.3" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#подтоговка-данных"><i class="fa fa-check"></i><b>13.3</b> Подтоговка данных</a></li>
<li class="chapter" data-level="13.4" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#матрица-встречаемости"><i class="fa fa-check"></i><b>13.4</b> Матрица встречаемости</a></li>
<li class="chapter" data-level="13.5" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#число-тем"><i class="fa fa-check"></i><b>13.5</b> Число тем</a></li>
<li class="chapter" data-level="13.6" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#модель-lda"><i class="fa fa-check"></i><b>13.6</b> Модель LDA</a></li>
<li class="chapter" data-level="13.7" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#слова-и-темы"><i class="fa fa-check"></i><b>13.7</b> Слова и темы</a></li>
<li class="chapter" data-level="13.8" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#сравнение-топиков"><i class="fa fa-check"></i><b>13.8</b> Сравнение топиков</a></li>
<li class="chapter" data-level="13.9" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#темы-и-документы"><i class="fa fa-check"></i><b>13.9</b> Темы и документы</a></li>
<li class="chapter" data-level="13.10" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#распределения-вероятности-для-топиков"><i class="fa fa-check"></i><b>13.10</b> Распределения вероятности для топиков</a></li>
<li class="chapter" data-level="13.11" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#интерактивные-визуализации"><i class="fa fa-check"></i><b>13.11</b> Интерактивные визуализации</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html"><i class="fa fa-check"></i><b>14</b> Латентно-семантический анализ</a>
<ul>
<li class="chapter" data-level="14.1" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#что-это-такое"><i class="fa fa-check"></i><b>14.1</b> Что это такое</a></li>
<li class="chapter" data-level="14.2" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#векторное-представление-слов"><i class="fa fa-check"></i><b>14.2</b> Векторное представление слов</a></li>
<li class="chapter" data-level="14.3" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#сингулярное-разложение-матрицы"><i class="fa fa-check"></i><b>14.3</b> Сингулярное разложение матрицы</a></li>
<li class="chapter" data-level="14.4" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#простой-пример"><i class="fa fa-check"></i><b>14.4</b> Простой пример</a></li>
<li class="chapter" data-level="14.5" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#векторы-слов"><i class="fa fa-check"></i><b>14.5</b> Векторы слов</a></li>
<li class="chapter" data-level="14.6" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#пакеты-для-работы-с-lsa"><i class="fa fa-check"></i><b>14.6</b> Пакеты для работы с LSA</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#lsa"><i class="fa fa-check"></i><b>14.6.1</b> lsa</a></li>
<li class="chapter" data-level="14.6.2" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#textminer"><i class="fa fa-check"></i><b>14.6.2</b> TextmineR</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="латентно-семантический-анализ.html"><a href="латентно-семантический-анализ.html#lsa-c-использованием-tidy-data"><i class="fa fa-check"></i><b>14.7</b> LSA c использованием Tidy Data</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html"><i class="fa fa-check"></i><b>15</b> Кластеризация и метод главных компонент</a>
<ul>
<li class="chapter" data-level="15.1" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#виды-кластерного-анализа"><i class="fa fa-check"></i><b>15.1</b> Виды кластерного анализа</a></li>
<li class="chapter" data-level="15.2" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#кластеризация-по-методу-k-средних"><i class="fa fa-check"></i><b>15.2</b> Кластеризация по методу K средних</a></li>
<li class="chapter" data-level="15.3" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#k-means-в-r"><i class="fa fa-check"></i><b>15.3</b> K-means в R</a></li>
<li class="chapter" data-level="15.4" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#k-means-для-кластеризации-текстов"><i class="fa fa-check"></i><b>15.4</b> K-means для кластеризации текстов</a></li>
<li class="chapter" data-level="15.5" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#нормализация-данных"><i class="fa fa-check"></i><b>15.5</b> Нормализация данных</a></li>
<li class="chapter" data-level="15.6" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#иерархическая-кластеризация"><i class="fa fa-check"></i><b>15.6</b> Иерархическая кластеризация</a></li>
<li class="chapter" data-level="15.7" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#алгоритм-иерархической-кластеризации"><i class="fa fa-check"></i><b>15.7</b> Алгоритм иерархической кластеризации</a></li>
<li class="chapter" data-level="15.8" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#иерархическая-кластеризация-в-r"><i class="fa fa-check"></i><b>15.8</b> Иерархическая кластеризация в R</a></li>
<li class="chapter" data-level="15.9" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#иерархическая-кластеризация-текстов"><i class="fa fa-check"></i><b>15.9</b> Иерархическая кластеризация текстов</a></li>
<li class="chapter" data-level="15.10" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#метод-главных-компонент"><i class="fa fa-check"></i><b>15.10</b> Метод главных компонент</a></li>
<li class="chapter" data-level="15.11" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#pca-для-визуализации-кластеров-k-means"><i class="fa fa-check"></i><b>15.11</b> PCA для визуализации кластеров K-means</a></li>
<li class="chapter" data-level="15.12" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#pca-и-иерархическая-кластеризация"><i class="fa fa-check"></i><b>15.12</b> PCA и иерархическая кластеризация</a></li>
<li class="chapter" data-level="15.13" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#многомерное-шкалирование"><i class="fa fa-check"></i><b>15.13</b> Многомерное шкалирование</a></li>
<li class="chapter" data-level="15.14" data-path="кластеризация-и-метод-главных-компонент.html"><a href="кластеризация-и-метод-главных-компонент.html#pca-с-factominer"><i class="fa fa-check"></i><b>15.14</b> PCA с FactoMineR</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html"><i class="fa fa-check"></i><b>16</b> Сетевые данные и графы</a>
<ul>
<li class="chapter" data-level="16.1" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#базовое-описание"><i class="fa fa-check"></i><b>16.1</b> Базовое описание</a></li>
<li class="chapter" data-level="16.2" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#создание-сетевых-данных"><i class="fa fa-check"></i><b>16.2</b> Создание сетевых данных</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#социоматрица"><i class="fa fa-check"></i><b>16.2.1</b> Социоматрица</a></li>
<li class="chapter" data-level="16.2.2" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#список-ребер"><i class="fa fa-check"></i><b>16.2.2</b> Список ребер</a></li>
<li class="chapter" data-level="16.2.3" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#формула"><i class="fa fa-check"></i><b>16.2.3</b> Формула</a></li>
<li class="chapter" data-level="16.2.4" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#импорт-данных"><i class="fa fa-check"></i><b>16.2.4</b> Импорт данных</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#атрибуты-вершин-узлов"><i class="fa fa-check"></i><b>16.3</b> Атрибуты вершин (узлов)</a></li>
<li class="chapter" data-level="16.4" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#фильтрация-по-узлу"><i class="fa fa-check"></i><b>16.4</b> Фильтрация по узлу</a></li>
<li class="chapter" data-level="16.5" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#атрибуты-ребер"><i class="fa fa-check"></i><b>16.5</b> Атрибуты ребер</a></li>
<li class="chapter" data-level="16.6" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#импорт-из-gexf"><i class="fa fa-check"></i><b>16.6</b> Импорт из gexf</a></li>
<li class="chapter" data-level="16.7" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#визуализация-с-ggraph"><i class="fa fa-check"></i><b>16.7</b> Визуализация с ggraph</a></li>
<li class="chapter" data-level="16.8" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#фильтрация-по-атрибутам-ребер"><i class="fa fa-check"></i><b>16.8</b> Фильтрация по атрибутам ребер</a></li>
<li class="chapter" data-level="16.9" data-path="сетевые-данные-и-графы.html"><a href="сетевые-данные-и-графы.html#укладка-сети"><i class="fa fa-check"></i><b>16.9</b> Укладка сети</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="анализ-сетей.html"><a href="анализ-сетей.html"><i class="fa fa-check"></i><b>17</b> Анализ сетей</a>
<ul>
<li class="chapter" data-level="17.1" data-path="анализ-сетей.html"><a href="анализ-сетей.html#от-conllu-к-совместной-встречаемости"><i class="fa fa-check"></i><b>17.1</b> От conllu к совместной встречаемости</a></li>
<li class="chapter" data-level="17.2" data-path="анализ-сетей.html"><a href="анализ-сетей.html#граф-слов-с-igraph"><i class="fa fa-check"></i><b>17.2</b> Граф слов с igraph</a></li>
<li class="chapter" data-level="17.3" data-path="анализ-сетей.html"><a href="анализ-сетей.html#важность-узлов"><i class="fa fa-check"></i><b>17.3</b> Важность узлов</a></li>
<li class="chapter" data-level="17.4" data-path="анализ-сетей.html"><a href="анализ-сетей.html#централизация"><i class="fa fa-check"></i><b>17.4</b> Централизация</a></li>
<li class="chapter" data-level="17.5" data-path="анализ-сетей.html"><a href="анализ-сетей.html#центральность-на-графике"><i class="fa fa-check"></i><b>17.5</b> Центральность на графике</a></li>
<li class="chapter" data-level="17.6" data-path="анализ-сетей.html"><a href="анализ-сетей.html#интерактивный-граф"><i class="fa fa-check"></i><b>17.6</b> Интерактивный граф</a></li>
<li class="chapter" data-level="17.7" data-path="анализ-сетей.html"><a href="анализ-сетей.html#точки-сочленения"><i class="fa fa-check"></i><b>17.7</b> Точки сочленения</a></li>
<li class="chapter" data-level="17.8" data-path="анализ-сетей.html"><a href="анализ-сетей.html#подгруппы"><i class="fa fa-check"></i><b>17.8</b> Подгруппы</a>
<ul>
<li class="chapter" data-level="17.8.1" data-path="анализ-сетей.html"><a href="анализ-сетей.html#клики"><i class="fa fa-check"></i><b>17.8.1</b> Клики</a></li>
<li class="chapter" data-level="17.8.2" data-path="анализ-сетей.html"><a href="анализ-сетей.html#k-ядра"><i class="fa fa-check"></i><b>17.8.2</b> K-ядра</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="dracor.html"><a href="dracor.html"><i class="fa fa-check"></i><b>18</b> Dracor</a>
<ul>
<li class="chapter" data-level="18.1" data-path="dracor.html"><a href="dracor.html#о-корпусе-dracor"><i class="fa fa-check"></i><b>18.1</b> О корпусе Dracor</a></li>
<li class="chapter" data-level="18.2" data-path="dracor.html"><a href="dracor.html#начало-работы-с-dracor"><i class="fa fa-check"></i><b>18.2</b> Начало работы с Dracor</a></li>
<li class="chapter" data-level="18.3" data-path="dracor.html"><a href="dracor.html#сети-dracor"><i class="fa fa-check"></i><b>18.3</b> Сети Dracor</a></li>
<li class="chapter" data-level="18.4" data-path="dracor.html"><a href="dracor.html#модулярность"><i class="fa fa-check"></i><b>18.4</b> Модулярность</a></li>
<li class="chapter" data-level="18.5" data-path="dracor.html"><a href="dracor.html#алгоритмы-обнаружения-сообществ"><i class="fa fa-check"></i><b>18.5</b> Алгоритмы обнаружения сообществ</a></li>
<li class="chapter" data-level="18.6" data-path="dracor.html"><a href="dracor.html#двудольные-графы-биграфы"><i class="fa fa-check"></i><b>18.6</b> Двудольные графы (биграфы)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="литература.html"><a href="литература.html"><i class="fa fa-check"></i>Литература</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Компьютерный анализ текста в R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="веб-скрапинг" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Тема 9</span> Веб-скрапинг<a href="веб-скрапинг.html#веб-скрапинг" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Выше мы говорили о таком импорте html, когда все теги разом удаляются. Это не всегда удобно, поскольку файл хранит данные в структурированном виде, например, под разными тегами дату, автора и текст. И может быть желательно эту структуру сохранить.</p>
<p>В R это позволяет делать пакет <code>rvest</code>. С его помощью мы подготовим для дальнейшего построения тематической модели архив телеграм-канала Antibarbari HSE. Канал публичный, и Telegram дает возможность скачать архив в формате html при помощи кнопки export (однако эта функция может быть недоступна на MacOS).</p>
<p>Эта глава опирается в основом на <a href="https://r4ds.hadley.nz/webscraping.html">второе издание</a> книги R for Data Science Хадли Викхема.</p>
<div id="структура-html" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Структура html<a href="веб-скрапинг.html#структура-html" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Документы html (HyperText Markup Language) имеют ирархическую структуру, состоящую из <strong>элементов</strong>. В каждом элементе есть <strong>открывающий тег</strong> (&lt;tag&gt;), опциональные <strong>атрибуты</strong> (id='first') и <strong>закрывающий тег</strong> (&lt;/tag&gt;). Все, что находится между открывающим и закрывающим тегом, называется <strong>содержанием</strong> элемента.</p>
<p>Важнейшие теги, о которых стоит знать:</p>
<ul>
<li>&lt;html&gt; (есть всегда), с двумя детьми (дочерними элементами): &lt;head&gt; и &lt;body&gt;</li>
<li>элементы, отвечающие за структуру: &lt;h1&gt; (заголовок), &lt;section&gt;, &lt;p&gt; (параграф), &lt;ol&gt; (упорядоченный список)</li>
<li>элементы, отвечающие за оформление: &lt;b&gt; (bold), &lt;i&gt; (italics), &lt;a&gt; (ссылка)</li>
</ul>
<p>Чтобы увидеть структуру веб-страницы, надо нажать правую кнопку мыши и выбрать View Source (это работает и для тех html, которые хранятся у вас на компьютере).</p>
</div>
<div id="каскадные-таблицы-стилей" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Каскадные таблицы стилей<a href="веб-скрапинг.html#каскадные-таблицы-стилей" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>У тегов могут быть именованные атрибуты; важнейшие из них – это id и class, которые в сочетании с CSS контролируют внешний вид страницы.</p>
<div class="infobox">
<p>CSS (англ. Cascading Style Sheets «каскадные таблицы стилей») — формальный язык декорирования и описания внешнего вида документа (веб-страницы), написанного с использованием языка разметки (чаще всего HTML или XHTML).</p>
</div>
<p>У этого курса тоже есть свой файл .css, в котором блок infobox (вы его видите как серый квадратик с определением) описан так:</p>
<pre><code>.infobox {
  padding: 1em 1em 1em 4em;
  background: aliceblue 5px center/3em no-repeat;
  color: black;
}</code></pre>
<p>Проще говоря, это инструкция, что делать с тем или иным элементом. Каждое правило CSS имеет две основные части — <strong>селектор</strong> и <strong>блок объявлений</strong>. Селектор, расположенный в левой части правила до знака «{», определяет, на какие части документа (возможно, специально обозначенные) распространяется правило. Блок объявлений располагается в правой части правила. Он помещается в фигурные скобки, и, в свою очередь, состоит из одного или более объявлений, разделённых знаком «;».</p>
<p>Селекторы CSS полезны для скрапинга, потому что они помогают вычленить необходимые элементы. Это работает так:</p>
<ul>
<li>p выберет все элементы &lt;p&gt;</li>
<li>.title выберет элементы с классом “title”</li>
<li>#title выберет все элементы с атрибутом id=‘title’</li>
</ul>
<p>Важно: если изменится структура страницы, откуда вы скрапили информацию, то и код, возможно, придется переписывать.</p>
</div>
<div id="извлечение-данных" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Извлечение данных<a href="веб-скрапинг.html#извлечение-данных" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Чтобы прочесть файл html, используем одноименную функцию.</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="веб-скрапинг.html#cb562-1" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb562-2"><a href="веб-скрапинг.html#cb562-2" tabindex="-1"></a>messages <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;./files/antibarbari_archive/messages.html&quot;</span>)</span>
<span id="cb562-3"><a href="веб-скрапинг.html#cb562-3" tabindex="-1"></a>messages2 <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;./files/antibarbari_archive/messages2.html&quot;</span>)</span>
<span id="cb562-4"><a href="веб-скрапинг.html#cb562-4" tabindex="-1"></a></span>
<span id="cb562-5"><a href="веб-скрапинг.html#cb562-5" tabindex="-1"></a>messages</span></code></pre></div>
<pre><code>## {html_document}
## &lt;html&gt;
## [1] &lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text ...
## [2] &lt;body onload=&quot;CheckLocation();&quot;&gt;\n\n  &lt;div class=&quot;pag ...</code></pre>
<p>На следующем этапе важно понять, какие именно элементы нужны. Рассмотрим на примере одного сообщения. Для примера я сохраню этот элемент как небольшой отдельный html; <code>rvest</code> позволяет это сделать (но внутри двойных кавычек должны быть только одинарные):</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="веб-скрапинг.html#cb564-1" tabindex="-1"></a>html <span class="ot">&lt;-</span>  <span class="fu">minimal_html</span>(<span class="st">&quot;</span></span>
<span id="cb564-2"><a href="веб-скрапинг.html#cb564-2" tabindex="-1"></a><span class="st">&lt;div class=&#39;message default clearfix&#39; id=&#39;message83&#39;&gt;</span></span>
<span id="cb564-3"><a href="веб-скрапинг.html#cb564-3" tabindex="-1"></a><span class="st">      &lt;div class=&#39;pull_left userpic_wrap&#39;&gt;</span></span>
<span id="cb564-4"><a href="веб-скрапинг.html#cb564-4" tabindex="-1"></a><span class="st">       &lt;div class=&#39;userpic userpic2&#39; style=&#39;width: 42px; height: 42px&#39;&gt;</span></span>
<span id="cb564-5"><a href="веб-скрапинг.html#cb564-5" tabindex="-1"></a><span class="st">        &lt;div class=&#39;initials&#39; style=&#39;line-height: 42px&#39;&gt;</span></span>
<span id="cb564-6"><a href="веб-скрапинг.html#cb564-6" tabindex="-1"></a><span class="st">A</span></span>
<span id="cb564-7"><a href="веб-скрапинг.html#cb564-7" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb564-8"><a href="веб-скрапинг.html#cb564-8" tabindex="-1"></a><span class="st">       &lt;/div&gt;</span></span>
<span id="cb564-9"><a href="веб-скрапинг.html#cb564-9" tabindex="-1"></a><span class="st">      &lt;/div&gt;</span></span>
<span id="cb564-10"><a href="веб-скрапинг.html#cb564-10" tabindex="-1"></a><span class="st">      &lt;div class=&#39;body&#39;&gt;</span></span>
<span id="cb564-11"><a href="веб-скрапинг.html#cb564-11" tabindex="-1"></a><span class="st">       &lt;div class=&#39;pull_right date details&#39; title=&#39;19.05.2022 11:18:07 UTC+03:00&#39;&gt;</span></span>
<span id="cb564-12"><a href="веб-скрапинг.html#cb564-12" tabindex="-1"></a><span class="st">11:18</span></span>
<span id="cb564-13"><a href="веб-скрапинг.html#cb564-13" tabindex="-1"></a><span class="st">       &lt;/div&gt;</span></span>
<span id="cb564-14"><a href="веб-скрапинг.html#cb564-14" tabindex="-1"></a><span class="st">       &lt;div class=&#39;from_name&#39;&gt;</span></span>
<span id="cb564-15"><a href="веб-скрапинг.html#cb564-15" tabindex="-1"></a><span class="st">Antibarbari HSE </span></span>
<span id="cb564-16"><a href="веб-скрапинг.html#cb564-16" tabindex="-1"></a><span class="st">       &lt;/div&gt;</span></span>
<span id="cb564-17"><a href="веб-скрапинг.html#cb564-17" tabindex="-1"></a><span class="st">       &lt;div class=&#39;text&#39;&gt;</span></span>
<span id="cb564-18"><a href="веб-скрапинг.html#cb564-18" tabindex="-1"></a><span class="st">Этот пост открывает серию переложений из «Дайджеста платоновских идиом» Джеймса Ридделла (1823–1866), английского филолога-классика, чей научный путь был связан с Оксфордским университетом. По приглашению Бенджамина Джоветта он должен был подготовить к изданию «Апологию», «Критон», «Федон» и «Пир». Однако из этих четырех текстов вышла лишь «Апология» с предисловием и приложением в виде «Дайджеста» (ссылка) — уже после смерти автора. &lt;br&gt;&lt;br&gt;«Дайджест» содержит 326 параграфов, посвященных грамматическим, синтаксическим и риторическим особенностям языка Платона. Знакомство с этим теоретическим материалом позволяет лучше почувствовать уникальный стиль философа и добиться большей точности при переводе. Ссылки на «Дайджест» могут быть уместны и в учебных комментариях к диалогам Платона. Предлагаемая здесь первая часть «Дайджеста» содержит «идиомы имен» и «идиомы артикля» (§§ 1–39).&lt;br&gt;&lt;a href=&#39;http://antibarbari.ru/2022/05/19/digest_1/&#39;&gt;http://antibarbari.ru/2022/05/19/digest_1/&lt;/a&gt;</span></span>
<span id="cb564-19"><a href="веб-скрапинг.html#cb564-19" tabindex="-1"></a><span class="st">       &lt;/div&gt;</span></span>
<span id="cb564-20"><a href="веб-скрапинг.html#cb564-20" tabindex="-1"></a><span class="st">       &lt;div class=&#39;signature details&#39;&gt;</span></span>
<span id="cb564-21"><a href="веб-скрапинг.html#cb564-21" tabindex="-1"></a><span class="st">Olga Alieva</span></span>
<span id="cb564-22"><a href="веб-скрапинг.html#cb564-22" tabindex="-1"></a><span class="st">       &lt;/div&gt;</span></span>
<span id="cb564-23"><a href="веб-скрапинг.html#cb564-23" tabindex="-1"></a><span class="st">      &lt;/div&gt;</span></span>
<span id="cb564-24"><a href="веб-скрапинг.html#cb564-24" tabindex="-1"></a><span class="st">     &lt;/div&gt;</span></span>
<span id="cb564-25"><a href="веб-скрапинг.html#cb564-25" tabindex="-1"></a><span class="st">&quot;</span>)</span></code></pre></div>
<p>Из всего этого мне может быть интересно id сообщения (&lt;div class=‘message default clearfix’ id=‘message83’&gt;), текст сообщения (&lt;div class=‘text’&gt;), а также, если указан, автор сообщения (&lt;div class=‘signature details’&gt;). Извлекаем текст (для этого <a href="https://r4ds.hadley.nz/webscraping.html#fn6">рекомендуется</a> использовать функцию <code>html_text2()</code>):</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="веб-скрапинг.html#cb565-1" tabindex="-1"></a>html <span class="sc">%&gt;%</span></span>
<span id="cb565-2"><a href="веб-скрапинг.html#cb565-2" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">&quot;.text&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb565-3"><a href="веб-скрапинг.html#cb565-3" tabindex="-1"></a>  <span class="fu">html_text2</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Этот пост открывает серию переложений из «Дайджеста платоновских идиом» Джеймса Ридделла (1823–1866), английского филолога-классика, чей научный путь был связан с Оксфордским университетом. По приглашению Бенджамина Джоветта он должен был подготовить к изданию «Апологию», «Критон», «Федон» и «Пир». Однако из этих четырех текстов вышла лишь «Апология» с предисловием и приложением в виде «Дайджеста» (ссылка) — уже после смерти автора.\n\n«Дайджест» содержит 326 параграфов, посвященных грамматическим, синтаксическим и риторическим особенностям языка Платона. Знакомство с этим теоретическим материалом позволяет лучше почувствовать уникальный стиль философа и добиться большей точности при переводе. Ссылки на «Дайджест» могут быть уместны и в учебных комментариях к диалогам Платона. Предлагаемая здесь первая часть «Дайджеста» содержит «идиомы имен» и «идиомы артикля» (§§ 1–39).\nhttp://antibarbari.ru/2022/05/19/digest_1/&quot;</code></pre>
<p>В классе signature details есть пробел, достаточно на его месте поставить точку:</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="веб-скрапинг.html#cb567-1" tabindex="-1"></a>html <span class="sc">%&gt;%</span></span>
<span id="cb567-2"><a href="веб-скрапинг.html#cb567-2" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">&quot;.signature.details&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb567-3"><a href="веб-скрапинг.html#cb567-3" tabindex="-1"></a>  <span class="fu">html_text2</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Olga Alieva&quot;</code></pre>
<p>Важно помнить, что <code>html_element</code> всегда возвращает один элемент. Если их больше, надо использовать <code>html_elements</code>.</p>
<p>Осталось добыть message id:</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="веб-скрапинг.html#cb569-1" tabindex="-1"></a>html <span class="sc">%&gt;%</span></span>
<span id="cb569-2"><a href="веб-скрапинг.html#cb569-2" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">&quot;div&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb569-3"><a href="веб-скрапинг.html#cb569-3" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;message83&quot;</code></pre>
</div>
<div id="извлечение-в-тиббл" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Извлечение в тиббл<a href="веб-скрапинг.html#извлечение-в-тиббл" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="веб-скрапинг.html#cb571-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb571-2"><a href="веб-скрапинг.html#cb571-2" tabindex="-1"></a></span>
<span id="cb571-3"><a href="веб-скрапинг.html#cb571-3" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">id =</span> html <span class="sc">%&gt;%</span> </span>
<span id="cb571-4"><a href="веб-скрапинг.html#cb571-4" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;div&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb571-5"><a href="веб-скрапинг.html#cb571-5" tabindex="-1"></a>         <span class="fu">html_attr</span>(<span class="st">&quot;id&quot;</span>),</span>
<span id="cb571-6"><a href="веб-скрапинг.html#cb571-6" tabindex="-1"></a>       <span class="at">signature =</span> html <span class="sc">%&gt;%</span></span>
<span id="cb571-7"><a href="веб-скрапинг.html#cb571-7" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.signature.details&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb571-8"><a href="веб-скрапинг.html#cb571-8" tabindex="-1"></a>         <span class="fu">html_text2</span>(),</span>
<span id="cb571-9"><a href="веб-скрапинг.html#cb571-9" tabindex="-1"></a>       <span class="at">text =</span> html <span class="sc">%&gt;%</span> </span>
<span id="cb571-10"><a href="веб-скрапинг.html#cb571-10" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.text&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb571-11"><a href="веб-скрапинг.html#cb571-11" tabindex="-1"></a>         <span class="fu">html_text2</span>()</span>
<span id="cb571-12"><a href="веб-скрапинг.html#cb571-12" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   id        signature   text                                
##   &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;                               
## 1 message83 Olga Alieva &quot;Этот пост открывает серию переложе…</code></pre>
</div>
<div id="скрапим-телеграм-канал" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Скрапим телеграм-канал<a href="веб-скрапинг.html#скрапим-телеграм-канал" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>До сих пор наша задача упрощалась тем, что мы имели дело с игрушечным html для единственного сообщения. В настоящем html тег div повторяется на разных уровнях, нам надо извлечь только такие div, которым соответствует определенный класс:</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="веб-скрапинг.html#cb573-1" tabindex="-1"></a>messages <span class="sc">%&gt;%</span></span>
<span id="cb573-2"><a href="веб-скрапинг.html#cb573-2" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb573-3"><a href="веб-скрапинг.html#cb573-3" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## {xml_nodeset (6)}
## [1] &lt;div class=&quot;message default clearfix&quot; id=&quot;message3&quot;&gt;\ ...
## [2] &lt;div class=&quot;message default clearfix&quot; id=&quot;message5&quot;&gt;\ ...
## [3] &lt;div class=&quot;message default clearfix&quot; id=&quot;message6&quot;&gt;\ ...
## [4] &lt;div class=&quot;message default clearfix&quot; id=&quot;message7&quot;&gt;\ ...
## [5] &lt;div class=&quot;message default clearfix&quot; id=&quot;message8&quot;&gt;\ ...
## [6] &lt;div class=&quot;message default clearfix&quot; id=&quot;message9&quot;&gt;\ ...</code></pre>
<p>Уже из этого списка можем доставать все остальное.</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="веб-скрапинг.html#cb575-1" tabindex="-1"></a>messages_tbl1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> messages <span class="sc">%&gt;%</span> </span>
<span id="cb575-2"><a href="веб-скрапинг.html#cb575-2" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb575-3"><a href="веб-скрапинг.html#cb575-3" tabindex="-1"></a>         <span class="fu">html_attr</span>(<span class="st">&quot;id&quot;</span>),</span>
<span id="cb575-4"><a href="веб-скрапинг.html#cb575-4" tabindex="-1"></a>       <span class="at">signature =</span> messages <span class="sc">%&gt;%</span></span>
<span id="cb575-5"><a href="веб-скрапинг.html#cb575-5" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb575-6"><a href="веб-скрапинг.html#cb575-6" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.signature.details&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb575-7"><a href="веб-скрапинг.html#cb575-7" tabindex="-1"></a>         <span class="fu">html_text2</span>(),</span>
<span id="cb575-8"><a href="веб-скрапинг.html#cb575-8" tabindex="-1"></a>       <span class="at">text =</span> messages <span class="sc">%&gt;%</span> </span>
<span id="cb575-9"><a href="веб-скрапинг.html#cb575-9" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb575-10"><a href="веб-скрапинг.html#cb575-10" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.text&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb575-11"><a href="веб-скрапинг.html#cb575-11" tabindex="-1"></a>         <span class="fu">html_text2</span>()</span>
<span id="cb575-12"><a href="веб-скрапинг.html#cb575-12" tabindex="-1"></a>)</span>
<span id="cb575-13"><a href="веб-скрапинг.html#cb575-13" tabindex="-1"></a></span>
<span id="cb575-14"><a href="веб-скрапинг.html#cb575-14" tabindex="-1"></a>messages_tbl2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> messages2 <span class="sc">%&gt;%</span> </span>
<span id="cb575-15"><a href="веб-скрапинг.html#cb575-15" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb575-16"><a href="веб-скрапинг.html#cb575-16" tabindex="-1"></a>         <span class="fu">html_attr</span>(<span class="st">&quot;id&quot;</span>),</span>
<span id="cb575-17"><a href="веб-скрапинг.html#cb575-17" tabindex="-1"></a>       <span class="at">signature =</span> messages2 <span class="sc">%&gt;%</span></span>
<span id="cb575-18"><a href="веб-скрапинг.html#cb575-18" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb575-19"><a href="веб-скрапинг.html#cb575-19" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.signature.details&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb575-20"><a href="веб-скрапинг.html#cb575-20" tabindex="-1"></a>         <span class="fu">html_text2</span>(),</span>
<span id="cb575-21"><a href="веб-скрапинг.html#cb575-21" tabindex="-1"></a>       <span class="at">text =</span> messages2 <span class="sc">%&gt;%</span> </span>
<span id="cb575-22"><a href="веб-скрапинг.html#cb575-22" tabindex="-1"></a>         <span class="fu">html_elements</span>(<span class="st">&quot;div.message.default&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb575-23"><a href="веб-скрапинг.html#cb575-23" tabindex="-1"></a>         <span class="fu">html_element</span>(<span class="st">&quot;.text&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb575-24"><a href="веб-скрапинг.html#cb575-24" tabindex="-1"></a>         <span class="fu">html_text2</span>()</span>
<span id="cb575-25"><a href="веб-скрапинг.html#cb575-25" tabindex="-1"></a>)</span></code></pre></div>
<p>Обратите внимание, что мы сначала извлекаем нужные элементы при помощи <code>html_elements()</code>, а потом применяем к каждому из них <code>html_element()</code>. Это гарантирует, что в каждом столбце нашей таблицы равное число наблюдений, т.к. функция <code>html_element()</code>, если она не может найти, например, подпись, возвращает NA.</p>
<p>Сшиваем воедино два тиббла.</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="веб-скрапинг.html#cb576-1" tabindex="-1"></a>messages_tbl <span class="ot">&lt;-</span> messages_tbl1 <span class="sc">%&gt;%</span> </span>
<span id="cb576-2"><a href="веб-скрапинг.html#cb576-2" tabindex="-1"></a>  <span class="fu">bind_rows</span>(messages_tbl2)</span>
<span id="cb576-3"><a href="веб-скрапинг.html#cb576-3" tabindex="-1"></a></span>
<span id="cb576-4"><a href="веб-скрапинг.html#cb576-4" tabindex="-1"></a>messages_tbl</span></code></pre></div>
<pre><code>## # A tibble: 1,096 × 3
##    id        signature text                                 
##    &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                                
##  1 message3  &lt;NA&gt;      &quot;Latin never sleeps. Новое видео на …
##  2 message5  &lt;NA&gt;      &quot;Подборка видео семинара по медленно…
##  3 message6  &lt;NA&gt;      &quot;Новое видео в плейлисте \&quot;Латинский…
##  4 message7  &lt;NA&gt;      &quot;🤖 ОТКРЫТА ЗАПИСЬ НА ПРОЕКТ\n\nВ ра…
##  5 message8  &lt;NA&gt;      &quot;Желающие присоединиться к группе, ч…
##  6 message9  &lt;NA&gt;      &quot;https://youtu.be/I-U_lG0mB3M&quot;       
##  7 message10 &lt;NA&gt;      &quot;В клубе Antibarbari продолжается се…
##  8 message11 &lt;NA&gt;      &quot;Филеб. Семинар 3 марта 2022. Сократ…
##  9 message12 &lt;NA&gt;      &quot;Вышка вернулась в аудитории, поэтом…
## 10 message13 &lt;NA&gt;      &quot;Воспользовались дополнительным выхо…
## # ℹ 1,086 more rows</code></pre>
<p>Создатели канала не сразу разрешили подписывать посты, поэтому для первых нескольких десятков подписи не будет. В некоторых постах только фото, для них в столбце text – NA, их можно сразу отсеять.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="веб-скрапинг.html#cb578-1" tabindex="-1"></a>messages_tbl <span class="ot">&lt;-</span> messages_tbl <span class="sc">%&gt;%</span></span>
<span id="cb578-2"><a href="веб-скрапинг.html#cb578-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(text))</span></code></pre></div>
<p></br></p>
<div class="task code">
<p>Извлеките <a href="https://github.com/locusclassicus/text_analysis_2023/blob/main/files/antibarbari_archive/messages.html">из архива антиварваров</a> дату публикации для каждого поста.</p>
</div>
</div>
<div id="эмотиконы" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Эмотиконы<a href="веб-скрапинг.html#эмотиконы" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>В постах довольно много эмотиконов. Я их удалю, но сначала скажу о полезном пакете, который позволяет их все извлечь и, например, посчитать.</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="веб-скрапинг.html#cb579-1" tabindex="-1"></a><span class="fu">library</span>(emoji)</span>
<span id="cb579-2"><a href="веб-скрапинг.html#cb579-2" tabindex="-1"></a></span>
<span id="cb579-3"><a href="веб-скрапинг.html#cb579-3" tabindex="-1"></a>messages_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb579-4"><a href="веб-скрапинг.html#cb579-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">emoji =</span> <span class="fu">emoji_extract_all</span>(text)) <span class="sc">%&gt;%</span> </span>
<span id="cb579-5"><a href="веб-скрапинг.html#cb579-5" tabindex="-1"></a>  <span class="fu">pull</span>(emoji) <span class="sc">%&gt;%</span> </span>
<span id="cb579-6"><a href="веб-скрапинг.html#cb579-6" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb579-7"><a href="веб-скрапинг.html#cb579-7" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb579-8"><a href="веб-скрапинг.html#cb579-8" tabindex="-1"></a>  <span class="fu">count</span>(value) <span class="sc">%&gt;%</span> </span>
<span id="cb579-9"><a href="веб-скрапинг.html#cb579-9" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>n) </span></code></pre></div>
<pre><code>## # A tibble: 159 × 2
##    value     n
##    &lt;chr&gt; &lt;int&gt;
##  1 👾       68
##  2 ⭐       23
##  3 👀       21
##  4 👇       20
##  5 🍿       18
##  6 📚       16
##  7 🔼       12
##  8 1️⃣        10
##  9 📌       10
## 10 🔗       10
## # ℹ 149 more rows</code></pre>
<p>Заменяем их все на пробелы.</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="веб-скрапинг.html#cb581-1" tabindex="-1"></a>messages_tbl <span class="ot">&lt;-</span> messages_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb581-2"><a href="веб-скрапинг.html#cb581-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">emoji_replace_all</span>(text, <span class="st">&quot; &quot;</span>))</span></code></pre></div>
</div>
<div id="рутинная-уборка" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> Рутинная уборка<a href="веб-скрапинг.html#рутинная-уборка" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Подготовка текста для анализа включает в себя удаление сносок, иногда хэштегов, чисел, имейлов, возможно имен и т.п. В нашем случае ситуация осложняется тем, что тексты включают цитаты на латыни и древнегреческом, некоторые технические сокращения, номера страниц и др. Вот так, например, выглядит типичный пост:</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="веб-скрапинг.html#cb582-1" tabindex="-1"></a>example <span class="ot">&lt;-</span> messages_tbl<span class="sc">$</span>text[<span class="dv">340</span>]</span>
<span id="cb582-2"><a href="веб-скрапинг.html#cb582-2" tabindex="-1"></a></span>
<span id="cb582-3"><a href="веб-скрапинг.html#cb582-3" tabindex="-1"></a>example</span></code></pre></div>
<pre><code>## [1] &quot;🎞 Теэтет #10 149b7-150b8\nСократ продолжает засыпать семнадцатилетнего математика подробностями из области акушерства и гинекологии, и мы вместе с ним терпеливо изучаем, чем сводничество отличается от сватовства. Верните квадратные корни. #платон #теэтет\nhttps://vk.com/video-211800158_456239238&quot;</code></pre>
<p>Вот так вылавливается гиперссылка.</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="веб-скрапинг.html#cb584-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(example, <span class="st">&quot;(http|https)(</span><span class="sc">\\</span><span class="st">S+)&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;https://vk.com/video-211800158_456239238&quot;</code></pre>
<p>Вот так вылавливается пагинация и номер семинара (и некоторые другие числа).</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="веб-скрапинг.html#cb586-1" tabindex="-1"></a><span class="fu">str_extract_all</span>(example, <span class="st">&quot;#?</span><span class="sc">\\</span><span class="st">d{2,3}</span><span class="sc">\\</span><span class="st">w?</span><span class="sc">\\</span><span class="st">d?-?&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;#10&quot;    &quot;149b7-&quot; &quot;150b8&quot;  &quot;21180&quot;  &quot;0158&quot;   &quot;45623&quot; 
## [7] &quot;9238&quot;</code></pre>
<p>Похожим образом можно выловить даты, имейлы и т.п. Все это удаляем из текста.</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="веб-скрапинг.html#cb588-1" tabindex="-1"></a>messages_clean <span class="ot">&lt;-</span> messages_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb588-2"><a href="веб-скрапинг.html#cb588-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">str_replace_all</span>(text, <span class="st">&quot;(http|https)(</span><span class="sc">\\</span><span class="st">S+)&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb588-3"><a href="веб-скрапинг.html#cb588-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">str_replace_all</span>(text, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d{2}</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d{2}</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d{4}&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb588-4"><a href="веб-скрапинг.html#cb588-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">str_replace_all</span>(text, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">W[-A-Za-z0-9_.%]+</span><span class="sc">\\</span><span class="st">@[-A-Za-z0-9_.%]+</span><span class="sc">\\</span><span class="st">.[A-Za-z]&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb588-5"><a href="веб-скрапинг.html#cb588-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">str_replace_all</span>(text, <span class="st">&quot;#?</span><span class="sc">\\</span><span class="st">d{2,3}</span><span class="sc">\\</span><span class="st">w?</span><span class="sc">\\</span><span class="st">d?-?&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb588-6"><a href="веб-скрапинг.html#cb588-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">str_replace_all</span>(text, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n+&quot;</span>, <span class="st">&quot; &quot;</span>))</span></code></pre></div>
<p>Остались еще сокращения вроде “г.”, но токены из одной буквы можно будет удалить после разделения на слова. Знаки пунктуации можно оставить или убрать – иногда они бывают интересным стилистическим маркером. В любом случае лучше это делать после лемматизации, т.к. на тексте без знаков препинания анализатор покажет себя хуже.</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="веб-скрапинг.html#cb589-1" tabindex="-1"></a>messages_clean <span class="sc">%&gt;%</span> </span>
<span id="cb589-2"><a href="веб-скрапинг.html#cb589-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">340</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   id         signature   text                               
##   &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;                              
## 1 message465 Olga Alieva &quot;🎞 Теэтет      Сократ продолжает з…</code></pre>
<p>Число id и число текстов не совпадает, поскольку для некоторых постов текста нет (NA), а у других он совпадает (“Пост выходного дня”). Это надо сразу исправить, чтобы результат лемматизации можно было потом соединить с данными о подписи. Я просто уберу очень короткие посты, поскольку для анализа они неинтересны.</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="веб-скрапинг.html#cb591-1" tabindex="-1"></a>messages_clean <span class="ot">&lt;-</span> messages_clean <span class="sc">%&gt;%</span></span>
<span id="cb591-2"><a href="веб-скрапинг.html#cb591-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">nchar</span>(text) <span class="sc">&gt;</span> <span class="dv">19</span>)</span></code></pre></div>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="веб-скрапинг.html#cb592-1" tabindex="-1"></a><span class="fu">dim</span>(messages_clean)</span></code></pre></div>
<pre><code>## [1] 734   3</code></pre>
<p>Переименуем первый столбец и переназначим id, чтобы можно было потом соединить с результатами лемматизации.</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="веб-скрапинг.html#cb594-1" tabindex="-1"></a>messages_clean <span class="ot">&lt;-</span> messages_clean <span class="sc">%&gt;%</span> </span>
<span id="cb594-2"><a href="веб-скрапинг.html#cb594-2" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">doc_id =</span> id) <span class="sc">%&gt;%</span> </span>
<span id="cb594-3"><a href="веб-скрапинг.html#cb594-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">doc_id =</span> <span class="fu">paste0</span>(<span class="st">&quot;doc&quot;</span>, <span class="fu">row_number</span>()))</span></code></pre></div>
</div>
<div id="лемматизация" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Лемматизация<a href="веб-скрапинг.html#лемматизация" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>На лемматизацию мы отдаем вектор с сообщениями.</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="веб-скрапинг.html#cb595-1" tabindex="-1"></a><span class="fu">library</span>(udpipe)</span>
<span id="cb595-2"><a href="веб-скрапинг.html#cb595-2" tabindex="-1"></a>russian_syntagrus <span class="ot">&lt;-</span> <span class="fu">udpipe_load_model</span>(<span class="at">file =</span> <span class="st">&quot;russian-syntagrus-ud-2.5-191206.udpipe&quot;</span>)</span>
<span id="cb595-3"><a href="веб-скрапинг.html#cb595-3" tabindex="-1"></a></span>
<span id="cb595-4"><a href="веб-скрапинг.html#cb595-4" tabindex="-1"></a>messages_ann <span class="ot">&lt;-</span> <span class="fu">udpipe_annotate</span>(russian_syntagrus, messages_clean<span class="sc">$</span>text)</span>
<span id="cb595-5"><a href="веб-скрапинг.html#cb595-5" tabindex="-1"></a></span>
<span id="cb595-6"><a href="веб-скрапинг.html#cb595-6" tabindex="-1"></a>messages_ann <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(messages_ann)</span>
<span id="cb595-7"><a href="веб-скрапинг.html#cb595-7" tabindex="-1"></a></span>
<span id="cb595-8"><a href="веб-скрапинг.html#cb595-8" tabindex="-1"></a>messages_ann</span></code></pre></div>
<p>Убедимся, что после лемматизации число id не изменилось, и соединим этот тиббл с данными о подписи.</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="веб-скрапинг.html#cb596-1" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(messages_ann<span class="sc">$</span>doc_id))</span></code></pre></div>
<pre><code>## [1] 734</code></pre>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="веб-скрапинг.html#cb598-1" tabindex="-1"></a>messages_signed <span class="ot">&lt;-</span> messages_ann <span class="sc">%&gt;%</span> </span>
<span id="cb598-2"><a href="веб-скрапинг.html#cb598-2" tabindex="-1"></a>  <span class="fu">left_join</span>(messages_clean, <span class="at">by =</span> <span class="st">&quot;doc_id&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb598-3"><a href="веб-скрапинг.html#cb598-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>text, <span class="sc">-</span>sentence_id, <span class="sc">-</span>paragraph_id, <span class="sc">-</span>xpos, <span class="sc">-</span>feats,</span>
<span id="cb598-4"><a href="веб-скрапинг.html#cb598-4" tabindex="-1"></a>         <span class="sc">-</span>head_token_id, <span class="sc">-</span>dep_rel, <span class="sc">-</span>deps, <span class="sc">-</span>misc)</span>
<span id="cb598-5"><a href="веб-скрапинг.html#cb598-5" tabindex="-1"></a></span>
<span id="cb598-6"><a href="веб-скрапинг.html#cb598-6" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(messages_signed<span class="sc">$</span>doc_id))</span></code></pre></div>
<pre><code>## [1] 734</code></pre>
<p>В постах упоминаются многие коллеги и студенты, чьи имена я бы хотела удалить, чтобы они не появлялись на графиках и т.п., но есть и много древних и новых имен, которые хотелось бы оставить.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="веб-скрапинг.html#cb600-1" tabindex="-1"></a><span class="co"># valid_names &lt;- messages_ann %&gt;% </span></span>
<span id="cb600-2"><a href="веб-скрапинг.html#cb600-2" tabindex="-1"></a><span class="co">#   filter(upos == &quot;PROPN&quot;) %&gt;% </span></span>
<span id="cb600-3"><a href="веб-скрапинг.html#cb600-3" tabindex="-1"></a><span class="co">#   count(lemma) %&gt;% </span></span>
<span id="cb600-4"><a href="веб-скрапинг.html#cb600-4" tabindex="-1"></a><span class="co">#   arrange(-n) %&gt;% </span></span>
<span id="cb600-5"><a href="веб-скрапинг.html#cb600-5" tabindex="-1"></a><span class="co">#   filter(!str_detect(lemma, &quot;[\\.«]&quot;)) %&gt;% </span></span>
<span id="cb600-6"><a href="веб-скрапинг.html#cb600-6" tabindex="-1"></a><span class="co">#   filter(str_detect(lemma, &quot;[[\u0400-\u04FF]]&quot;)) %&gt;% </span></span>
<span id="cb600-7"><a href="веб-скрапинг.html#cb600-7" tabindex="-1"></a><span class="co">#   filter(n &gt; 1)</span></span>
<span id="cb600-8"><a href="веб-скрапинг.html#cb600-8" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb600-9"><a href="веб-скрапинг.html#cb600-9" tabindex="-1"></a><span class="co"># valid_names_vec &lt;- as.character(valid_names$lemma)</span></span>
<span id="cb600-10"><a href="веб-скрапинг.html#cb600-10" tabindex="-1"></a></span>
<span id="cb600-11"><a href="веб-скрапинг.html#cb600-11" tabindex="-1"></a><span class="co"># список имен отредактирован вручную</span></span>
<span id="cb600-12"><a href="веб-скрапинг.html#cb600-12" tabindex="-1"></a><span class="co"># write.table(valid_names_vec, file = &quot;files/names.txt&quot;, </span></span>
<span id="cb600-13"><a href="веб-скрапинг.html#cb600-13" tabindex="-1"></a><span class="co">#            row.names = F, col.names = F)</span></span></code></pre></div>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="веб-скрапинг.html#cb601-1" tabindex="-1"></a>valid_names <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="at">file =</span> <span class="st">&quot;files/names.txt&quot;</span>, <span class="at">col_names =</span> F)</span>
<span id="cb601-2"><a href="веб-скрапинг.html#cb601-2" tabindex="-1"></a></span>
<span id="cb601-3"><a href="веб-скрапинг.html#cb601-3" tabindex="-1"></a>valid_names <span class="ot">&lt;-</span> valid_names <span class="sc">%&gt;%</span> </span>
<span id="cb601-4"><a href="веб-скрапинг.html#cb601-4" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">names =</span> X1) <span class="sc">%&gt;%</span> </span>
<span id="cb601-5"><a href="веб-скрапинг.html#cb601-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">names =</span> <span class="fu">str_remove_all</span>(names, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">W&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb601-6"><a href="веб-скрапинг.html#cb601-6" tabindex="-1"></a>  <span class="fu">pull</span>(names)</span></code></pre></div>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="веб-скрапинг.html#cb602-1" tabindex="-1"></a>messages_signed <span class="ot">&lt;-</span> messages_signed <span class="sc">%&gt;%</span> </span>
<span id="cb602-2"><a href="веб-скрапинг.html#cb602-2" tabindex="-1"></a>  <span class="fu">filter</span>(upos <span class="sc">!=</span> <span class="st">&quot;PROPN&quot;</span> <span class="sc">|</span> upos <span class="sc">==</span> <span class="st">&quot;PROPN&quot;</span> <span class="sc">&amp;</span> lemma <span class="sc">%in%</span> valid_names) <span class="sc">%&gt;%</span> </span>
<span id="cb602-3"><a href="веб-скрапинг.html#cb602-3" tabindex="-1"></a>  <span class="fu">filter</span>(upos <span class="sc">!=</span> <span class="st">&quot;PUNCT&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb602-4"><a href="веб-скрапинг.html#cb602-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>upos <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;NUM&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb602-5"><a href="веб-скрапинг.html#cb602-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lemma =</span> <span class="fu">str_replace_all</span>(lemma, <span class="st">&quot;-&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb602-6"><a href="веб-скрапинг.html#cb602-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lemma =</span> <span class="fu">str_remove_all</span>(lemma, <span class="st">&quot;[[:punct:]]&quot;</span>))</span></code></pre></div>
<p>После некоторых сомнений, я удалю все, кроме кириллицы – на канале очень много латинского и греческого текста, на этапе создания термдокументной матрицы из-за этого будет почти 100% разреженность.</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="веб-скрапинг.html#cb603-1" tabindex="-1"></a>messages_signed <span class="ot">&lt;-</span> messages_signed <span class="sc">%&gt;%</span> </span>
<span id="cb603-2"><a href="веб-скрапинг.html#cb603-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lemma =</span> <span class="fu">str_replace_all</span>(lemma, <span class="st">&quot;[[^\u0400-\u04FF]]&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb603-3"><a href="веб-скрапинг.html#cb603-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">nchar</span>(lemma) <span class="sc">&gt;</span> <span class="dv">0</span>) </span></code></pre></div>
<p>Дальше были исправлены некоторые ошибки лемматизации.</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="веб-скрапинг.html#cb604-1" tabindex="-1"></a>text_tidy <span class="ot">&lt;-</span> messages_signed <span class="sc">%&gt;%</span></span>
<span id="cb604-2"><a href="веб-скрапинг.html#cb604-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lemma =</span> <span class="fu">tolower</span>(lemma)) <span class="sc">%&gt;%</span> </span>
<span id="cb604-3"><a href="веб-скрапинг.html#cb604-3" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(lemma), <span class="sc">~</span></span>
<span id="cb604-4"><a href="веб-скрапинг.html#cb604-4" tabindex="-1"></a>       <span class="fu">case_when</span>(lemma <span class="sc">==</span> <span class="st">&quot;мят&quot;</span> <span class="sc">~</span>  <span class="st">&quot;мята&quot;</span>,</span>
<span id="cb604-5"><a href="веб-скрапинг.html#cb604-5" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;сенек&quot;</span>) <span class="sc">~</span> <span class="st">&quot;сенека&quot;</span>,</span>
<span id="cb604-6"><a href="веб-скрапинг.html#cb604-6" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;аттик&quot;</span>) <span class="sc">~</span> <span class="st">&quot;аттик&quot;</span>,</span>
<span id="cb604-7"><a href="веб-скрапинг.html#cb604-7" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;кальвиз&quot;</span>) <span class="sc">~</span> <span class="st">&quot;кальвизий&quot;</span>,</span>
<span id="cb604-8"><a href="веб-скрапинг.html#cb604-8" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;горац&quot;</span>) <span class="sc">~</span> <span class="st">&quot;гораций&quot;</span>,</span>
<span id="cb604-9"><a href="веб-скрапинг.html#cb604-9" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;гален&quot;</span>) <span class="sc">~</span> <span class="st">&quot;гален&quot;</span>,</span>
<span id="cb604-10"><a href="веб-скрапинг.html#cb604-10" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;плотин&quot;</span>) <span class="sc">~</span> <span class="st">&quot;плотин&quot;</span>,</span>
<span id="cb604-11"><a href="веб-скрапинг.html#cb604-11" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;августин&quot;</span>) <span class="sc">~</span> <span class="st">&quot;августин&quot;</span>,</span>
<span id="cb604-12"><a href="веб-скрапинг.html#cb604-12" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;абари&quot;</span>) <span class="sc">~</span> <span class="st">&quot;абарид&quot;</span>,</span>
<span id="cb604-13"><a href="веб-скрапинг.html#cb604-13" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;катулл&quot;</span>) <span class="sc">~</span> <span class="st">&quot;катулл&quot;</span>,</span>
<span id="cb604-14"><a href="веб-скрапинг.html#cb604-14" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;лукул&quot;</span>) <span class="sc">~</span> <span class="st">&quot;лукулл&quot;</span>,</span>
<span id="cb604-15"><a href="веб-скрапинг.html#cb604-15" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;посидо&quot;</span>) <span class="sc">~</span> <span class="st">&quot;посидоний&quot;</span>,</span>
<span id="cb604-16"><a href="веб-скрапинг.html#cb604-16" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;деркилл&quot;</span>) <span class="sc">~</span> <span class="st">&quot;деркиллид&quot;</span>,</span>
<span id="cb604-17"><a href="веб-скрапинг.html#cb604-17" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;порфир&quot;</span>) <span class="sc">~</span> <span class="st">&quot;порфирий&quot;</span>,</span>
<span id="cb604-18"><a href="веб-скрапинг.html#cb604-18" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;афин&quot;</span>) <span class="sc">~</span> <span class="st">&quot;афины&quot;</span>,</span>
<span id="cb604-19"><a href="веб-скрапинг.html#cb604-19" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;локк&quot;</span>) <span class="sc">~</span> <span class="st">&quot;локк&quot;</span>,</span>
<span id="cb604-20"><a href="веб-скрапинг.html#cb604-20" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;макроб&quot;</span>) <span class="sc">~</span> <span class="st">&quot;макробий&quot;</span>,</span>
<span id="cb604-21"><a href="веб-скрапинг.html#cb604-21" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;лаэр&quot;</span>) <span class="sc">~</span> <span class="st">&quot;лаэрций&quot;</span>,</span>
<span id="cb604-22"><a href="веб-скрапинг.html#cb604-22" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;макрин&quot;</span>) <span class="sc">~</span> <span class="st">&quot;макрина&quot;</span>,</span>
<span id="cb604-23"><a href="веб-скрапинг.html#cb604-23" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;маркиш&quot;</span>) <span class="sc">~</span> <span class="st">&quot;маркиш&quot;</span>,</span>
<span id="cb604-24"><a href="веб-скрапинг.html#cb604-24" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;маячк&quot;</span>) <span class="sc">~</span> <span class="st">&quot;маячок&quot;</span>,</span>
<span id="cb604-25"><a href="веб-скрапинг.html#cb604-25" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;очерк&quot;</span>) <span class="sc">~</span> <span class="st">&quot;очерк&quot;</span>,</span>
<span id="cb604-26"><a href="веб-скрапинг.html#cb604-26" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;птолем&quot;</span>) <span class="sc">~</span> <span class="st">&quot;птолемей&quot;</span>,</span>
<span id="cb604-27"><a href="веб-скрапинг.html#cb604-27" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;росса&quot;</span>) <span class="sc">~</span> <span class="st">&quot;росс&quot;</span>,</span>
<span id="cb604-28"><a href="веб-скрапинг.html#cb604-28" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;самосат&quot;</span>) <span class="sc">~</span> <span class="st">&quot;самосата&quot;</span>,</span>
<span id="cb604-29"><a href="веб-скрапинг.html#cb604-29" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;стрепсиад&quot;</span>) <span class="sc">~</span> <span class="st">&quot;стрепсиад&quot;</span>,</span>
<span id="cb604-30"><a href="веб-скрапинг.html#cb604-30" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;эпихар&quot;</span>) <span class="sc">~</span> <span class="st">&quot;эпихарм&quot;</span>,</span>
<span id="cb604-31"><a href="веб-скрапинг.html#cb604-31" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;ямвл&quot;</span>) <span class="sc">~</span> <span class="st">&quot;ямвлих&quot;</span>,</span>
<span id="cb604-32"><a href="веб-скрапинг.html#cb604-32" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;брумал&quot;</span>) <span class="sc">~</span> <span class="st">&quot;брумалии&quot;</span>,</span>
<span id="cb604-33"><a href="веб-скрапинг.html#cb604-33" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;иоанн&quot;</span>) <span class="sc">~</span> <span class="st">&quot;иоанн&quot;</span>,</span>
<span id="cb604-34"><a href="веб-скрапинг.html#cb604-34" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;кинопоиск&quot;</span>) <span class="sc">~</span> <span class="st">&quot;кинопоиск&quot;</span>,</span>
<span id="cb604-35"><a href="веб-скрапинг.html#cb604-35" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;корнар&quot;</span>) <span class="sc">~</span> <span class="st">&quot;корнарий&quot;</span>,</span>
<span id="cb604-36"><a href="веб-скрапинг.html#cb604-36" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;луция&quot;</span>) <span class="sc">~</span> <span class="st">&quot;луций&quot;</span>,</span>
<span id="cb604-37"><a href="веб-скрапинг.html#cb604-37" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;кассия&quot;</span>) <span class="sc">~</span> <span class="st">&quot;кассий&quot;</span>,</span>
<span id="cb604-38"><a href="веб-скрапинг.html#cb604-38" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;минф&quot;</span>) <span class="sc">~</span> <span class="st">&quot;минфа&quot;</span>,</span>
<span id="cb604-39"><a href="веб-скрапинг.html#cb604-39" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;персефон&quot;</span>) <span class="sc">~</span> <span class="st">&quot;персефона&quot;</span>,</span>
<span id="cb604-40"><a href="веб-скрапинг.html#cb604-40" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;пестум&quot;</span>) <span class="sc">~</span> <span class="st">&quot;пестум&quot;</span>,</span>
<span id="cb604-41"><a href="веб-скрапинг.html#cb604-41" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;платон&quot;</span>) <span class="sc">~</span> <span class="st">&quot;платон&quot;</span>,</span>
<span id="cb604-42"><a href="веб-скрапинг.html#cb604-42" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;платно&quot;</span>) <span class="sc">~</span> <span class="st">&quot;платон&quot;</span>,</span>
<span id="cb604-43"><a href="веб-скрапинг.html#cb604-43" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;филеб&quot;</span>) <span class="sc">~</span> <span class="st">&quot;филеб&quot;</span>,</span>
<span id="cb604-44"><a href="веб-скрапинг.html#cb604-44" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;фульг&quot;</span>) <span class="sc">~</span> <span class="st">&quot;фульгенций&quot;</span>,</span>
<span id="cb604-45"><a href="веб-скрапинг.html#cb604-45" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;аврел&quot;</span>) <span class="sc">~</span> <span class="st">&quot;аврелий&quot;</span>,</span>
<span id="cb604-46"><a href="веб-скрапинг.html#cb604-46" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;антигон&quot;</span>) <span class="sc">~</span> <span class="st">&quot;антигона&quot;</span>,</span>
<span id="cb604-47"><a href="веб-скрапинг.html#cb604-47" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;анция&quot;</span>) <span class="sc">~</span> <span class="st">&quot;анций&quot;</span>,</span>
<span id="cb604-48"><a href="веб-скрапинг.html#cb604-48" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;борея&quot;</span>) <span class="sc">~</span> <span class="st">&quot;борей&quot;</span>,</span>
<span id="cb604-49"><a href="веб-скрапинг.html#cb604-49" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;вольтер&quot;</span>) <span class="sc">~</span> <span class="st">&quot;вольтер&quot;</span>,</span>
<span id="cb604-50"><a href="веб-скрапинг.html#cb604-50" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;гераклид&quot;</span>) <span class="sc">~</span> <span class="st">&quot;гераклид&quot;</span>,</span>
<span id="cb604-51"><a href="веб-скрапинг.html#cb604-51" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;теэтет&quot;</span>) <span class="sc">~</span> <span class="st">&quot;теэтет&quot;</span>,</span>
<span id="cb604-52"><a href="веб-скрапинг.html#cb604-52" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;евангел&quot;</span>) <span class="sc">~</span> <span class="st">&quot;евангелие&quot;</span>,</span>
<span id="cb604-53"><a href="веб-скрапинг.html#cb604-53" tabindex="-1"></a>                 <span class="fu">str_detect</span>(lemma, <span class="st">&quot;федон&quot;</span>) <span class="sc">~</span> <span class="st">&quot;федон&quot;</span>,</span>
<span id="cb604-54"><a href="веб-скрапинг.html#cb604-54" tabindex="-1"></a>                 <span class="cn">TRUE</span> <span class="sc">~</span> .))</span></code></pre></div>
<p>Получившийся тиббл сохраняю – он понадобится в главе 13.</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="веб-скрапинг.html#cb605-1" tabindex="-1"></a><span class="fu">save</span>(text_tidy, <span class="at">file =</span> <span class="st">&quot;data/AntibarbariTidy.Rdata&quot;</span>)</span></code></pre></div>
</div>
<div id="html-таблицы" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> Html таблицы<a href="веб-скрапинг.html#html-таблицы" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Если вам повезет, то ваши данные уже будут храниться в HTML-таблице, и их можно будет просто считать из этой таблицы<a href="#fn39" class="footnote-ref" id="fnref39"><sup>39</sup></a>. Распознать таблицу в браузере обычно несложно: она имеет прямоугольную структуру из строк и столбцов, и ее можно скопировать и вставить в такой инструмент, как Excel.</p>
<p>Таблицы HTML строятся из четырех основных элементов: &lt;table&gt;, &lt;tr&gt; (строка таблицы), &lt;th&gt; (заголовок таблицы) и &lt;td&gt; (данные таблицы). Мы соберем информацию о <a href="https://hum.hse.ru/proj/project2022_2024">проектных группах</a> ФГН в 2022-2024 г.</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="веб-скрапинг.html#cb606-1" tabindex="-1"></a>html <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;https://hum.hse.ru/proj/project2022_2024&quot;</span>)</span>
<span id="cb606-2"><a href="веб-скрапинг.html#cb606-2" tabindex="-1"></a>my_table <span class="ot">&lt;-</span> html <span class="sc">%&gt;%</span>  </span>
<span id="cb606-3"><a href="веб-скрапинг.html#cb606-3" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">&quot;.bordered&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb606-4"><a href="веб-скрапинг.html#cb606-4" tabindex="-1"></a>  <span class="fu">html_table</span>()</span>
<span id="cb606-5"><a href="веб-скрапинг.html#cb606-5" tabindex="-1"></a></span>
<span id="cb606-6"><a href="веб-скрапинг.html#cb606-6" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(my_table)</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2651242829e45c65c82b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2651242829e45c65c82b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27"],["Название проекта","Проекты Школы исторических наук","Восточноевропейские исследования в транснациональной перспективе","Россия и русские в корреспонденции и дневниках британских дипломатов при дворе Екатерины II","Социальные и культурные исследования медицины XVIII-XXI вв.","Экономика строительства в России XVIII века","Проекты Школы лингвистики","Дискурсивные формулы в турецком языке в общетеоретической и типологической перспективе","Типологический конструктикон","«Найти общий язык»: современные методы исследования языковых ситуаций в России","Проекты Школы филологических наук","Amour courtois: антология куртуазной любви","База данных по историческим изменениям русских конструкций «Diachronicon»","Летопись «Доктора Живаго» Бориса Пастернака (1945-1960): авторский замысел, история работы и публикации, рецепция современников (база данных)","Проекты Школы философии и культурологии","Интерактивное учебное пособие по философской логике и формальной философии","Проект «Основные понятия философии техники от Э. Каппа до STS. Index rerum»","Разработка методических комплексов по обществознанию для основной школы","Цифровая античность","Разработка методических комплексов по обществознанию для основной школы","Проект Института классического Востока и античности","«Сова Минервы» — оживление архива","Междисциплинарные исследования агиографических традиций","Переплетенная история / Entangled History: мусульмане и Другие в России и вовне","Разработка учебных материалов для изучения языков Библии и введения в современную библеистику","Проект Института гуманитарных историко-теоретических исследований (2022-2023 гг.)","Современная академическая этика: добродетели и пороки в университетских этических кодексах"],["Руководитель проектной группы","Проекты Школы исторических наук","Горизонтов Леонид Ефремович","Смилянская Елена Борисовна","Афанасьева Анна Эдгардовна","Борисов Виктор Евгеньевич","Проекты Школы лингвистики","Рыжова Дарья Александровна","Летучий Александр Борисович","Влахов Андриан Викторович","Проекты Школы филологических наук","Долгорукова Наталья Михайловна","Буденная Евгения Владимировна","Поливанов Константин Михайлович","Проекты Школы философии и культурологии","Долгоруков Виталий Владимирович","Михайловский Александр Владиславович","Карпенко Елена Константиновна","Алиева Ольга Валерьевна","Карпенко Елена КонстантиновнаСеливерстов Владимир Валерьевич","Проект Института классического Востока и античности","Брагинская Нина Владимировна","Иванов Сергей Аркадьевич","Бессмертная Ольга Юрьевна","Селезнёв Михаил Георгиевич","Проект Института гуманитарных историко-теоретических исследований (2022-2023 гг.)","Плешков Алексей Александрович"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>X1<\/th>\n      <th>X2<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p></br></p>
<div class="task code">
<p>С сайта <a href="https://iphlib.ru/library/collection/newphilenc/browse/CL1/21">Новой философской энциклопедии</a> извлеките список слов на букву П. Используйте <code>map_df()</code> для объединения таблиц.</p>
</div>
<p></br></p>
<div class="ask question">
<p>Сколько всего слов на букву П в НФЭ?</p>
</div>
<form name="form_22357" onsubmit="return validate_form_22357()" method="post">
<input type="text" placeholder="" name="answer_22357"/>
<input type="submit" value="check"/>
<div id="result_22357"></div>
</form>
<script>function validate_form_22357() {var x, text; var x = document.forms['form_22357']['answer_22357'].value;if (x == '267'){text = 'ПППравильно✅';} else {text = 'ППодумайте еще❌';} document.getElementById('result_22357').innerHTML = text; evaluate_final_score(); return false;}function evaluate_final_score(){
         element = document.getElementById('checkdown_final_score');
         if(element === null){return false;} else {var element, text, res1, res2, res3, res4, res5, res6, res7, res8, res9, res10, res11, res12, res13, res14, res15, res16, res17, res18, res19, res20, res21, res22, res23, res24, res25, res26, res27, res28, res29, res30, res31, res32, res33, res34, res35, res36, res37, res38, res39, res40, res41, res42, res43, res44, res45, res46, res47, res48, res49, res50, res51;res1 = document.getElementById('result_47449').innerText == 'Все верно!'; res2 = document.getElementById('result_15501').innerText == 'Все возможно в дивном мире R!'; res3 = document.getElementById('result_33826').innerText == 'Гениально!'; res4 = document.getElementById('result_93174').innerText == 'Все верно!'; res5 = document.getElementById('result_35086').innerText == 'Все верно!'; res6 = document.getElementById('result_41867').innerText == 'Все верно!'; res7 = document.getElementById('result_56445').innerText == 'Все верно!'; res8 = document.getElementById('result_27662').innerText == 'Ну это же просто фантастика!'; res9 = document.getElementById('result_31352').innerText == 'Ах, красота!'; res10 = document.getElementById('result_50279').innerText == 'Восторг!'; res11 = document.getElementById('result_20184').innerText == 'Железная логика!'; res12 = document.getElementById('result_80119').innerText == 'Восхищаемся вами'; res13 = document.getElementById('result_3920').innerText == 'Гениально💡'; res14 = document.getElementById('result_90763').innerText == 'Зажигаете! 🔥'; res15 = document.getElementById('result_86279').innerText == 'С вами явно пребывает сила.'; res16 = document.getElementById('result_60808').innerText == 'Красота!'; res17 = document.getElementById('result_85720').innerText == 'Список вкусняшек в вашей власти!'; res18 = document.getElementById('result_17236').innerText == 'Вот вам пончик в награду 🍩'; res19 = document.getElementById('result_83589').innerText == 'Все 🥐🥐🥐 ваши!'; res20 = document.getElementById('result_82274').innerText == '✅'; res21 = document.getElementById('result_79342').innerText == '✅'; res22 = document.getElementById('result_95216').innerText == '✅'; res23 = document.getElementById('result_21817').innerText == 'Восхищаемся вами!'; res24 = document.getElementById('result_56790').innerText == 'Продолжайте в том же духе!'; res25 = document.getElementById('result_17181').innerText == 'Да, эта функция способна на многое!'; res26 = document.getElementById('result_1329').innerText == 'счастье &lt;- R + 🍪'; res27 = document.getElementById('result_43766').innerText == '✅'; res28 = document.getElementById('result_92655').innerText == '✅'; res29 = document.getElementById('result_99012').innerText == 'Всемогущая гебдомада!'; res30 = document.getElementById('result_65563').innerText == '✅'; res31 = document.getElementById('result_92796').innerText == '✅'; res32 = document.getElementById('result_15089').innerText == '✅'; res33 = document.getElementById('result_29076').innerText == 'И все это для творчества 🎨'; res34 = document.getElementById('result_90748').innerText == 'Тут все ясно'; res35 = document.getElementById('result_19976').innerText == 'Верно!'; res36 = document.getElementById('result_48275').innerText == 'Отлично!'; res37 = document.getElementById('result_35273').innerText == 'Отлично!'; res38 = document.getElementById('result_84917').innerText == 'Все так, и никакого колдунства.'; res39 = document.getElementById('result_61005').innerText == '✅'; res40 = document.getElementById('result_93838').innerText == '✅'; res41 = document.getElementById('result_71734').innerText == '✅'; res42 = document.getElementById('result_87690').innerText == '✅'; res43 = document.getElementById('result_56614').innerText == '✅'; res44 = document.getElementById('result_7130').innerText == '✅'; res45 = document.getElementById('result_34874').innerText == '✅'; res46 = document.getElementById('result_62396').innerText == '✅'; res47 = document.getElementById('result_78661').innerText == '✅'; res48 = document.getElementById('result_58274').innerText == 'Все верно!'; res49 = document.getElementById('result_3708').innerText == 'Правильно!'; res50 = document.getElementById('result_40828').innerText == 'Верно!'; res51 = document.getElementById('result_22357').innerText == 'ПППравильно✅';text = res1 + res2 + res3 + res4 + res5 + res6 + res7 + res8 + res9 + res10 + res11 + res12 + res13 + res14 + res15 + res16 + res17 + res18 + res19 + res20 + res21 + res22 + res23 + res24 + res25 + res26 + res27 + res28 + res29 + res30 + res31 + res32 + res33 + res34 + res35 + res36 + res37 + res38 + res39 + res40 + res41 + res42 + res43 + res44 + res45 + res46 + res47 + res48 + res49 + res50 + res51;element.innerHTML = text;
         return false;
         }}</script>
</div>
<div id="wikisource" class="section level2 hasAnchor" number="9.10">
<h2><span class="header-section-number">9.10</span> Wikisource<a href="веб-скрапинг.html#wikisource" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Многие тексты доступны на сайте Wikisource.org. Попробуем извлечь все сказки Салтыкова-Щедрина.</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="веб-скрапинг.html#cb607-1" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://ru.wikisource.org/wiki/%D0%9C%D0%B8%D1%85%D0%B0%D0%B8%D0%BB_%D0%95%D0%B2%D0%B3%D1%80%D0%B0%D1%84%D0%BE%D0%B2%D0%B8%D1%87_%D0%A1%D0%B0%D0%BB%D1%82%D1%8B%D0%BA%D0%BE%D0%B2-%D0%A9%D0%B5%D0%B4%D1%80%D0%B8%D0%BD&quot;</span></span>
<span id="cb607-2"><a href="веб-скрапинг.html#cb607-2" tabindex="-1"></a>html <span class="ot">=</span> <span class="fu">read_html</span>(url)</span></code></pre></div>
<p>Для того, чтобы справиться с такой страницей, пригодится Selector Gadget (расширение для Chrome). Вот <a href="https://youtu.be/oqNTfWrGdbk">тут</a> можно посмотреть короткое видео, как его установить. При помощи селектора выбираем нужные уровни.</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="веб-скрапинг.html#cb608-1" tabindex="-1"></a>toc <span class="ot">&lt;-</span> html <span class="sc">%&gt;%</span> </span>
<span id="cb608-2"><a href="веб-скрапинг.html#cb608-2" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;ul:nth-child(22) a&quot;</span>)</span>
<span id="cb608-3"><a href="веб-скрапинг.html#cb608-3" tabindex="-1"></a></span>
<span id="cb608-4"><a href="веб-скрапинг.html#cb608-4" tabindex="-1"></a><span class="fu">head</span>(toc)</span></code></pre></div>
<pre><code>## {xml_nodeset (6)}
## [1] &lt;a href=&quot;/wiki/%D0%9F%D0%BE%D0%B2%D0%B5%D1%81%D1%82%D ...
## [2] &lt;a href=&quot;/wiki/%D0%93%D0%BE%D0%B4%D0%BE%D0%B2%D1%89%D ...
## [3] &lt;a href=&quot;/wiki/%D0%9F%D1%80%D0%BE%D0%BF%D0%B0%D0%BB%D ...
## [4] &lt;a href=&quot;/wiki/%D0%94%D0%B8%D0%BA%D0%B8%D0%B9_%D0%BF% ...
## [5] &lt;a href=&quot;/wiki/%D0%9F%D1%80%D0%B5%D0%BC%D1%83%D0%B4%D ...
## [6] &lt;a href=&quot;/wiki/%D0%A1%D0%B0%D0%BC%D0%BE%D0%BE%D1%82%D ...</code></pre>
<p>Теперь у нас есть список ссылок.</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="веб-скрапинг.html#cb610-1" tabindex="-1"></a>tales <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb610-2"><a href="веб-скрапинг.html#cb610-2" tabindex="-1"></a>  <span class="at">title =</span> toc <span class="sc">%&gt;%</span></span>
<span id="cb610-3"><a href="веб-скрапинг.html#cb610-3" tabindex="-1"></a>    <span class="fu">html_attr</span>(<span class="st">&quot;title&quot;</span>),</span>
<span id="cb610-4"><a href="веб-скрапинг.html#cb610-4" tabindex="-1"></a>  <span class="at">href =</span> toc <span class="sc">%&gt;%</span> </span>
<span id="cb610-5"><a href="веб-скрапинг.html#cb610-5" tabindex="-1"></a>    <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>)</span>
<span id="cb610-6"><a href="веб-скрапинг.html#cb610-6" tabindex="-1"></a>)</span></code></pre></div>
<p>Данных о годе публикации под тегом <a> нет; надо подняться на уровень выше:</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="веб-скрапинг.html#cb611-1" tabindex="-1"></a>toc2 <span class="ot">&lt;-</span> html <span class="sc">%&gt;%</span> </span>
<span id="cb611-2"><a href="веб-скрапинг.html#cb611-2" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;ul:nth-child(22) li&quot;</span>)</span>
<span id="cb611-3"><a href="веб-скрапинг.html#cb611-3" tabindex="-1"></a></span>
<span id="cb611-4"><a href="веб-скрапинг.html#cb611-4" tabindex="-1"></a><span class="fu">head</span>(toc2)</span></code></pre></div>
<pre><code>## {xml_nodeset (6)}
## [1] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%9F%D0%BE%D0%B2%D0%B5%D1%81%D ...
## [2] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%93%D0%BE%D0%B4%D0%BE%D0%B2%D ...
## [3] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%9F%D1%80%D0%BE%D0%BF%D0%B0%D ...
## [4] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%94%D0%B8%D0%BA%D0%B8%D0%B9_% ...
## [5] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%9F%D1%80%D0%B5%D0%BC%D1%83%D ...
## [6] &lt;li&gt;\n&lt;a href=&quot;/wiki/%D0%A1%D0%B0%D0%BC%D0%BE%D0%BE%D ...</code></pre>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="веб-скрапинг.html#cb613-1" tabindex="-1"></a>toc2 <span class="sc">%&gt;%</span></span>
<span id="cb613-2"><a href="веб-скрапинг.html#cb613-2" tabindex="-1"></a>  <span class="fu">html_text2</span>()</span></code></pre></div>
<pre><code>##  [1] &quot;Повесть о том, как один мужик двух генералов прокормил, 1869&quot;
##  [2] &quot;Годовщина, 1869&quot;                                             
##  [3] &quot;Пропала совесть, 1869&quot;                                       
##  [4] &quot;Дикий помещик, 1869&quot;                                         
##  [5] &quot;Премудрый пискарь, 1883&quot;                                     
##  [6] &quot;Самоотверженный заяц, 1883&quot;                                  
##  [7] &quot;Бедный волк, 1883&quot;                                           
##  [8] &quot;Добродетели и Пороки, 1884&quot;                                  
##  [9] &quot;Медведь на воеводстве, 1884&quot;                                 
## [10] &quot;Обманщик-газетчик и легковерный читатель, 1884&quot;              
## [11] &quot;Вяленая вобла, 1884&quot;                                         
## [12] &quot;Орёл-меценат, 1884&quot;                                          
## [13] &quot;Карась-идеалист, 1884&quot;                                       
## [14] &quot;Игрушечного дела людишки, 1879, 1886&quot;                        
## [15] &quot;Чижиково горе, 1884&quot;                                         
## [16] &quot;Верный Трезор, 1885&quot;                                         
## [17] &quot;Недреманное око, конец 1885 или начало 1886&quot;                 
## [18] &quot;Дурак, 1885&quot;                                                 
## [19] &quot;Соседи, 1885&quot;                                                
## [20] &quot;Здравомысленный заяц, 1885&quot;                                  
## [21] &quot;Либерал, 1885&quot;                                               
## [22] &quot;Баран-непомнящий, 1885&quot;                                      
## [23] &quot;Коняга, 1855&quot;                                                
## [24] &quot;Кисель, 1855&quot;                                                
## [25] &quot;Праздный разговор, 1886&quot;                                     
## [26] &quot;Деревенский пожар, 1885&quot;                                     
## [27] &quot;Путём-дорогою, 1886&quot;                                         
## [28] &quot;Богатырь, 1886&quot;                                              
## [29] &quot;Гиена, 1886&quot;                                                 
## [30] &quot;Приключение с Крамольниковым, 1886&quot;                          
## [31] &quot;Христова ночь, 1886&quot;                                         
## [32] &quot;Ворон-челобитчик, 1886&quot;                                      
## [33] &quot;Рождественская сказка, 1886&quot;</code></pre>
<p>Соединяем:</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="веб-скрапинг.html#cb615-1" tabindex="-1"></a>tales <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb615-2"><a href="веб-скрапинг.html#cb615-2" tabindex="-1"></a>  <span class="at">title_year =</span> toc2 <span class="sc">%&gt;%</span></span>
<span id="cb615-3"><a href="веб-скрапинг.html#cb615-3" tabindex="-1"></a>    <span class="fu">html_text2</span>(),</span>
<span id="cb615-4"><a href="веб-скрапинг.html#cb615-4" tabindex="-1"></a>  <span class="at">href =</span> toc <span class="sc">%&gt;%</span> </span>
<span id="cb615-5"><a href="веб-скрапинг.html#cb615-5" tabindex="-1"></a>    <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>)</span>
<span id="cb615-6"><a href="веб-скрапинг.html#cb615-6" tabindex="-1"></a>)</span>
<span id="cb615-7"><a href="веб-скрапинг.html#cb615-7" tabindex="-1"></a></span>
<span id="cb615-8"><a href="веб-скрапинг.html#cb615-8" tabindex="-1"></a>tales</span></code></pre></div>
<pre><code>## # A tibble: 33 × 2
##    title_year                                          href 
##    &lt;chr&gt;                                               &lt;chr&gt;
##  1 Повесть о том, как один мужик двух генералов проко… /wik…
##  2 Годовщина, 1869                                     /wik…
##  3 Пропала совесть, 1869                               /wik…
##  4 Дикий помещик, 1869                                 /wik…
##  5 Премудрый пискарь, 1883                             /wik…
##  6 Самоотверженный заяц, 1883                          /wik…
##  7 Бедный волк, 1883                                   /wik…
##  8 Добродетели и Пороки, 1884                          /wik…
##  9 Медведь на воеводстве, 1884                         /wik…
## 10 Обманщик-газетчик и легковерный читатель, 1884      /wik…
## # ℹ 23 more rows</code></pre>
<p>Дальше можно достать текст для каждой сказки. Потренируемся на одной. Снова привлекаем Selector Gadget для составления правила.</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="веб-скрапинг.html#cb617-1" tabindex="-1"></a>url_test <span class="ot">&lt;-</span> tales <span class="sc">%&gt;%</span> </span>
<span id="cb617-2"><a href="веб-скрапинг.html#cb617-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb617-3"><a href="веб-скрапинг.html#cb617-3" tabindex="-1"></a>  <span class="fu">pull</span>(href) <span class="sc">%&gt;%</span> </span>
<span id="cb617-4"><a href="веб-скрапинг.html#cb617-4" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">&quot;https://ru.wikisource.org&quot;</span>, .)</span>
<span id="cb617-5"><a href="веб-скрапинг.html#cb617-5" tabindex="-1"></a></span>
<span id="cb617-6"><a href="веб-скрапинг.html#cb617-6" tabindex="-1"></a>text <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_test) <span class="sc">%&gt;%</span> </span>
<span id="cb617-7"><a href="веб-скрапинг.html#cb617-7" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;.indent p&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb617-8"><a href="веб-скрапинг.html#cb617-8" tabindex="-1"></a>  <span class="fu">html_text2</span>() </span>
<span id="cb617-9"><a href="веб-скрапинг.html#cb617-9" tabindex="-1"></a></span>
<span id="cb617-10"><a href="веб-скрапинг.html#cb617-10" tabindex="-1"></a>text[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] &quot;Жили да были два генерала, и так как оба были легкомысленны, то в скором времени, по щучьему велению, по моему хотению, очутились на необитаемом острове.&quot;</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="веб-скрапинг.html#cb619-1" tabindex="-1"></a>text[<span class="fu">length</span>(text)]</span></code></pre></div>
<pre><code>## [1] &quot;Однако, и об мужике не забыли; выслали ему рюмку водки да пятак серебра: веселись, мужичина!&quot;</code></pre>
<p>Первый и последний параграф достали верно; можно обобщать.</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="веб-скрапинг.html#cb621-1" tabindex="-1"></a>tales <span class="ot">&lt;-</span> tales <span class="sc">%&gt;%</span> </span>
<span id="cb621-2"><a href="веб-скрапинг.html#cb621-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">href =</span> <span class="fu">paste0</span>(<span class="st">&quot;https://ru.wikisource.org&quot;</span>, href))</span></code></pre></div>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="веб-скрапинг.html#cb622-1" tabindex="-1"></a>urls <span class="ot">&lt;-</span> tales <span class="sc">%&gt;%</span> </span>
<span id="cb622-2"><a href="веб-скрапинг.html#cb622-2" tabindex="-1"></a>  <span class="fu">pull</span>(href)</span></code></pre></div>
<p>Функция для извлечения текстов.</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="веб-скрапинг.html#cb623-1" tabindex="-1"></a>get_text <span class="ot">&lt;-</span> <span class="cf">function</span>(url) {</span>
<span id="cb623-2"><a href="веб-скрапинг.html#cb623-2" tabindex="-1"></a>  <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb623-3"><a href="веб-скрапинг.html#cb623-3" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;.indent p&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb623-4"><a href="веб-скрапинг.html#cb623-4" tabindex="-1"></a>  <span class="fu">html_text2</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb623-5"><a href="веб-скрапинг.html#cb623-5" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="at">collapse=</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb623-6"><a href="веб-скрапинг.html#cb623-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="веб-скрапинг.html#cb624-1" tabindex="-1"></a>tales_text <span class="ot">&lt;-</span> <span class="fu">map</span>(urls, get_text)</span></code></pre></div>
<p>Несколько сказок не выловились: там другая структура html, но в целом все получилось.</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="веб-скрапинг.html#cb625-1" tabindex="-1"></a>tales_text <span class="ot">&lt;-</span> tales_text <span class="sc">%&gt;%</span></span>
<span id="cb625-2"><a href="веб-скрапинг.html#cb625-2" tabindex="-1"></a>  <span class="fu">flatten_chr</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb625-3"><a href="веб-скрапинг.html#cb625-3" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb625-4"><a href="веб-скрапинг.html#cb625-4" tabindex="-1"></a></span>
<span id="cb625-5"><a href="веб-скрапинг.html#cb625-5" tabindex="-1"></a>tales <span class="ot">&lt;-</span> tales <span class="sc">%&gt;%</span> </span>
<span id="cb625-6"><a href="веб-скрапинг.html#cb625-6" tabindex="-1"></a>  <span class="fu">bind_cols</span>(tales_text)</span></code></pre></div>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="веб-скрапинг.html#cb626-1" tabindex="-1"></a>tales</span></code></pre></div>
<pre><code>## # A tibble: 33 × 3
##    title_year                                           href  value
##    &lt;chr&gt;                                                &lt;chr&gt; &lt;chr&gt;
##  1 Повесть о том, как один мужик двух генералов прокор… http… &quot;Жил…
##  2 Годовщина, 1869                                      http… &quot;Сег…
##  3 Пропала совесть, 1869                                http… &quot;Про…
##  4 Дикий помещик, 1869                                  http… &quot;В н…
##  5 Премудрый пискарь, 1883                              http… &quot;Жил…
##  6 Самоотверженный заяц, 1883                           http… &quot;Одн…
##  7 Бедный волк, 1883                                    http… &quot;Дру…
##  8 Добродетели и Пороки, 1884                           http… &quot;Доб…
##  9 Медведь на воеводстве, 1884                          http… &quot;&quot;   
## 10 Обманщик-газетчик и легковерный читатель, 1884       http… &quot;Жил…
## # ℹ 23 more rows</code></pre>
<p>Дальше можно разделить столбец с названием и годом и, например, удалить ссылку, она больше не нужна. Разделить по запятой не получится, т.к. она есть в некоторых названиях.</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="веб-скрапинг.html#cb628-1" tabindex="-1"></a>tales <span class="ot">&lt;-</span> tales <span class="sc">%&gt;%</span> </span>
<span id="cb628-2"><a href="веб-скрапинг.html#cb628-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>href) <span class="sc">%&gt;%</span> </span>
<span id="cb628-3"><a href="веб-скрапинг.html#cb628-3" tabindex="-1"></a>  <span class="fu">separate</span>(title_year, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;year&quot;</span>), <span class="at">sep =</span> <span class="sc">-</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb628-4"><a href="веб-скрапинг.html#cb628-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">title =</span> <span class="fu">str_remove</span>(title, <span class="st">&quot;,$&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="веб-скрапинг.html#cb629-1" tabindex="-1"></a>tales</span></code></pre></div>
<pre><code>## # A tibble: 33 × 3
##    title                                                year  value
##    &lt;chr&gt;                                                &lt;chr&gt; &lt;chr&gt;
##  1 Повесть о том, как один мужик двух генералов прокор… &quot; 18… &quot;Жил…
##  2 Годовщина                                            &quot; 18… &quot;Сег…
##  3 Пропала совесть                                      &quot; 18… &quot;Про…
##  4 Дикий помещик                                        &quot; 18… &quot;В н…
##  5 Премудрый пискарь                                    &quot; 18… &quot;Жил…
##  6 Самоотверженный заяц                                 &quot; 18… &quot;Одн…
##  7 Бедный волк                                          &quot; 18… &quot;Дру…
##  8 Добродетели и Пороки                                 &quot; 18… &quot;Доб…
##  9 Медведь на воеводстве                                &quot; 18… &quot;&quot;   
## 10 Обманщик-газетчик и легковерный читатель             &quot; 18… &quot;Жил…
## # ℹ 23 more rows</code></pre>
<p>Недостающие две сказки я не буду пытаться извлечь, но логику вы поняли.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="39">
<li id="fn39"><p><a href="https://r4ds.hadley.nz/webscraping#tables" class="uri">https://r4ds.hadley.nz/webscraping#tables</a><a href="веб-скрапинг.html#fnref39" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="регулярные-выражения.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="токенизация-и-лемматизация.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/locusclassicus/text_analysis_2023/edit/main/08-scraping.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
