<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Тема 12 Тематическое моделирование | Компьютерный анализ текста в R</title>
  <meta name="description" content="Все прекрасное трудно." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Тема 12 Тематическое моделирование | Компьютерный анализ текста в R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Все прекрасное трудно." />
  <meta name="github-repo" content="https://github.com/locusclassicus/text_analysis_r_bookdown_2023/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Тема 12 Тематическое моделирование | Компьютерный анализ текста в R" />
  
  <meta name="twitter:description" content="Все прекрасное трудно." />
  

<meta name="author" content="Ольга Алиева" />


<meta name="date" content="2023-07-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="распределения-слов-и-анализ-частотностей.html"/>
<link rel="next" href="латентно-семантический-анализ-часть-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.27/datatables.js"></script>
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Компьютерный анализ текста в R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#благодарности"><i class="fa fa-check"></i><b>1.1</b> Благодарности</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html"><i class="fa fa-check"></i><b>2</b> Начало работы с R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#что-такое-r"><i class="fa fa-check"></i><b>2.1</b> Что такое R?</a></li>
<li class="chapter" data-level="2.2" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#пакеты-и-виньетки"><i class="fa fa-check"></i><b>2.2</b> Пакеты и виньетки</a></li>
<li class="chapter" data-level="2.3" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#если-не-хватает-пакетов"><i class="fa fa-check"></i><b>2.3</b> Если не хватает пакетов</a></li>
<li class="chapter" data-level="2.4" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#о-воспроизводимости"><i class="fa fa-check"></i><b>2.4</b> О воспроизводимости</a></li>
<li class="chapter" data-level="2.5" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#что-мы-не-будем-делать"><i class="fa fa-check"></i><b>2.5</b> Что мы (не) будем делать?</a></li>
<li class="chapter" data-level="2.6" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#rstudio"><i class="fa fa-check"></i><b>2.6</b> RStudio</a></li>
<li class="chapter" data-level="2.7" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#установка"><i class="fa fa-check"></i><b>2.7</b> Установка</a></li>
<li class="chapter" data-level="2.8" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#начало-работы"><i class="fa fa-check"></i><b>2.8</b> Начало работы</a></li>
<li class="chapter" data-level="2.9" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#r-как-калькулятор"><i class="fa fa-check"></i><b>2.9</b> R как калькулятор</a></li>
<li class="chapter" data-level="2.10" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#операторы-присваивания"><i class="fa fa-check"></i><b>2.10</b> Операторы присваивания</a></li>
<li class="chapter" data-level="2.11" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#векторы"><i class="fa fa-check"></i><b>2.11</b> Векторы</a></li>
<li class="chapter" data-level="2.12" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#списки"><i class="fa fa-check"></i><b>2.12</b> Списки</a></li>
<li class="chapter" data-level="2.13" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#матрицы"><i class="fa fa-check"></i><b>2.13</b> Матрицы</a></li>
<li class="chapter" data-level="2.14" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#таблицы"><i class="fa fa-check"></i><b>2.14</b> Таблицы</a></li>
<li class="chapter" data-level="2.15" data-path="начало-работы-с-r.html"><a href="начало-работы-с-r.html#шорткаты"><i class="fa fa-check"></i><b>2.15</b> Шорткаты</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="визуализации.html"><a href="визуализации.html"><i class="fa fa-check"></i><b>3</b> Визуализации</a>
<ul>
<li class="chapter" data-level="3.1" data-path="визуализации.html"><a href="визуализации.html#базовый-r"><i class="fa fa-check"></i><b>3.1</b> Базовый R</a></li>
<li class="chapter" data-level="3.2" data-path="визуализации.html"><a href="визуализации.html#lattice"><i class="fa fa-check"></i><b>3.2</b> Lattice</a></li>
<li class="chapter" data-level="3.3" data-path="визуализации.html"><a href="визуализации.html#ggplot2"><i class="fa fa-check"></i><b>3.3</b> Ggplot2</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="визуализации.html"><a href="визуализации.html#быстрое-решение-qplot"><i class="fa fa-check"></i><b>3.3.1</b> Быстрое решение: qplot()</a></li>
<li class="chapter" data-level="3.3.2" data-path="визуализации.html"><a href="визуализации.html#слой-за-слоем-ggplot"><i class="fa fa-check"></i><b>3.3.2</b> Слой за слоем: ggplot()</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="визуализации.html"><a href="визуализации.html#экспорт-графиков-из-среды-r"><i class="fa fa-check"></i><b>3.4</b> Экспорт графиков из среды R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="опрятные-данные.html"><a href="опрятные-данные.html"><i class="fa fa-check"></i><b>4</b> Опрятные данные</a>
<ul>
<li class="chapter" data-level="4.1" data-path="опрятные-данные.html"><a href="опрятные-данные.html#синтаксис-tidyverse"><i class="fa fa-check"></i><b>4.1</b> Синтаксис tidyverse</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="опрятные-данные.html"><a href="опрятные-данные.html#tibble"><i class="fa fa-check"></i><b>4.1.1</b> Tibble</a></li>
<li class="chapter" data-level="4.1.2" data-path="опрятные-данные.html"><a href="опрятные-данные.html#dplyr"><i class="fa fa-check"></i><b>4.1.2</b> Dplyr</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="опрятные-данные.html"><a href="опрятные-данные.html#опрятные-данные-1"><i class="fa fa-check"></i><b>4.2</b> Опрятные данные</a></li>
<li class="chapter" data-level="4.3" data-path="опрятные-данные.html"><a href="опрятные-данные.html#пример-буккроссинг"><i class="fa fa-check"></i><b>4.3</b> Пример: буккроссинг</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="опрятные-данные.html"><a href="опрятные-данные.html#смотрим-на-данные"><i class="fa fa-check"></i><b>4.3.1</b> Смотрим на данные</a></li>
<li class="chapter" data-level="4.3.2" data-path="опрятные-данные.html"><a href="опрятные-данные.html#трансформируем-данные"><i class="fa fa-check"></i><b>4.3.2</b> Трансформируем данные</a></li>
<li class="chapter" data-level="4.3.3" data-path="опрятные-данные.html"><a href="опрятные-данные.html#объединяем-данные"><i class="fa fa-check"></i><b>4.3.3</b> Объединяем данные</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html"><i class="fa fa-check"></i><b>5</b> Функциональное программирование</a>
<ul>
<li class="chapter" data-level="5.1" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#зачем-писать-функции"><i class="fa fa-check"></i><b>5.1</b> Зачем писать функции?</a></li>
<li class="chapter" data-level="5.2" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#область-видимости-переменных"><i class="fa fa-check"></i><b>5.2</b> Область видимости переменных</a></li>
<li class="chapter" data-level="5.3" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#аргументы-функции"><i class="fa fa-check"></i><b>5.3</b> Аргументы функции</a></li>
<li class="chapter" data-level="5.4" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#векторизируй-это"><i class="fa fa-check"></i><b>5.4</b> Векторизируй это</a></li>
<li class="chapter" data-level="5.5" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#векторизованные-конструкции"><i class="fa fa-check"></i><b>5.5</b> Векторизованные конструкции</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#циклы"><i class="fa fa-check"></i><b>5.5.1</b> Циклы</a></li>
<li class="chapter" data-level="5.5.2" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#условия"><i class="fa fa-check"></i><b>5.5.2</b> Условия</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#вместо-циклов-базовый-r-и-tidyverse"><i class="fa fa-check"></i><b>5.6</b> Вместо циклов: базовый R и tidyverse</a></li>
<li class="chapter" data-level="5.7" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#purrr"><i class="fa fa-check"></i><b>5.7</b> Purrr</a></li>
<li class="chapter" data-level="5.8" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#пример-итерации"><i class="fa fa-check"></i><b>5.8</b> Пример итерации</a></li>
<li class="chapter" data-level="5.9" data-path="функциональное-программирование.html"><a href="функциональное-программирование.html#furrr"><i class="fa fa-check"></i><b>5.9</b> Furrr</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html"><i class="fa fa-check"></i><b>6</b> Импорт и экспорт данных</a>
<ul>
<li class="chapter" data-level="6.1" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#рабочая-директория"><i class="fa fa-check"></i><b>6.1</b> Рабочая директория</a></li>
<li class="chapter" data-level="6.2" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#чтение-файлов-из-интернета"><i class="fa fa-check"></i><b>6.2</b> Чтение файлов из интернета</a></li>
<li class="chapter" data-level="6.3" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#чтение-локальных-файлов"><i class="fa fa-check"></i><b>6.3</b> Чтение локальных файлов</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#csv-и-tsv"><i class="fa fa-check"></i><b>6.3.1</b> csv и tsv</a></li>
<li class="chapter" data-level="6.3.2" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#xls-и-xlsx"><i class="fa fa-check"></i><b>6.3.2</b> xls и xlsx</a></li>
<li class="chapter" data-level="6.3.3" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#txt"><i class="fa fa-check"></i><b>6.3.3</b> txt</a></li>
<li class="chapter" data-level="6.3.4" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#doc"><i class="fa fa-check"></i><b>6.3.4</b> doc</a></li>
<li class="chapter" data-level="6.3.5" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#pdf"><i class="fa fa-check"></i><b>6.3.5</b> pdf</a></li>
<li class="chapter" data-level="6.3.6" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#zip"><i class="fa fa-check"></i><b>6.3.6</b> zip</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#xml-и-html"><i class="fa fa-check"></i><b>6.4</b> xml и html</a></li>
<li class="chapter" data-level="6.5" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#json"><i class="fa fa-check"></i><b>6.5</b> json</a></li>
<li class="chapter" data-level="6.6" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#gutenbergr"><i class="fa fa-check"></i><b>6.6</b> GutenbergR</a></li>
<li class="chapter" data-level="6.7" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#rperseus"><i class="fa fa-check"></i><b>6.7</b> RPerseus</a></li>
<li class="chapter" data-level="6.8" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#чтение-нескольких-файлов"><i class="fa fa-check"></i><b>6.8</b> Чтение нескольких файлов</a></li>
<li class="chapter" data-level="6.9" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#экспорт"><i class="fa fa-check"></i><b>6.9</b> Экспорт</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="импорт-и-экспорт-данных.html"><a href="импорт-и-экспорт-данных.html#rdata"><i class="fa fa-check"></i><b>6.9.1</b> Rdata</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html"><i class="fa fa-check"></i><b>7</b> Воспроизводимые исследования</a>
<ul>
<li class="chapter" data-level="7.1" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#о-воспроизводимости-1"><i class="fa fa-check"></i><b>7.1</b> О воспроизводимости</a></li>
<li class="chapter" data-level="7.2" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#markdown"><i class="fa fa-check"></i><b>7.2</b> Markdown</a></li>
<li class="chapter" data-level="7.3" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#синтаксис-markdown"><i class="fa fa-check"></i><b>7.3</b> Синтаксис Markdown</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#заголовки"><i class="fa fa-check"></i><b>7.3.1</b> Заголовки</a></li>
<li class="chapter" data-level="7.3.2" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#форматирование"><i class="fa fa-check"></i><b>7.3.2</b> Форматирование</a></li>
<li class="chapter" data-level="7.3.3" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#списки-1"><i class="fa fa-check"></i><b>7.3.3</b> Списки</a></li>
<li class="chapter" data-level="7.3.4" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#ссылки"><i class="fa fa-check"></i><b>7.3.4</b> Ссылки</a></li>
<li class="chapter" data-level="7.3.5" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#изображения"><i class="fa fa-check"></i><b>7.3.5</b> Изображения</a></li>
<li class="chapter" data-level="7.3.6" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#блоки-кода"><i class="fa fa-check"></i><b>7.3.6</b> Блоки кода</a></li>
<li class="chapter" data-level="7.3.7" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#цитаты"><i class="fa fa-check"></i><b>7.3.7</b> Цитаты</a></li>
<li class="chapter" data-level="7.3.8" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#разделители"><i class="fa fa-check"></i><b>7.3.8</b> Разделители</a></li>
<li class="chapter" data-level="7.3.9" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#таблицы-1"><i class="fa fa-check"></i><b>7.3.9</b> Таблицы</a></li>
<li class="chapter" data-level="7.3.10" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#id"><i class="fa fa-check"></i><b>7.3.10</b> Чек-листы</a></li>
<li class="chapter" data-level="7.3.11" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#внутренние-ссылки"><i class="fa fa-check"></i><b>7.3.11</b> Внутренние ссылки</a></li>
<li class="chapter" data-level="7.3.12" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#графики"><i class="fa fa-check"></i><b>7.3.12</b> Графики</a></li>
<li class="chapter" data-level="7.3.13" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#математические-формулы"><i class="fa fa-check"></i><b>7.3.13</b> Математические формулы</a></li>
<li class="chapter" data-level="7.3.14" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#библиография"><i class="fa fa-check"></i><b>7.3.14</b> Библиография</a></li>
<li class="chapter" data-level="7.3.15" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#смайлы"><i class="fa fa-check"></i><b>7.3.15</b> Смайлы</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="воспроизводимые-исследования.html"><a href="воспроизводимые-исследования.html#публикация-html"><i class="fa fa-check"></i><b>7.4</b> Публикация html</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html"><i class="fa fa-check"></i><b>8</b> Регулярные выражения</a>
<ul>
<li class="chapter" data-level="8.1" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#regex-в-базовом-r"><i class="fa fa-check"></i><b>8.1</b> Regex в базовом R</a></li>
<li class="chapter" data-level="8.2" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#литералы-и-классы"><i class="fa fa-check"></i><b>8.2</b> Литералы и классы</a></li>
<li class="chapter" data-level="8.3" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#якоря"><i class="fa fa-check"></i><b>8.3</b> Якоря</a></li>
<li class="chapter" data-level="8.4" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#метасимволы"><i class="fa fa-check"></i><b>8.4</b> Метасимволы</a></li>
<li class="chapter" data-level="8.5" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#экранирование"><i class="fa fa-check"></i><b>8.5</b> Экранирование</a></li>
<li class="chapter" data-level="8.6" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#квантификация"><i class="fa fa-check"></i><b>8.6</b> Квантификация</a></li>
<li class="chapter" data-level="8.7" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#жадная-и-ленивая-квантификация"><i class="fa fa-check"></i><b>8.7</b> Жадная и ленивая квантификация</a></li>
<li class="chapter" data-level="8.8" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#regex-в-stringr-основы"><i class="fa fa-check"></i><b>8.8</b> Regex в stringr: основы</a></li>
<li class="chapter" data-level="8.9" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_detect-и-str_count"><i class="fa fa-check"></i><b>8.9</b> str_detect() и str_count()</a></li>
<li class="chapter" data-level="8.10" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_extract"><i class="fa fa-check"></i><b>8.10</b> str_extract()</a></li>
<li class="chapter" data-level="8.11" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_subset-и-str_match"><i class="fa fa-check"></i><b>8.11</b> str_subset() и str_match()</a></li>
<li class="chapter" data-level="8.12" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_replace"><i class="fa fa-check"></i><b>8.12</b> str_replace</a></li>
<li class="chapter" data-level="8.13" data-path="регулярные-выражения.html"><a href="регулярные-выражения.html#str_split"><i class="fa fa-check"></i><b>8.13</b> str_split</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html"><i class="fa fa-check"></i><b>9</b> Токенизация и лемматизация</a>
<ul>
<li class="chapter" data-level="9.1" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#токенизация-в-tidytext"><i class="fa fa-check"></i><b>9.1</b> Токенизация в tidytext</a></li>
<li class="chapter" data-level="9.2" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#токенизация-в-tokenizers"><i class="fa fa-check"></i><b>9.2</b> Токенизация в tokenizers</a></li>
<li class="chapter" data-level="9.3" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#скипграмы"><i class="fa fa-check"></i><b>9.3</b> Скипграмы</a></li>
<li class="chapter" data-level="9.4" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#лемматизация-и-частеречная-разметка"><i class="fa fa-check"></i><b>9.4</b> Лемматизация и частеречная разметка</a></li>
<li class="chapter" data-level="9.5" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#морфологическая-разметка"><i class="fa fa-check"></i><b>9.5</b> Морфологическая разметка</a></li>
<li class="chapter" data-level="9.6" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#распределение-частей-речи"><i class="fa fa-check"></i><b>9.6</b> Распределение частей речи</a></li>
<li class="chapter" data-level="9.7" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#совместная-встречаемость-слов"><i class="fa fa-check"></i><b>9.7</b> Совместная встречаемость слов</a></li>
<li class="chapter" data-level="9.8" data-path="токенизация-и-лемматизация.html"><a href="токенизация-и-лемматизация.html#синтаксическая-разметка"><i class="fa fa-check"></i><b>9.8</b> Синтаксическая разметка</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html"><i class="fa fa-check"></i><b>10</b> Эмоциональная тональность</a>
<ul>
<li class="chapter" data-level="10.1" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#анализ-тональности"><i class="fa fa-check"></i><b>10.1</b> Анализ тональности</a></li>
<li class="chapter" data-level="10.2" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#подходы"><i class="fa fa-check"></i><b>10.2</b> Подходы</a></li>
<li class="chapter" data-level="10.3" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#тезаурусы"><i class="fa fa-check"></i><b>10.3</b> Тезаурусы</a></li>
<li class="chapter" data-level="10.4" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#лексиконы-для-русского-языка"><i class="fa fa-check"></i><b>10.4</b> Лексиконы для русского языка</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#chen-skiena"><i class="fa fa-check"></i><b>10.4.1</b> Chen &amp; Skiena</a></li>
<li class="chapter" data-level="10.4.2" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#rusentlex-2016"><i class="fa fa-check"></i><b>10.4.2</b> RuSentLex 2016</a></li>
<li class="chapter" data-level="10.4.3" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#afinn"><i class="fa fa-check"></i><b>10.4.3</b> AFINN</a></li>
<li class="chapter" data-level="10.4.4" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#nrc"><i class="fa fa-check"></i><b>10.4.4</b> NRC</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#анализ-тональности-с-tidy-data"><i class="fa fa-check"></i><b>10.5</b> Анализ тональности с Tidy Data</a></li>
<li class="chapter" data-level="10.6" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#подготовка-текста"><i class="fa fa-check"></i><b>10.6</b> Подготовка текста</a></li>
<li class="chapter" data-level="10.7" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#модификация-лексикона"><i class="fa fa-check"></i><b>10.7</b> Модификация лексикона</a></li>
<li class="chapter" data-level="10.8" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#соединение-лексикона-и-текста"><i class="fa fa-check"></i><b>10.8</b> Соединение лексикона и текста</a></li>
<li class="chapter" data-level="10.9" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#тональность-на-оси-времени"><i class="fa fa-check"></i><b>10.9</b> Тональность на оси времени</a></li>
<li class="chapter" data-level="10.10" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#для-других-языков"><i class="fa fa-check"></i><b>10.10</b> Для других языков</a></li>
<li class="chapter" data-level="10.11" data-path="эмоциональная-тональность.html"><a href="эмоциональная-тональность.html#виды-эмоций"><i class="fa fa-check"></i><b>10.11</b> Виды эмоций</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html"><i class="fa fa-check"></i><b>11</b> Распределения слов и анализ частотностей</a>
<ul>
<li class="chapter" data-level="11.1" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#извлечение-источников"><i class="fa fa-check"></i><b>11.1</b> Извлечение источников</a></li>
<li class="chapter" data-level="11.2" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#подготовка-источников"><i class="fa fa-check"></i><b>11.2</b> Подготовка источников</a></li>
<li class="chapter" data-level="11.3" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#токенизация"><i class="fa fa-check"></i><b>11.3</b> Токенизация</a></li>
<li class="chapter" data-level="11.4" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#cтоп-слова"><i class="fa fa-check"></i><b>11.4</b> Cтоп-слова</a></li>
<li class="chapter" data-level="11.5" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#абсолютная-частотность"><i class="fa fa-check"></i><b>11.5</b> Абсолютная частотность</a></li>
<li class="chapter" data-level="11.6" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#стемминг"><i class="fa fa-check"></i><b>11.6</b> Стемминг</a></li>
<li class="chapter" data-level="11.7" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#относительная-частотность"><i class="fa fa-check"></i><b>11.7</b> Относительная частотность</a></li>
<li class="chapter" data-level="11.8" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#распределения-слов-токенов"><i class="fa fa-check"></i><b>11.8</b> Распределения слов (токенов)</a></li>
<li class="chapter" data-level="11.9" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#закон-ципфа"><i class="fa fa-check"></i><b>11.9</b> Закон Ципфа</a></li>
<li class="chapter" data-level="11.10" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#ttr-type-token-ratio"><i class="fa fa-check"></i><b>11.10</b> TTR (type-token ratio)</a></li>
<li class="chapter" data-level="11.11" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#tf-idf"><i class="fa fa-check"></i><b>11.11</b> TF-IDF</a></li>
<li class="chapter" data-level="11.12" data-path="распределения-слов-и-анализ-частотностей.html"><a href="распределения-слов-и-анализ-частотностей.html#сравнение-при-помощи-диаграммы-рассеяния"><i class="fa fa-check"></i><b>11.12</b> Сравнение при помощи диаграммы рассеяния</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html"><i class="fa fa-check"></i><b>12</b> Тематическое моделирование</a>
<ul>
<li class="chapter" data-level="12.1" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#что-такое-lda"><i class="fa fa-check"></i><b>12.1</b> Что такое LDA</a></li>
<li class="chapter" data-level="12.2" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#распределение-дирихле"><i class="fa fa-check"></i><b>12.2</b> Распределение Дирихле</a></li>
<li class="chapter" data-level="12.3" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#подготовка-данных"><i class="fa fa-check"></i><b>12.3</b> Подготовка данных</a></li>
<li class="chapter" data-level="12.4" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#матрица-встречаемости"><i class="fa fa-check"></i><b>12.4</b> Матрица встречаемости</a></li>
<li class="chapter" data-level="12.5" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#число-тем"><i class="fa fa-check"></i><b>12.5</b> Число тем</a></li>
<li class="chapter" data-level="12.6" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#модель-lda"><i class="fa fa-check"></i><b>12.6</b> Модель LDA</a></li>
<li class="chapter" data-level="12.7" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#слова-и-темы"><i class="fa fa-check"></i><b>12.7</b> Слова и темы</a></li>
<li class="chapter" data-level="12.8" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#темы-и-документы"><i class="fa fa-check"></i><b>12.8</b> Темы и документы</a></li>
<li class="chapter" data-level="12.9" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#распределения-вероятности-для-топиков"><i class="fa fa-check"></i><b>12.9</b> Распределения вероятности для топиков</a></li>
<li class="chapter" data-level="12.10" data-path="тематическое-моделирование.html"><a href="тематическое-моделирование.html#интерактивные-визуализации"><i class="fa fa-check"></i><b>12.10</b> Интерактивные визуализации</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="латентно-семантический-анализ-часть-1.html"><a href="латентно-семантический-анализ-часть-1.html"><i class="fa fa-check"></i><b>13</b> Латентно-семантический анализ (Часть 1)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="латентно-семантический-анализ-часть-1.html"><a href="латентно-семантический-анализ-часть-1.html#что-это-такое"><i class="fa fa-check"></i><b>13.1</b> Что это такое</a></li>
<li class="chapter" data-level="13.2" data-path="латентно-семантический-анализ-часть-1.html"><a href="латентно-семантический-анализ-часть-1.html#векторное-представление-слов"><i class="fa fa-check"></i><b>13.2</b> Векторное представление слов</a></li>
<li class="chapter" data-level="13.3" data-path="латентно-семантический-анализ-часть-1.html"><a href="латентно-семантический-анализ-часть-1.html#сингулярное-разложение-матрицы"><i class="fa fa-check"></i><b>13.3</b> Сингулярное разложение матрицы</a></li>
<li class="chapter" data-level="13.4" data-path="латентно-семантический-анализ-часть-1.html"><a href="латентно-семантический-анализ-часть-1.html#простой-пример"><i class="fa fa-check"></i><b>13.4</b> Простой пример</a></li>
<li class="chapter" data-level="13.5" data-path="латентно-семантический-анализ-часть-1.html"><a href="латентно-семантический-анализ-часть-1.html#векторы-слов-опрятно"><i class="fa fa-check"></i><b>13.5</b> Векторы слов: опрятно</a></li>
<li class="chapter" data-level="13.6" data-path="латентно-семантический-анализ-часть-1.html"><a href="латентно-семантический-анализ-часть-1.html#векторы-документов-опрятно"><i class="fa fa-check"></i><b>13.6</b> Векторы документов: опрятно</a></li>
<li class="chapter" data-level="13.7" data-path="латентно-семантический-анализ-часть-1.html"><a href="латентно-семантический-анализ-часть-1.html#пакет-lsa"><i class="fa fa-check"></i><b>13.7</b> Пакет LSA</a></li>
<li class="chapter" data-level="13.8" data-path="латентно-семантический-анализ-часть-1.html"><a href="латентно-семантический-анализ-часть-1.html#кластеризация"><i class="fa fa-check"></i><b>13.8</b> Кластеризация</a></li>
<li class="chapter" data-level="13.9" data-path="латентно-семантический-анализ-часть-1.html"><a href="латентно-семантический-анализ-часть-1.html#визуализации-топиков"><i class="fa fa-check"></i><b>13.9</b> Визуализации топиков</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="литература.html"><a href="литература.html"><i class="fa fa-check"></i>Литература</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Компьютерный анализ текста в R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="тематическое-моделирование" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Тема 12</span> Тематическое моделирование<a href="тематическое-моделирование.html#тематическое-моделирование" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="что-такое-lda" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Что такое LDA<a href="тематическое-моделирование.html#что-такое-lda" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Приступая к анализу текстов (текст-майнингу), мы часто хотим разделить большую коллекцию документов на некие естественные группы, например, тематические. Одним из способов такого деления является <em>тематическое моделирование</em>.</p>
<p><em>Латентное размещение Дирихле</em> (LDA) - особенно популярный метод для построения тематической модели. В нем каждый документ рассматривается как смесь тем, а каждая тема - как смесь слов. Это позволяет документам “перекрывать” друг друга по содержанию, а не разделяться на отдельные группы, что отражает типичное использование естественного языка. Например, мы можем представить коллекцию документов по истории искусства, в которой будут тексты о живописи, архитектуре и фотографии. Тема искусства будет представлена во всех документах, где-то может быть будет сочетание 2-3 тем сразу.</p>
<div class="float">
<img src="https://static.wixstatic.com/media/a27d24_7c263081559a4f5fa80f5bd3073d1edc~mv2.png/v1/fill/w_1082,h_528,al_c,q_90,usm_0.66_1.00_0.01,enc_auto/a27d24_7c263081559a4f5fa80f5bd3073d1edc~mv2.png" alt="Источник: Blei, D. M. (2012), Probabilistic topic models" />
<div class="figcaption">Источник: Blei, D. M. (2012), Probabilistic topic models</div>
</div>
<p>Чем-то работа LDA похожа на то, как мы размечаем текст текстовыделителями: например, в этом курсе зеленым можно выделить код, желтым – математические и статистические отступления, а розовым – окологуманитарные сюжеты. Как вы уже поняли, ключевой вопрос в том, сколько у вас текстовыделителей. При тематическом моделировании этот параметр задается вручную, и дальше мы посмотрим, как это делается.</p>
</div>
<div id="распределение-дирихле" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Распределение Дирихле<a href="тематическое-моделирование.html#распределение-дирихле" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Математические и статистические основания LDA достаточно хитроумны, но к счастью пользоваться моделью можно и без погружения в интегралы, как можно водить машину, не умея собрать двигатель внутреннего сгорания.</p>
<p>Общие принципы на русском языке хорошо изложены <a href="https://sysblok.ru/knowhow/kak-ponjat-o-chem-tekst-ne-chitaja-ego/">в статье “Как понять, о чем текст, не читая его”</a> на сайте “Системный блок”.</p>
<p><img src="https://static.wixstatic.com/media/2e7c6c_d8971b4da7634773b42b55e6d5b15fe0~mv2.png/v1/fill/w_691,h_342,al_c,lg_1,q_85,enc_auto/2e7c6c_d8971b4da7634773b42b55e6d5b15fe0~mv2.png" /></p>
<p>Альфа и бета на этой схеме - <strong>гиперпараметры</strong> распределения. Гиперпараметры регулируют распределения тем по документам и слов по темам. Наглядно это можно представить так:</p>
<p><img src="https://static.wixstatic.com/media/2e7c6c_edcbe922b9f6493cb21b8a73a430b898~mv2.gif" /></p>
<p>При α = 1 получается равномерное распределение: темы распределены равномерно (заметим, что α также называют “параметром концентрации”). При значениях α &gt; 1 выборки начинают концентрироваться в центре треугольника, представляя собой равномерную смесь всех тем. При низких значениях альфа α &lt; 1 большинство наблюдений находится в углах – скорее всего, в в этом случае в документах будет меньше смешения тем<a href="#fn48" class="footnote-ref" id="fnref48"><sup>48</sup></a>. Распределение документов по топикам θ зависит от значения α, поскольку θ ~ Dir(α). Из θ выбирается конкретная тема Z.</p>
<p>Аналогичным образом гиперпараметр 𝛽 управляет распределением слов по темам. При меньших значениях 𝛽 темы, скорее всего, будут больше различаться. Распределение слов φ темы Z ~ Dir(β). Конкретное слово W выбирается уже из этого распределения.</p>
<p>Можно представить себе банкетный зал со столами: если их несколько, и они стоят по углам, то вероятность встретить вашего знакомого в углу выше, чем в центре зала. Если он при этом вегетарианец, вы его будете искать у стола с овощами, а не с котлетами.</p>
<p>Метафору можно понимать двояко. С одной стороны, ваш знакомый – это слово, а стол – тема, или топик. Он может нечаянно прибиться к столу с котлетами, как и слово “футбол” может оказаться в финансовых новостях. Но это сближение не будет таким устойчивым, как, например, связь слова “банк” с финансовым топиком.</p>
<p>С другой стороны, сами “документы” склонны прибиваться к определенным топикам: открыв газету, вы не ожидаете увидеть в одной статье новости вирусологии, педагогики и финансового регулирования <del>такое бывает только в блогах</del>.</p>
</div>
<div id="подготовка-данных" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Подготовка данных<a href="тематическое-моделирование.html#подготовка-данных" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Чтобы понять возможности алгоритма, мы попробуем передать ему архив телеграм-канала Antibarbari. Он хранится в репозитории этого курса на GitHub, откуда его можно скачать и повторить эксперимент. Но любому моделированию всегда предшествует подготовка данных, согласно древней мудрости garbage in - garbage out.</p>
<p>Нужные мне html уже лежат в рабочей директории (2 файла); но при парсинге сайтов, в принципе, действует похожая логика.</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="тематическое-моделирование.html#cb654-1" tabindex="-1"></a><span class="fu">library</span>(xml2)</span>
<span id="cb654-2"><a href="тематическое-моделирование.html#cb654-2" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb654-3"><a href="тематическое-моделирование.html#cb654-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb654-4"><a href="тематическое-моделирование.html#cb654-4" tabindex="-1"></a></span>
<span id="cb654-5"><a href="тематическое-моделирование.html#cb654-5" tabindex="-1"></a>messages <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;./files/antibarbari_archive/messages.html&quot;</span>)</span>
<span id="cb654-6"><a href="тематическое-моделирование.html#cb654-6" tabindex="-1"></a>messages2 <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;./files/antibarbari_archive/messages2.html&quot;</span>)</span></code></pre></div>
<p>Cледующий код позволяет достать только те узлы div, у которых значение атрибута class = text.</p>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="тематическое-моделирование.html#cb655-1" tabindex="-1"></a>text <span class="ot">&lt;-</span> <span class="fu">html_elements</span>(messages, <span class="st">&quot;div.text&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb655-2"><a href="тематическое-моделирование.html#cb655-2" tabindex="-1"></a>  <span class="fu">html_text</span>()</span>
<span id="cb655-3"><a href="тематическое-моделирование.html#cb655-3" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">html_elements</span>(messages2, <span class="st">&quot;div.text&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb655-4"><a href="тематическое-моделирование.html#cb655-4" tabindex="-1"></a>  <span class="fu">html_text</span>()</span></code></pre></div>
<p>Сшиваем и смотрим, что получилось.</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="тематическое-моделирование.html#cb656-1" tabindex="-1"></a>text <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(text)</span>
<span id="cb656-2"><a href="тематическое-моделирование.html#cb656-2" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(text2)</span>
<span id="cb656-3"><a href="тематическое-моделирование.html#cb656-3" tabindex="-1"></a>text <span class="ot">&lt;-</span> text <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(text2)</span>
<span id="cb656-4"><a href="тематическое-моделирование.html#cb656-4" tabindex="-1"></a><span class="fu">dim</span>(text)</span></code></pre></div>
<pre><code>## [1] 780   1</code></pre>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="тематическое-моделирование.html#cb658-1" tabindex="-1"></a>text</span></code></pre></div>
<pre><code>## # A tibble: 780 × 1
##    value                                                                        
##    &lt;chr&gt;                                                                        
##  1 &quot;\nAntibarbari HSE \n     &quot;                                                  
##  2 &quot;\nLatin never sleeps. Новое видео на канале Antibarbari (фрагмент семинара …
##  3 &quot;\nПодборка видео семинара по медленному чтению \&quot;О философии\&quot; Аристотеля; …
##  4 &quot;\nНовое видео в плейлисте \&quot;Латинский язык\&quot;. Фрагмент семинара 28.02.2022h…
##  5 &quot;\n🤖 ОТКРЫТА ЗАПИСЬ НА ПРОЕКТВ рамках проекта участники овладеют навыками п…
##  6 &quot;\nЖелающие присоединиться к группе, читающей \&quot;Филеба\&quot; Платона, пишите рук…
##  7 &quot;\nhttps://youtu.be/I-U_lG0mB3M\n       &quot;                                    
##  8 &quot;\nВ клубе Antibarbari продолжается семинар по чтению и обсуждению фрагменто…
##  9 &quot;\nФилеб. Семинар 3 марта 2022. Сократ и Протарх решают следовать за логосом…
## 10 &quot;\nВышка вернулась в аудитории, поэтому  теперь у нас театральная акустика. …
## # ℹ 770 more rows</code></pre>
<p>Здесь должна следовать обычная рутина: удаление сносок, переносов строки, чисел, имейлов, хэштегов и т.п. Код мог бы выглядеть, например, вот так:</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="тематическое-моделирование.html#cb660-1" tabindex="-1"></a>text_clean <span class="ot">&lt;-</span> text <span class="sc">%&gt;%</span> </span>
<span id="cb660-2"><a href="тематическое-моделирование.html#cb660-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">str_replace_all</span>(value, <span class="st">&quot;(http|https)(</span><span class="sc">\\</span><span class="st">S+)&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb660-3"><a href="тематическое-моделирование.html#cb660-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">str_replace_all</span>(value, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d{2}</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d{2}</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d{4}&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb660-4"><a href="тематическое-моделирование.html#cb660-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">str_replace_all</span>(value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb660-5"><a href="тематическое-моделирование.html#cb660-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">str_replace_all</span>(value, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">W[-A-Za-z0-9_.%]+</span><span class="sc">\\</span><span class="st">@[-A-Za-z0-9_.%]+</span><span class="sc">\\</span><span class="st">.[A-Za-z]+&quot;</span>, <span class="st">&quot; &quot;</span>))</span></code></pre></div>
<p>Но некоторые предварительные эксперименты показали, что в исходном html очень много латинского и греческого текста, разного рода смайлов и т.п., и все это плохо сказывается на модели. Поэтому я применю радикальное средство и удалю все, что не написано кириллицей:</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="тематическое-моделирование.html#cb661-1" tabindex="-1"></a>text_clean <span class="ot">&lt;-</span> text <span class="sc">%&gt;%</span> </span>
<span id="cb661-2"><a href="тематическое-моделирование.html#cb661-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">str_replace_all</span>(value,</span>
<span id="cb661-3"><a href="тематическое-моделирование.html#cb661-3" tabindex="-1"></a>                                 <span class="st">&quot;[Сс]ылка|[Чч]асть&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb661-4"><a href="тематическое-моделирование.html#cb661-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">str_replace_all</span>(value, </span>
<span id="cb661-5"><a href="тематическое-моделирование.html#cb661-5" tabindex="-1"></a>                                <span class="st">&quot;[[^\u0400-\u04FF]]&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb661-6"><a href="тематическое-моделирование.html#cb661-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">str_replace_all</span>(value, </span>
<span id="cb661-7"><a href="тематическое-моделирование.html#cb661-7" tabindex="-1"></a>                                 <span class="st">&quot; </span><span class="sc">\\</span><span class="st">w{1,2} &quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb661-8"><a href="тематическое-моделирование.html#cb661-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">str_remove_all</span>(value,</span>
<span id="cb661-9"><a href="тематическое-моделирование.html#cb661-9" tabindex="-1"></a>                                 <span class="st">&quot; лат &quot;</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb661-10"><a href="тематическое-моделирование.html#cb661-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">str_remove_all</span>(value,</span>
<span id="cb661-11"><a href="тематическое-моделирование.html#cb661-11" tabindex="-1"></a>                                 <span class="st">&quot; гр &quot;</span> ))</span>
<span id="cb661-12"><a href="тематическое-моделирование.html#cb661-12" tabindex="-1"></a></span>
<span id="cb661-13"><a href="тематическое-моделирование.html#cb661-13" tabindex="-1"></a>text_clean</span></code></pre></div>
<pre><code>## # A tibble: 780 × 1
##    value                                                                        
##    &lt;chr&gt;                                                                        
##  1 &quot;                       &quot;                                                    
##  2 &quot;                     Новое видео канале              фрагмент семинара     …
##  3 &quot; Подборка видео семинара медленному чтению  философии  Аристотеля  руководи…
##  4 &quot; Новое видео плейлисте  Латинский язык   Фрагмент семинара                 …
##  5 &quot;   ОТКРЫТА ЗАПИСЬ ПРОЕКТВ рамках проекта участники овладеют навыками парсин…
##  6 &quot; Желающие присоединиться группе  читающей  Филеба  Платона  пишите руководи…
##  7 &quot;                                     &quot;                                      
##  8 &quot; клубе             продолжается семинар чтению обсуждению фрагментов утраче…
##  9 &quot; Филеб  Семинар   марта       Сократ Протарх решают следовать логосом  кото…
## 10 &quot; Вышка вернулась аудитории  поэтому  теперь нас театральная акустика  доска…
## # ℹ 770 more rows</code></pre>
<p>Каждому документу (посту в Telegram) следует добавить id, иначе при разделении на слова мы потеряем данные об их происхождении.</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="тематическое-моделирование.html#cb663-1" tabindex="-1"></a>text_clean <span class="ot">&lt;-</span> text_clean <span class="sc">%&gt;%</span> </span>
<span id="cb663-2"><a href="тематическое-моделирование.html#cb663-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">paste0</span>(<span class="st">&quot;doc_&quot;</span>, <span class="fu">row_number</span>()), <span class="at">.before =</span> value)</span></code></pre></div>
<p>Теперь можно лемматизировать. Как это делать, мы уже знаем.</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="тематическое-моделирование.html#cb664-1" tabindex="-1"></a><span class="fu">library</span>(udpipe)</span>
<span id="cb664-2"><a href="тематическое-моделирование.html#cb664-2" tabindex="-1"></a>russian_syntagrus <span class="ot">&lt;-</span> <span class="fu">udpipe_load_model</span>(<span class="at">file =</span> <span class="st">&quot;russian-syntagrus-ud-2.5-191206.udpipe&quot;</span>)</span>
<span id="cb664-3"><a href="тематическое-моделирование.html#cb664-3" tabindex="-1"></a></span>
<span id="cb664-4"><a href="тематическое-моделирование.html#cb664-4" tabindex="-1"></a>text_ann <span class="ot">&lt;-</span> <span class="fu">udpipe_annotate</span>(russian_syntagrus, text_clean<span class="sc">$</span>value)</span></code></pre></div>
<p>Разный остаточный мусор.</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="тематическое-моделирование.html#cb665-1" tabindex="-1"></a>text_tbl <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(text_ann) <span class="sc">%&gt;%</span> </span>
<span id="cb665-2"><a href="тематическое-моделирование.html#cb665-2" tabindex="-1"></a>  <span class="fu">select</span>(doc_id, lemma)</span></code></pre></div>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="тематическое-моделирование.html#cb666-1" tabindex="-1"></a>text_tbl</span></code></pre></div>
<pre><code>## # A tibble: 62,690 × 2
##    doc_id lemma    
##    &lt;chr&gt;  &lt;chr&gt;    
##  1 doc2   новый    
##  2 doc2   видео    
##  3 doc2   канал    
##  4 doc2   фрагмент 
##  5 doc2   семинар  
##  6 doc3   подборка 
##  7 doc3   видео    
##  8 doc3   семинар  
##  9 doc3   медленный
## 10 doc3   чтение   
## # ℹ 62,680 more rows</code></pre>
<p>Загружаем список стоп-слов для русского языка: возвращаясь к метафоре с банкетом, это салфетки. Они лежат на всех столах и нам не интересны.</p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="тематическое-моделирование.html#cb668-1" tabindex="-1"></a><span class="fu">library</span>(stopwords)</span>
<span id="cb668-2"><a href="тематическое-моделирование.html#cb668-2" tabindex="-1"></a>stop <span class="ot">&lt;-</span> <span class="fu">stopwords</span>(<span class="at">language =</span> <span class="st">&quot;ru&quot;</span>, <span class="at">source =</span> <span class="st">&quot;stopwords-iso&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb668-3"><a href="тематическое-моделирование.html#cb668-3" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb668-4"><a href="тематическое-моделирование.html#cb668-4" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">lemma =</span> value)</span></code></pre></div>
<p>Очень короткие слова и очень короткие посты удаляем.</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="тематическое-моделирование.html#cb669-1" tabindex="-1"></a>text_tidy <span class="ot">&lt;-</span> text_tbl <span class="sc">%&gt;%</span></span>
<span id="cb669-2"><a href="тематическое-моделирование.html#cb669-2" tabindex="-1"></a>  <span class="fu">anti_join</span>(stop) <span class="sc">%&gt;%</span> </span>
<span id="cb669-3"><a href="тематическое-моделирование.html#cb669-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">nchar</span>(lemma) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb669-4"><a href="тематическое-моделирование.html#cb669-4" tabindex="-1"></a>  <span class="fu">group_by</span>(doc_id) <span class="sc">%&gt;%</span> </span>
<span id="cb669-5"><a href="тематическое-моделирование.html#cb669-5" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb669-6"><a href="тематическое-моделирование.html#cb669-6" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>lemma <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ибо&quot;</span>, <span class="st">&quot;либо&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb669-7"><a href="тематическое-моделирование.html#cb669-7" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb669-8"><a href="тематическое-моделирование.html#cb669-8" tabindex="-1"></a></span>
<span id="cb669-9"><a href="тематическое-моделирование.html#cb669-9" tabindex="-1"></a>text_tidy</span></code></pre></div>
<pre><code>## # A tibble: 39,818 × 2
##    doc_id lemma      
##    &lt;chr&gt;  &lt;chr&gt;      
##  1 doc5   открыто    
##  2 doc5   запись     
##  3 doc5   Проектвый  
##  4 doc5   рамка      
##  5 doc5   проект     
##  6 doc5   участник   
##  7 doc5   овладеть   
##  8 doc5   навык      
##  9 doc5   парсинг    
## 10 doc5   подготовить
## # ℹ 39,808 more rows</code></pre>
<p>Исправим некоторые ошибки лемматизации.</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="тематическое-моделирование.html#cb671-1" tabindex="-1"></a>text_tidy <span class="ot">&lt;-</span> text_tidy <span class="sc">%&gt;%</span> </span>
<span id="cb671-2"><a href="тематическое-моделирование.html#cb671-2" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(lemma), <span class="sc">~</span></span>
<span id="cb671-3"><a href="тематическое-моделирование.html#cb671-3" tabindex="-1"></a>       <span class="fu">case_when</span>(lemma <span class="sc">==</span> <span class="st">&quot;мят&quot;</span> <span class="sc">~</span>  <span class="st">&quot;мята&quot;</span>,</span>
<span id="cb671-4"><a href="тематическое-моделирование.html#cb671-4" tabindex="-1"></a>                 lemma <span class="sc">==</span> <span class="st">&quot;Мят&quot;</span> <span class="sc">~</span>  <span class="st">&quot;мята&quot;</span>,</span>
<span id="cb671-5"><a href="тематическое-моделирование.html#cb671-5" tabindex="-1"></a>                 <span class="cn">TRUE</span> <span class="sc">~</span> .)) <span class="sc">%&gt;%</span> </span>
<span id="cb671-6"><a href="тематическое-моделирование.html#cb671-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lemma =</span> <span class="fu">tolower</span>(lemma))</span></code></pre></div>
</div>
<div id="матрица-встречаемости" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Матрица встречаемости<a href="тематическое-моделирование.html#матрица-встречаемости" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Поскольку LDA – вероятностная модель, то на входе она принимает целые числа. В самом деле, не имеет смысла говорить о том, что некое распределение породило 0.5 слов или того меньше. Поэтому мы считаем абсолютную, а не относительную встречаемость – и не tf_idf<a href="#fn49" class="footnote-ref" id="fnref49"><sup>49</sup></a>.</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="тематическое-моделирование.html#cb672-1" tabindex="-1"></a>text_count <span class="ot">&lt;-</span> text_tidy <span class="sc">%&gt;%</span> </span>
<span id="cb672-2"><a href="тематическое-моделирование.html#cb672-2" tabindex="-1"></a>  <span class="fu">group_by</span>(doc_id, lemma) <span class="sc">%&gt;%</span> </span>
<span id="cb672-3"><a href="тематическое-моделирование.html#cb672-3" tabindex="-1"></a>  <span class="fu">count</span>(lemma)</span>
<span id="cb672-4"><a href="тематическое-моделирование.html#cb672-4" tabindex="-1"></a></span>
<span id="cb672-5"><a href="тематическое-моделирование.html#cb672-5" tabindex="-1"></a><span class="fu">head</span>(text_count)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
## # Groups:   doc_id, lemma [6]
##   doc_id lemma              n
##   &lt;chr&gt;  &lt;chr&gt;          &lt;int&gt;
## 1 doc10  акустика           1
## 2 doc10  аудитория          1
## 3 doc10  воспротивиться     1
## 4 doc10  вышка              1
## 5 doc10  гибридный          1
## 6 doc10  грамматика         1</code></pre>
<p>Для работы с LDA в R устанавливаем пакет <code>topicmodels</code>. На входе нужная нам функция этого пакета принимает такую структуру данных, как <em>document-term matrix</em> (dtm), которая используется для хранения сильно разреженных данных и происходит из популярного пакета для текст-майнинга <code>tm</code>.</p>
<p>Поэтому “тайдифицированный” текст придется для моделирования преобразовать в этот формат, а полученный результат вернуть в опрятный формат для визуализаций<a href="#fn50" class="footnote-ref" id="fnref50"><sup>50</sup></a>.</p>
<p>Для преобразования подготовленного корпуса в формат dtm воспользуемся возможностями пакета <code>tidytext</code>:</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="тематическое-моделирование.html#cb674-1" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb674-2"><a href="тематическое-моделирование.html#cb674-2" tabindex="-1"></a></span>
<span id="cb674-3"><a href="тематическое-моделирование.html#cb674-3" tabindex="-1"></a>text_dtm <span class="ot">&lt;-</span> text_count <span class="sc">%&gt;%</span> </span>
<span id="cb674-4"><a href="тематическое-моделирование.html#cb674-4" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(doc_id, <span class="at">term =</span> lemma, <span class="at">value =</span> n)</span>
<span id="cb674-5"><a href="тематическое-моделирование.html#cb674-5" tabindex="-1"></a></span>
<span id="cb674-6"><a href="тематическое-моделирование.html#cb674-6" tabindex="-1"></a>text_dtm</span></code></pre></div>
<pre><code>## &lt;&lt;DocumentTermMatrix (documents: 538, terms: 11275)&gt;&gt;
## Non-/sparse entries: 32607/6033343
## Sparsity           : 99%
## Maximal term length: 27
## Weighting          : term frequency (tf)</code></pre>
<p>Убеждаемся, что почти все ячейки в нашей матрице – нули (99% разреженность).</p>
</div>
<div id="число-тем" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Число тем<a href="тематическое-моделирование.html#число-тем" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Количество тем для модели всегда задается вручную. Мы не всегда заранее знаем, сколько тем в нашем корпусе, и здесь на помощь приходит функция <code>perplexity()</code> из <code>topicmodels</code>. Она показывает, насколько подогнанная модель <strong>не</strong> соответствует данным – поэтому чем значение меньше, тем лучше.</p>
<p>Подгоним сразу несколько моделей с разным количеством тем и посмотрим, какая из них покажет себя лучше. Выполнение кода ниже займет какое-то время.</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="тематическое-моделирование.html#cb676-1" tabindex="-1"></a><span class="fu">library</span>(topicmodels)</span></code></pre></div>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="тематическое-моделирование.html#cb677-1" tabindex="-1"></a>n_topics <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)</span>
<span id="cb677-2"><a href="тематическое-моделирование.html#cb677-2" tabindex="-1"></a>text_lda_compare <span class="ot">&lt;-</span> n_topics <span class="sc">%&gt;%</span></span>
<span id="cb677-3"><a href="тематическое-моделирование.html#cb677-3" tabindex="-1"></a>  <span class="fu">map</span>(LDA, <span class="at">x =</span> text_dtm, </span>
<span id="cb677-4"><a href="тематическое-моделирование.html#cb677-4" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">seed =</span> <span class="dv">0211</span>))</span></code></pre></div>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="тематическое-моделирование.html#cb678-1" tabindex="-1"></a><span class="fu">data_frame</span>(<span class="at">k =</span> n_topics,</span>
<span id="cb678-2"><a href="тематическое-моделирование.html#cb678-2" tabindex="-1"></a>           <span class="at">perplex =</span> <span class="fu">map_dbl</span>(text_lda_compare, perplexity)) <span class="sc">%&gt;%</span></span>
<span id="cb678-3"><a href="тематическое-моделирование.html#cb678-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(k, perplex)) <span class="sc">+</span></span>
<span id="cb678-4"><a href="тематическое-моделирование.html#cb678-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb678-5"><a href="тематическое-моделирование.html#cb678-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb678-6"><a href="тематическое-моделирование.html#cb678-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Оценка LDA модели&quot;</span>,</span>
<span id="cb678-7"><a href="тематическое-моделирование.html#cb678-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Оптимальное количество топиков&quot;</span>,</span>
<span id="cb678-8"><a href="тематическое-моделирование.html#cb678-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Число топиков&quot;</span>,</span>
<span id="cb678-9"><a href="тематическое-моделирование.html#cb678-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Perplexity&quot;</span>)</span></code></pre></div>
<p><img src="images/lda.png" /></p>
<p>Если верить графику, предпочтительны 64 темы (на самом деле, если подогнать еще больше моделей, то и все 200). Но спешить не стоит.</p>
<blockquote>
<p>Если эксперт задаст в параметрах своей программы слишком мало тем, то разные самостоятельные топики сольются в один и станут неразличимы для взгляда исследователя. Если будет задано слишком большое число топиков, то помимо реальных тем, присутствующих в корпусе, появятся «паразитные», которые с точки зрения математического аппарата показывают совместно встречающиеся слова, однако на практике эти слова не будут образовывать тематически самостоятельных контекстов. Поэтому процесс тематического моделирования включает этап подбора нужного количества топиков и соизмерение получившихся результатов с разноплановыми соображениями.</p>
<p><a href="https://shagi.ranepa.ru/files/shagi22_2/shagi22_2_11.pdf">Источник</a></p>
</blockquote>
<p>Мои разноплановые соображения говорят, что больше 10 топиков выделять непродуктивно.</p>
</div>
<div id="модель-lda" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Модель LDA<a href="тематическое-моделирование.html#модель-lda" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="тематическое-моделирование.html#cb679-1" tabindex="-1"></a>text_lda <span class="ot">&lt;-</span> <span class="fu">LDA</span>(text_dtm, <span class="at">k =</span> <span class="dv">8</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">seed =</span> <span class="dv">1111</span>))</span></code></pre></div>
<p>Итак, наша тематическая модель готова. Осталось понять, что с ней делать.</p>
</div>
<div id="слова-и-темы" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> Слова и темы<a href="тематическое-моделирование.html#слова-и-темы" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Пакет <code>tidytext</code> дает возможность “тайдифицировать” объект lda с использованием разных методов. Метод β (“бета”) извлекает вероятность того, что слово происходит из данного топика.</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="тематическое-моделирование.html#cb680-1" tabindex="-1"></a>text_topics <span class="ot">&lt;-</span> <span class="fu">tidy</span>(text_lda, <span class="at">matrix =</span> <span class="st">&quot;beta&quot;</span>)</span>
<span id="cb680-2"><a href="тематическое-моделирование.html#cb680-2" tabindex="-1"></a></span>
<span id="cb680-3"><a href="тематическое-моделирование.html#cb680-3" tabindex="-1"></a>text_topics <span class="sc">%&gt;%</span> </span>
<span id="cb680-4"><a href="тематическое-моделирование.html#cb680-4" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">&quot;огурец&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb680-5"><a href="тематическое-моделирование.html#cb680-5" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>beta)</span></code></pre></div>
<pre><code>## # A tibble: 8 × 3
##   topic term        beta
##   &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;
## 1     6 огурец 2.27e-  3
## 2     4 огурец 4.03e-  4
## 3     8 огурец 2.56e-  4
## 4     7 огурец 1.93e- 20
## 5     5 огурец 4.99e-284
## 6     1 огурец 6.29e-286
## 7     3 огурец 1.85e-286
## 8     2 огурец 3.18e-287</code></pre>
<p>Например, слово “огурец” с большей вероятностью порождено темами 4, 6 или 8, чем остальными темами. Кажется, мы нашли огуречные темы 🥒🥒🥒</p>
<p>Посмотрим на главные термины в топиках.</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="тематическое-моделирование.html#cb682-1" tabindex="-1"></a>text_top_terms <span class="ot">&lt;-</span> text_topics <span class="sc">%&gt;%</span> </span>
<span id="cb682-2"><a href="тематическое-моделирование.html#cb682-2" tabindex="-1"></a>  <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span> </span>
<span id="cb682-3"><a href="тематическое-моделирование.html#cb682-3" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>beta) <span class="sc">%&gt;%</span> </span>
<span id="cb682-4"><a href="тематическое-моделирование.html#cb682-4" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb682-5"><a href="тематическое-моделирование.html#cb682-5" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb682-6"><a href="тематическое-моделирование.html#cb682-6" tabindex="-1"></a></span>
<span id="cb682-7"><a href="тематическое-моделирование.html#cb682-7" tabindex="-1"></a><span class="fu">head</span>(text_top_terms)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   topic term         beta
##   &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
## 1     1 язык      0.0103 
## 2     1 латинский 0.00633
## 3     1 название  0.00598
## 4     1 древний   0.00507
## 5     1 издание   0.00496
## 6     1 греческий 0.00436</code></pre>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="тематическое-моделирование.html#cb684-1" tabindex="-1"></a>text_top_terms <span class="sc">%&gt;%</span> </span>
<span id="cb684-2"><a href="тематическое-моделирование.html#cb684-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder</span>(term, beta)) <span class="sc">%&gt;%</span> </span>
<span id="cb684-3"><a href="тематическое-моделирование.html#cb684-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(term, beta, <span class="at">fill =</span> <span class="fu">factor</span>(topic))) <span class="sc">+</span></span>
<span id="cb684-4"><a href="тематическое-моделирование.html#cb684-4" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb684-5"><a href="тематическое-моделирование.html#cb684-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb684-6"><a href="тематическое-моделирование.html#cb684-6" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-299-1.png" width="672" /></p>
<p>В “огуречной” теме 4 обнаружились также “плод”, “растение” “мед”. Видимо, наш алгоритм вполне “узнал” плодово-овощную рубрику Ирины Макаровой, в которой она рассказывает, что и зачем выращивали древние греки и римляне. А вот “мята” прибилась к топику 1.</p>
<p>Сравним топики 1 и 4 по формуле: <span class="math inline">\(log_2\left(\frac{β_2}{β_1}\right)\)</span>.
Если <span class="math inline">\(β_2\)</span> в 2 раза больше <span class="math inline">\(β_1\)</span>, то логарифм будет равен 1; если наоборот, то -1.</p>
<div class="infobox">
<p>На всякий случай: <span class="math inline">\(\frac{1}{2} = 2^{-1}\)</span>.</p>
</div>
<p>Для подсчетов снова придется трансформировать данные.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="тематическое-моделирование.html#cb685-1" tabindex="-1"></a>beta_spread <span class="ot">&lt;-</span> text_topics <span class="sc">%&gt;%</span> </span>
<span id="cb685-2"><a href="тематическое-моделирование.html#cb685-2" tabindex="-1"></a>  <span class="fu">filter</span>(topic <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb685-3"><a href="тематическое-моделирование.html#cb685-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">topic =</span> <span class="fu">paste0</span>(<span class="st">&quot;topic_&quot;</span>, topic)) <span class="sc">%&gt;%</span> </span>
<span id="cb685-4"><a href="тематическое-моделирование.html#cb685-4" tabindex="-1"></a>  <span class="fu">spread</span>(topic, beta) <span class="sc">%&gt;%</span> </span>
<span id="cb685-5"><a href="тематическое-моделирование.html#cb685-5" tabindex="-1"></a>  <span class="fu">filter</span>(topic_1 <span class="sc">&gt;</span> .<span class="dv">001</span> <span class="sc">|</span> topic_4 <span class="sc">&gt;</span> .<span class="dv">001</span>) <span class="sc">%&gt;%</span></span>
<span id="cb685-6"><a href="тематическое-моделирование.html#cb685-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_ratio =</span> <span class="fu">log2</span>(topic_4 <span class="sc">/</span> topic_1))</span>
<span id="cb685-7"><a href="тематическое-моделирование.html#cb685-7" tabindex="-1"></a></span>
<span id="cb685-8"><a href="тематическое-моделирование.html#cb685-8" tabindex="-1"></a><span class="fu">head</span>(beta_spread)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   term            topic_1   topic_4 log_ratio
##   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 абрикос    0.0000000153 1.61e-  3    16.7  
## 2 автор      0.000920     2.66e-  3     1.53 
## 3 аида       0.00161      6.05e-  4    -1.41 
## 4 английский 0.000230     1.61e-  3     2.81 
## 5 анемон     0.00138      8.85e-148  -479.   
## 6 античность 0.00102      1.41e-  3     0.473</code></pre>
<p>На графике выглядит понятнее:</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="тематическое-моделирование.html#cb687-1" tabindex="-1"></a>beta_log_ratio <span class="ot">&lt;-</span> beta_spread <span class="sc">%&gt;%</span></span>
<span id="cb687-2"><a href="тематическое-моделирование.html#cb687-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sign =</span> <span class="fu">case_when</span>(log_ratio <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;pos&quot;</span>,</span>
<span id="cb687-3"><a href="тематическое-моделирование.html#cb687-3" tabindex="-1"></a>                          log_ratio <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;neg&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb687-4"><a href="тематическое-моделирование.html#cb687-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>topic_4, <span class="sc">-</span>topic_1) <span class="sc">%&gt;%</span> </span>
<span id="cb687-5"><a href="тематическое-моделирование.html#cb687-5" tabindex="-1"></a>  <span class="fu">group_by</span>(sign) <span class="sc">%&gt;%</span> </span>
<span id="cb687-6"><a href="тематическое-моделирование.html#cb687-6" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(log_ratio))) <span class="sc">%&gt;%</span> </span>
<span id="cb687-7"><a href="тематическое-моделирование.html#cb687-7" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span></code></pre></div>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="тематическое-моделирование.html#cb688-1" tabindex="-1"></a>beta_log_ratio <span class="sc">%&gt;%</span> </span>
<span id="cb688-2"><a href="тематическое-моделирование.html#cb688-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">reorder</span>(term, log_ratio), log_ratio, <span class="at">fill =</span> sign)) <span class="sc">+</span></span>
<span id="cb688-3"><a href="тематическое-моделирование.html#cb688-3" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb688-4"><a href="тематическое-моделирование.html#cb688-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;термин&quot;</span>) <span class="sc">+</span></span>
<span id="cb688-5"><a href="тематическое-моделирование.html#cb688-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;log2 (beta_4 / beta_1)&quot;</span>) <span class="sc">+</span></span>
<span id="cb688-6"><a href="тематическое-моделирование.html#cb688-6" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-302-1.png" width="672" /></p>
<p>В теме 4 видим и других обитателей садов и огородов: “гортензия”, “олива-иресиона”, а в теме 1 больше персоналий: например, буддийский монарх Нагасена, мифический Иксион и др.</p>
</div>
<div id="темы-и-документы" class="section level2 hasAnchor" number="12.8">
<h2><span class="header-section-number">12.8</span> Темы и документы<a href="тематическое-моделирование.html#темы-и-документы" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Распределение тем по документам хранит матрица gamma.</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="тематическое-моделирование.html#cb689-1" tabindex="-1"></a>text_documents <span class="ot">&lt;-</span> <span class="fu">tidy</span>(text_lda, <span class="at">matrix =</span> <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb689-2"><a href="тематическое-моделирование.html#cb689-2" tabindex="-1"></a></span>
<span id="cb689-3"><a href="тематическое-моделирование.html#cb689-3" tabindex="-1"></a>text_documents <span class="sc">%&gt;%</span> </span>
<span id="cb689-4"><a href="тематическое-моделирование.html#cb689-4" tabindex="-1"></a>  <span class="fu">filter</span>(topic <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb689-5"><a href="тематическое-моделирование.html#cb689-5" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>gamma)</span></code></pre></div>
<pre><code>## # A tibble: 538 × 3
##    document topic gamma
##    &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt;
##  1 doc288       4 1.00 
##  2 doc563       4 0.999
##  3 doc402       4 0.999
##  4 doc601       4 0.999
##  5 doc272       4 0.999
##  6 doc199       4 0.999
##  7 doc400       4 0.999
##  8 doc186       4 0.999
##  9 doc470       4 0.999
## 10 doc737       4 0.999
## # ℹ 528 more rows</code></pre>
<p>Значение gamma можно понимать как долю слов в документе, происходящую из данного топика. Например, тема 4 представлена в документе 288 Посмотрим на него:</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="тематическое-моделирование.html#cb691-1" tabindex="-1"></a>doc_288 <span class="ot">&lt;-</span> text_clean <span class="sc">%&gt;%</span> </span>
<span id="cb691-2"><a href="тематическое-моделирование.html#cb691-2" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">==</span> <span class="st">&quot;doc_288&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb691-3"><a href="тематическое-моделирование.html#cb691-3" tabindex="-1"></a>  <span class="fu">pull</span>(value) </span>
<span id="cb691-4"><a href="тематическое-моделирование.html#cb691-4" tabindex="-1"></a></span>
<span id="cb691-5"><a href="тематическое-моделирование.html#cb691-5" tabindex="-1"></a><span class="fu">paste0</span>(<span class="fu">substr</span>(doc_288, <span class="dv">1</span>, <span class="dv">279</span>), <span class="st">&quot;...&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot; Тыква                     Закончилось лето  подходит завершению наша сезонная плодово ягодная рубрика  Сегодня вспомним тыкве  ведь греки охотно выращивали  привычная нам тыква те  что были греков римлян  одно то  хотя все они относятся семейству тыквенных  Тыквы прилавка супер...&quot;</code></pre>
<p>Каждый документ в рамках LDA рассматривается как собрание тем. Значит, сумма всех гамм для текста должна быть равна единице. Проверим.</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="тематическое-моделирование.html#cb693-1" tabindex="-1"></a>text_documents <span class="sc">%&gt;%</span> </span>
<span id="cb693-2"><a href="тематическое-моделирование.html#cb693-2" tabindex="-1"></a>  <span class="fu">filter</span>(document <span class="sc">==</span> <span class="st">&quot;doc288&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb693-3"><a href="тематическое-моделирование.html#cb693-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum =</span> <span class="fu">sum</span>(gamma))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##     sum
##   &lt;dbl&gt;
## 1     1</code></pre>
<p>Все верно!</p>
<p>Теперь отберем несколько длинных постов и посмотрим, какие топики в них представлены.</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="тематическое-моделирование.html#cb695-1" tabindex="-1"></a>long_posts <span class="ot">&lt;-</span> text_clean <span class="sc">%&gt;%</span> </span>
<span id="cb695-2"><a href="тематическое-моделирование.html#cb695-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">char =</span> <span class="fu">nchar</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb695-3"><a href="тематическое-моделирование.html#cb695-3" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>char) <span class="sc">%&gt;%</span> </span>
<span id="cb695-4"><a href="тематическое-моделирование.html#cb695-4" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb695-5"><a href="тематическое-моделирование.html#cb695-5" tabindex="-1"></a>  <span class="fu">pull</span>(id)</span>
<span id="cb695-6"><a href="тематическое-моделирование.html#cb695-6" tabindex="-1"></a></span>
<span id="cb695-7"><a href="тематическое-моделирование.html#cb695-7" tabindex="-1"></a>long_posts <span class="ot">&lt;-</span> <span class="fu">str_remove_all</span>(long_posts, <span class="st">&quot;_&quot;</span>)</span>
<span id="cb695-8"><a href="тематическое-моделирование.html#cb695-8" tabindex="-1"></a>long_posts</span></code></pre></div>
<pre><code>## [1] &quot;doc731&quot; &quot;doc216&quot; &quot;doc740&quot; &quot;doc332&quot; &quot;doc624&quot; &quot;doc563&quot;</code></pre>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="тематическое-моделирование.html#cb697-1" tabindex="-1"></a>text_documents <span class="sc">%&gt;%</span> </span>
<span id="cb697-2"><a href="тематическое-моделирование.html#cb697-2" tabindex="-1"></a>  <span class="fu">filter</span>(document <span class="sc">%in%</span> long_posts) <span class="sc">%&gt;%</span> </span>
<span id="cb697-3"><a href="тематическое-моделирование.html#cb697-3" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>gamma) <span class="sc">%&gt;%</span> </span>
<span id="cb697-4"><a href="тематическое-моделирование.html#cb697-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">as.factor</span>(topic), gamma, <span class="at">color =</span> document)) <span class="sc">+</span> </span>
<span id="cb697-5"><a href="тематическое-моделирование.html#cb697-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb697-6"><a href="тематическое-моделирование.html#cb697-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>document)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-307-1.png" width="672" /></p>
<p>Документы 332 относятся к топику 3. Сравним со словами для этого топика на графике выше.</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="тематическое-моделирование.html#cb698-1" tabindex="-1"></a>doc_332 <span class="ot">&lt;-</span> text_clean <span class="sc">%&gt;%</span> </span>
<span id="cb698-2"><a href="тематическое-моделирование.html#cb698-2" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">==</span> <span class="st">&quot;doc_332&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb698-3"><a href="тематическое-моделирование.html#cb698-3" tabindex="-1"></a>  <span class="fu">pull</span>(value) </span>
<span id="cb698-4"><a href="тематическое-моделирование.html#cb698-4" tabindex="-1"></a></span>
<span id="cb698-5"><a href="тематическое-моделирование.html#cb698-5" tabindex="-1"></a><span class="fu">paste0</span>(<span class="fu">substr</span>(doc_332, <span class="dv">1</span>, <span class="dv">279</span>), <span class="st">&quot;...&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot; Даймон философии астрологии Даймон   это один самых заметных персонажей  занимательной Греции   знакомый многим как источник знамений  посылаемых Сократу  Даймон  помимо этого  один элементов античной астрологической практики  которую  изучая античную философию  часто невольно ...&quot;</code></pre>
</div>
<div id="распределения-вероятности-для-топиков" class="section level2 hasAnchor" number="12.9">
<h2><span class="header-section-number">12.9</span> Распределения вероятности для топиков<a href="тематическое-моделирование.html#распределения-вероятности-для-топиков" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="тематическое-моделирование.html#cb700-1" tabindex="-1"></a>text_documents <span class="sc">%&gt;%</span> </span>
<span id="cb700-2"><a href="тематическое-моделирование.html#cb700-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(gamma, <span class="at">fill =</span> <span class="fu">as.factor</span>(topic))) <span class="sc">+</span></span>
<span id="cb700-3"><a href="тематическое-моделирование.html#cb700-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb700-4"><a href="тематическое-моделирование.html#cb700-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb700-5"><a href="тематическое-моделирование.html#cb700-5" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb700-6"><a href="тематическое-моделирование.html#cb700-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Распределение вероятностей для каждого топика&quot;</span>, </span>
<span id="cb700-7"><a href="тематическое-моделирование.html#cb700-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Число документов&quot;</span>,</span>
<span id="cb700-8"><a href="тематическое-моделирование.html#cb700-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(gamma))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-309-1.png" width="672" /></p>
<p>Почти ни одна тема не распределена равномерно: гамма чаще всего принимает значения либо около нуля, либо в районе единицы. Тема 8, однако, отклоняется от этого правила.</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="тематическое-моделирование.html#cb701-1" tabindex="-1"></a>text_top_terms <span class="sc">%&gt;%</span> </span>
<span id="cb701-2"><a href="тематическое-моделирование.html#cb701-2" tabindex="-1"></a>  <span class="fu">filter</span>(topic <span class="sc">==</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## # A tibble: 12 × 3
##    topic term          beta
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1     8 философия  0.0136 
##  2     8 текст      0.00652
##  3     8 латинский  0.00601
##  4     8 курс       0.00601
##  5     8 язык       0.00597
##  6     8 цицерон    0.00594
##  7     8 семинар    0.00563
##  8     8 студент    0.00543
##  9     8 аристотель 0.00541
## 10     8 античный   0.00497
## 11     8 проект     0.00495
## 12     8 античность 0.00471</code></pre>
<p>Действительно, здесь встречаются слова, связанные с изучением античности в целом и потому возможные в разных контекстах. Можно сказать, что это своего рода метатопик, характеризующий тематику канала в целом.</p>
</div>
<div id="интерактивные-визуализации" class="section level2 hasAnchor" number="12.10">
<h2><span class="header-section-number">12.10</span> Интерактивные визуализации<a href="тематическое-моделирование.html#интерактивные-визуализации" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Более подробно изучить полученную модель можно при помощи интерактивной визуализации. Функция ниже заимстовована <a href="https://gist.github.com/trinker/477d7ae65ff6ca73cace">отсюда</a>.</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="тематическое-моделирование.html#cb703-1" tabindex="-1"></a>topicmodels2LDAvis <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...){</span>
<span id="cb703-2"><a href="тематическое-моделирование.html#cb703-2" tabindex="-1"></a>  post <span class="ot">&lt;-</span> topicmodels<span class="sc">::</span><span class="fu">posterior</span>(x)</span>
<span id="cb703-3"><a href="тематическое-моделирование.html#cb703-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">ncol</span>(post[[<span class="st">&quot;topics&quot;</span>]]) <span class="sc">&lt;</span> <span class="dv">3</span>) <span class="fu">stop</span>(<span class="st">&quot;The model must contain &gt; 2 topics&quot;</span>)</span>
<span id="cb703-4"><a href="тематическое-моделирование.html#cb703-4" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> x<span class="sc">@</span>wordassignments</span>
<span id="cb703-5"><a href="тематическое-моделирование.html#cb703-5" tabindex="-1"></a>  LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb703-6"><a href="тематическое-моделирование.html#cb703-6" tabindex="-1"></a>    <span class="at">phi =</span> post[[<span class="st">&quot;terms&quot;</span>]], </span>
<span id="cb703-7"><a href="тематическое-моделирование.html#cb703-7" tabindex="-1"></a>    <span class="at">theta =</span> post[[<span class="st">&quot;topics&quot;</span>]],</span>
<span id="cb703-8"><a href="тематическое-моделирование.html#cb703-8" tabindex="-1"></a>    <span class="at">vocab =</span> <span class="fu">colnames</span>(post[[<span class="st">&quot;terms&quot;</span>]]),</span>
<span id="cb703-9"><a href="тематическое-моделирование.html#cb703-9" tabindex="-1"></a>    <span class="at">doc.length =</span> slam<span class="sc">::</span><span class="fu">row_sums</span>(mat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb703-10"><a href="тематическое-моделирование.html#cb703-10" tabindex="-1"></a>    <span class="at">term.frequency =</span> slam<span class="sc">::</span><span class="fu">col_sums</span>(mat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb703-11"><a href="тематическое-моделирование.html#cb703-11" tabindex="-1"></a>  )</span>
<span id="cb703-12"><a href="тематическое-моделирование.html#cb703-12" tabindex="-1"></a>}</span></code></pre></div>
<p>Свежую верию пакета LDAvis надо устанавливать из репозитория.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="тематическое-моделирование.html#cb704-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;cpsievert/LDAvis&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="тематическое-моделирование.html#cb705-1" tabindex="-1"></a><span class="fu">library</span>(LDAvis)</span>
<span id="cb705-2"><a href="тематическое-моделирование.html#cb705-2" tabindex="-1"></a>LDAvis<span class="sc">::</span><span class="fu">serVis</span>(<span class="fu">topicmodels2LDAvis</span>(text_lda), <span class="at">out.dir =</span> <span class="st">&quot;ldavis&quot;</span>)</span></code></pre></div>
<p><a href="https://locusclassicus.github.io/ldavis_antibarbari/">Ссылка на интерактивную визуализацию топиков</a>.</p>
<p>Об этом приложении см. <a href="https://nlp.stanford.edu/events/illvi2014/papers/sievert-illvi2014.pdf">здесь</a>.</p>
<p>Значения лямбды, очень близкие к нулю, показывают термины, наиболее специфичные для выбранной темы. Это означает, что вы увидите термины, которые “важны” для данной конкретной темы, но не обязательно “важны” для всего корпуса.</p>
<p>Значения лямбды, близкие к единице, показывают те термины, которые имеют наибольшее соотношение между частотой терминов по данной теме и общей частотой терминов из корпуса<a href="#fn51" class="footnote-ref" id="fnref51"><sup>51</sup></a>.</p>
<p>Сами разработчики <a href="http://www.kennyshirley.com/LDAvis/#topic=0&amp;lambda=0.01&amp;term=">советуют</a> выставлять значение лямбды в районе 0.6.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="48">
<li id="fn48"><p><a href="https://www.mithilaguha.com/post/topic-modeling-and-latent-dirichlet-allocation" class="uri">https://www.mithilaguha.com/post/topic-modeling-and-latent-dirichlet-allocation</a><a href="тематическое-моделирование.html#fnref48" class="footnote-back">↩︎</a></p></li>
<li id="fn49"><p><a href="https://datascience.stackexchange.com/questions/21950/why-we-should-not-feed-lda-with-tfidf/49704#49704?newreg=c17592380de141cf9064c9c5ef09cdc6" class="uri">https://datascience.stackexchange.com/questions/21950/why-we-should-not-feed-lda-with-tfidf/49704#49704?newreg=c17592380de141cf9064c9c5ef09cdc6</a><a href="тематическое-моделирование.html#fnref49" class="footnote-back">↩︎</a></p></li>
<li id="fn50"><p><a href="https://www.tidytextmining.com/topicmodeling.html" class="uri">https://www.tidytextmining.com/topicmodeling.html</a><a href="тематическое-моделирование.html#fnref50" class="footnote-back">↩︎</a></p></li>
<li id="fn51"><p><a href="https://stackoverflow.com/questions/50726713/meaning-of-bar-width-for-pyldavis-for-lambda-0" class="uri">https://stackoverflow.com/questions/50726713/meaning-of-bar-width-for-pyldavis-for-lambda-0</a><a href="тематическое-моделирование.html#fnref51" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="распределения-слов-и-анализ-частотностей.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="латентно-семантический-анализ-часть-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/11-lda.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
